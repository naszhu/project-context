var Microsoft="object"==typeof Microsoft?Microsoft:{};Microsoft.Office=Microsoft.Office||{},Microsoft.Office.PowerPoint=function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=16)}({16:function(e,t,i){"use strict";i.r(t),i.d(t,"DocRebootSupportMode",(function(){return un})),i.d(t,"CommandIds",(function(){return te})),i.d(t,"EventIds",(function(){return oe})),i.d(t,"createCancellationToken",(function(){return nt})),i.d(t,"Application",(function(){return vn})),i.d(t,"createApplication",(function(){return wn}));var n=[[/!/g,"%21"],[/'/g,"%27"],[/\(/g,"%28"],[/\)/g,"%29"],[/\*/g,"%2A"]],o=["eurppc"];function r(e){return 8===e.toLowerCase().indexOf("ffc")}function s(e){return 8===e.toLowerCase().indexOf("ppc")}function a(e,t){if(!t||-1===o.indexOf(t.toLowerCase()))return e;var i=e.match(/(^http[s]:\/\/)((?!word)\w*[-])?(.*)/i);return i?"".concat(i[1]).concat(t,"-").concat(i[3]):e}function c(e){var t=e.match(/^(.*?\/\/[^\/]+)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}function d(e,t){var i=e.match(/^(.*?\/\/)([^\/:]+)(.*)$/);if(!i)throw new Error("Invalid URL");var n=i[2];if(void 0===t)return n;if(t<0)throw new Error("subDomainParts should be at least 1");return n.split(".").slice(-(t+1)).join(".")}function u(e){return e+"RemoteUls.ashx"}function l(e,t,i){i&&(e[t.toLowerCase()]=i)}function f(e,t){e[t.toLowerCase()]=""}function p(e,t){var i=e.toLowerCase(),n=t.toLowerCase(),o=i.indexOf("&"+n+"=");if(-1===o&&(o=i.indexOf("?"+n+"=")),-1===o)return"";var r=o+(t.length+2),s=e.indexOf("&",r);return e.substring(r,-1===s?void 0:s)}function h(e,t,i,n){if(!i)return e;var o=e,r=o.indexOf("?"),s="&";r===o.length-1||"&"===o.slice(-1)||"&>"===o.slice(-2)?s="":-1===r&&(s="?");var a=t.toLowerCase()+"=",c=new RegExp("\\W"+a,"i").exec(o);if("?"!==s&&c){if(n){var d=c.index+1,u=o.indexOf("&",d);o=o.substring(0,d)+a+i+(-1===u?"":o.substring(u))}return o}return o.concat(s,a,i)}function v(e,t){if(!e)return e;var i=e,n=i.indexOf("?"),o=t.toLowerCase()+"=",r=i.toLowerCase().indexOf(o,n);if(r>=0){var s=i.indexOf("&",r);return"&"===(i=i.substring(0,r)+(-1===s?"":i.substring(s+1))).slice(-1)&&(i=i.slice(0,-1)),i}return e}function w(e){var t=new RegExp("(c[1-5])h?(-)");return e.replace(t,"$1h$2")}function m(e,t,i){var n=new RegExp("[?&]"+t+"=("+(i||"1")+")\\b","i"),o=e.match(n);return!(!o||i&&o[1]!==i)}function g(e,t){var i=p(e,t);return i?decodeURI(i):i}function S(e){return p(window.location.href,e)}function I(e){var t=encodeURIComponent(e);return n.forEach((function(e){t=t.replace(e[0],e[1])})),t}function b(e){var t=(e+"===").substring(0,e.length+(4-e.length%4)%4);return t=(t=t.replace(/-/g,"+")).replace(/_/g,"/"),atob(t)}function _(e){var t=document.createElement("a");t.href=e;var i=t.port||80,n=window.location.port||80;return t.hostname===window.location.hostname&&i===n}function T(e){return e?e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]:""}function C(e,t){return void 0===e&&(e=!1),{shouldPreconnect:function(e){return U&&(!t||t(e))},preconnect:function(t){return function(e){var t=document.createElement("link");t.rel="preconnect",t.href=e,t.crossOrigin="anonymous",document.head.appendChild(t)}(e?w(t):t)}}}var y,P,A,U=!0;function E(e,t,i){if(t){var n=window.navigator;if(n&&n.sendBeacon)try{return void n.sendBeacon(t,e)}catch(e){}!function(e,t,i){var n=new XMLHttpRequest;n.readyState!==XMLHttpRequest.UNSENT&&n.readyState!==XMLHttpRequest.DONE||(n.open("POST",t,i),n.send(e))}(e,t,i)}}!function(e){e.Unknown="UNKNOWN",e.Initialized="INITIALIZED",e.Prebooted="PREBOOTED",e.Booting="BOOTING",e.Booted="BOOTED",e.Failed="FAILED",e.Disposing="DISPOSING",e.Disposed="DISPOSED"}(y||(y={})),function(e){e[e.u=0]="msoulscat_ES_EWAJS",e[e.h=1]="msoulscat_ES_EWAJSGrid",e[e.v=6]="msoulscat_ES_EWAJSChart",e[e.g=202]="msoulscat_MSOSP_FileMenuCommands",e[e._=220]="msoulscat_MSOSP_AddInCommands",e[e.P=225]="msoulscat_MSOSP_OTelJS",e[e.A=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.U=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.O=301]="msoulscat_Wac_WordViewer",e[e.F=306]="msoulscat_Wac_BrowserGeneral",e[e.k=320]="msoulscat_Wac_TaskPane",e[e.N=339]="msoulscat_Wac_OneNoteGeneral",e[e.R=340]="msoulscat_Wac_Ribbon",e[e.B=356]="msoulscat_Wac_WacFeedback",e[e.H=379]="msoulscat_Wac_WopiPendingApplication",e[e.J=383]="msoulscat_Wac_Telemetry",e[e.j=391]="msoulscat_Wac_WacCatchUpActivities",e[e.q=394]="msoulscat_Wac_Dictation",e[e.K=395]="msoulscat_Wac_OneNoteSync",e[e.Z=700]="msoulscat_Wac_VisioApp",e[e.$=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.X=800]="msoulscat_Wac_PptAnimation",e[e.Y=833]="msoulscat_Wac_PptLive",e[e.ee=834]="msoulscat_Wac_PptMWeb",e[e.te=835]="msoulscat_Wac_PptGc2General",e[e.ie=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.ne=837]="msoulscat_Wac_PptGc2Operation",e[e.oe=844]="msoulscat_Wac_PptDataSync",e[e.re=848]="msoulscat_Wac_PptFluidRuntime",e[e.se=815]="msoulscat_Wac_PptShape",e[e.ae=817]="msoulscat_Wac_PptSession",e[e.ce=830]="msoulscat_Wac_PptSlideshow",e[e.de=822]="msoulscat_Wac_PptView",e[e.ue=846]="msoulscat_Wac_PptVideos",e[e.le=1303]="msoulscat_Uci_Insights",e[e.fe=2300]="msoulscat_Wac_VersionHistory",e[e.pe=302]="msoulscat_Wac_WordPresence",e[e.he=3e3]="msoulscat_Wac_OAuth",e[e.ve=3005]="msoulscat_Wac_WordVersionHistory",e[e.we=3006]="msoulscat_Wac_LivePersonaCard",e[e.me=3012]="msoulscat_Wac_CatchUpFlyout",e[e.ge=3016]="msoulscat_Wac_WordDesigner",e[e.Se=3021]="msoulscat_Wac_ModernFontPicker",e[e.Ie=3027]="msoulscat_Wac_UnifiedUiHost",e[e.be=3033]="msoulscat_Wac_EquationTools",e[e._e=1401]="msoulscat_Osf_Latency",e[e.Te=1402]="msoulscat_Osf_Notification",e[e.Ce=1403]="msoulscat_Osf_Runtime",e[e.ye=3041]="msoulscat_Wac_AiMaker",e[e.Pe=3043]="msoulscat_Wac_AiRewrite",e[e.Ae=3044]="msoulscat_Wac_AiInsert",e[e.Ue=3047]="msoulscat_Wac_AiSummarize",e[e.Ee=3048]="msoulscat_Wac_CopilotCompose",e[e.Oe=3049]="msoulscat_Wac_Skittles",e[e.Fe=3050]="msoulscat_Wac_CopilotChat",e[e.ke=3051]="msoulscat_Wac_Syntex",e[e.We=3052]="msoulscat_Wac_WireGraph",e[e.Ne=3053]="msoulscat_Wac_CshCopilot",e[e.Re=3054]="msoulscat_Wac_CopilotComposeLaunchpad",e[e.Me=3055]="msoulscat_Wac_CopilotProactiveSummary",e[e.xe=3056]="msoulscat_Wac_CopilotProactiveShared",e[e.De=3057]="msoulscat_Wac_CopilotCursor"}(P||(P={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(A||(A={}));var O,F,k={BUILD_NUMBER:"###VERSION###",BUILD_NUMBER_MINOR:-1};function W(){try{return k.BUILD_NUMBER}catch(e){return k.BUILD_NUMBER}}function N(){return k.BUILD_NUMBER_MINOR}function R(e,t,i){!function(e,t,i,n){void 0===n&&(n=!0);var o={type:t.toString(),payloadJson:JSON.stringify(i)};E(JSON.stringify(o),e,n)}(e,O.JSAPI_STATE,{application:t,build:W(),state:i})}function M(){return window.performance.now()}function x(){return Math.round(window.performance.now()+window.performance.timeOrigin)}!function(e){e.JSAPI_STATE="JSAPI_STATE",e.H_V2="H_V2"}(O||(O={})),function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(F||(F={}));var D,B,H=function(){function e(e){var t=this;this.Be=3e4,this.He=30,this.Ve=0,this.Le=[],this.Je=x(),this.Ge=[],this.je="",this.ze=0,this.flushOnClose=function(){t.qe(!1,!1)},this.flush=function(){t.Ke()},this.flushAndSetNewEndpoint=function(e,i){var n,o=t.Ze(e);o.localeCompare(null!==(n=t.$e)&&void 0!==n?n:"",void 0,{sensitivity:"accent"})&&(t.Ge.push((function(){t.$e=o,i&&i()})),t.qe(!0,!0))},this.Ze=function(e){return e+"?usid="+t.je+"&officeserverversion="+W()},this.Ke=function(){window.setTimeout((function(){return t.qe(!0,!0)}),0)},this.qe=function(e,i){var n,o,r,s,a,c,d,u=M();window.clearTimeout(t.Xe),t.$e&&(t.Le.length>0&&(t.Ve+=1,E((n=t.Le.splice(0,e?t.He:t.Le.length),o=t.je,r=t.Ve,s=t.Je,a=[],c=n.map((function(e){return function(e,t,i){var n={};if(n.G=e.tag,n.T=e.timestamp-t,n.M=e.message,n.C=e.category,e.correlationId){var o=i.findIndex((function(t){return t===e.correlationId}));o<0&&(o=i.push(e.correlationId)-1),n.I=o}var r=1e3*e.type+e.level;return n.D=r,n}(e,s,a)})),d=function(e,t,i,n,o){var r={};return r.T=e,r.L=t,r.S=i,r.I=n,o&&o.length>0&&(r.W=o),r.V=1,r}(s,c,o,r,a),JSON.stringify(d)),t.$e,i),t.Je=x()),0===t.Le.length&&t.Ge.length>0&&(t.Ge.forEach((function(e){"requestIdleCallback"in window?window.requestIdleCallback(e):window.setTimeout(e,0)})),t.Ge=[]),e&&(t.Xe=window.setTimeout((function(){t.Ke()}),t.Le.length>t.He||t.Ge.length>0?1e3:t.Be)),t.ze+=M()-u)},e&&this.configure(e)}return e.prototype.getTimeSpentLogging=function(){return this.ze},e.prototype.addLoggingTime=function(e){this.ze+=e},e.prototype.configure=function(e){var t=M();if(e.uploadCadenceInMs&&(this.Be=e.uploadCadenceInMs),e.uploadTriggerSize&&(this.He=e.uploadTriggerSize),e.sessionId&&(this.je=e.sessionId),e.remoteUlsEndpoint){if(!e.sessionId&&this.$e)throw new Error("Remote ULS endpoint is already set");this.$e=this.Ze(e.remoteUlsEndpoint),this.Je=x(),this.Ke()}this.ze+=M()-t},e.prototype.handleTrace=function(e){var t=M();e.message.length>3072&&(e.message=e.message.substring(0,3072-"... [Trimmed]".length)+"... [Trimmed]"),this.Le.push(e),(this.Le.length>this.He||e.level===A.Error)&&this.Ke(),this.ze+=M()-t},e.prototype.getUserSessionId=function(){return this.je},e}(),V=[];function L(e){var t=new H(e);function i(e,i,n,o){var r=M();if(!function(e){return 1===V[e]}(e)){var s={timestamp:x(),category:i,tag:e,level:n,type:F.Trace,message:o,correlationId:""};t.addLoggingTime(M()-r),t.handleTrace(s)}}return{ULS:{Qe:function(e,t,n,o){i(e,t,n,o)},shipAssertTag:function(e,t,n,o){n&&i(e,t,A.Error,o)},debugAssertTag:function(e,t,i,n){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:t.flush,flushOnClose:t.flushOnClose,setCorrelationId:function(){}},configure:function(e){t.configure(e)},settingsChangeHandler:function(e){var i,n;i=e.Ye.getValue(B.et,""),n=e.Ye.getValue(B.tt,""),D&&n===D||(V=[],D=n,i&&i.split(",").forEach((function(e){var t=parseInt(e,10);t&&(V[t]=1)}))),t.configure({uploadCadenceInMs:e.Ye.getValue(B.it,6e4)});var o=e.Ye.getValue(B.nt,"").toString();""!==o&&t.flushAndSetNewEndpoint(o)},getTimeSpentLogging:function(){return t.getTimeSpentLogging()},getUserSessionId:function(){return t.getUserSessionId()},flushAndSetNewEndpoint:function(e,i){t.flushAndSetNewEndpoint(e,i)}}}!function(e){e.ot="BootstrapperMaxUlsHeartbeatTime",e.rt="BootstrapperNoCompleteWarning1Time",e.st="BootstrapperNoCompleteWarning2Time",e.tt="RemoteUlsETag",e.et="RemoteUlsSuppressions",e.ct="BootstrapperSettingsFetchPeriod",e.dt="timestamp",e.ut="BootstrapperUlsHeartbeatIntervalMs",e.lt="BootstrapperUlsHeartBeatIsEnabled",e.it="BootstrapperUlsUploadCadenceMs",e.ft="WordConsumptionViewToEditRedirectIsEnabled",e.pt="RequestedCallThrottlingDefaultToViewMinimumValue",e.nt="BulsEndpointUrl",e.ht="EnableCommonHostDiagnosticsParams",e.vt="EnableICNForWord",e.wt="EnableModernEmbedViewForPowerPoint",e.gt="EnableModernEmbedViewInOneUpForPowerPoint",e.St="EnableModernEmbedViewForPowerPointGlobalAppUrl",e.It="EnableModernReadingViewForPowerPoint",e.bt="EnableDefaultToModernForPowerPoint",e._t="ShouldLogJsApiKpisForWord",e.Tt="WordSwitchToViewInTeamsJsapiV1Enabled",e.Ct="EnableWordSessionRefreshTelemetry",e.yt="PowerPointUseEssDCHint",e.Pt="ModernEmbedViewBootstrapperFeatureGatesForPowerPoint",e.At="ModernReadingViewBootstrapperFeatureGatesForPowerPoint",e.Ut="ModernEmbedViewForPowerPointEnabledPercentage",e.Et="PowerPointESSCookieLookbackThresholdHour",e.Ot="PowerPointSetESSCookieLookbackExpEnabled",e.Ft="ExcelForceViewOnlyInTeamsJsapiV1"}(B||(B={}));var J,G=function(e,t){return(G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},j=function(){return(j=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function z(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function q(e,t){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(a){return function(c){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;r&&(r=0,a[0]&&(s=0)),s;)try{if(i=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{i=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function K(e,t,i){if(i||2===arguments.length)for(var n,o=0,r=t.length;o<r;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function Z(e){if(e){var t=e.lastIndexOf(".");if(-1!==t)return e.substring(t+1).toLowerCase()}return""}function $(e,t){return void 0===t?null:t}function X(e){if(!e)return"";var t=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(Object.getPrototypeOf(e));return JSON.stringify(e,K(K([],t,!0),i,!0))}function Q(e,t){return{isFeatureEnabled:function(i){return function(e,t,i){if(t)try{return t(e)}catch(e){i&&i.ULS.Qe(594883024,P.H,A.Error,"IsFeatureEnabled callback error: "+X(e))}}(i,e,t)}}}function Y(e,t){var i={};if(Object.keys(J).forEach((function(t){var n=e.isFeatureEnabled(J[t]);void 0!==n&&(i[J[t]]=n?"1":"0")})),t&&t.wdFlights)for(var n=0,o=t.wdFlights.toLowerCase().split(",");n<o.length;n++){var r=o[n];"et-treatment"!==r&&"et-control"!==r||(i[J.kt]="et-treatment"===r?"1":"0")}return JSON.stringify(i)}Object.create,Object.create,function(e){e.kt="EnterpriseTemplates",e.Wt="ExcelAdaptiveLayoutDownload",e.Nt="ExcelLandingPageOfflineTelemetry",e.Rt="ExcelLandingPageObserverRetry",e.Mt="H2StaticContent",e.xt="HashedUrl",e.Dt="ODCShareLinkPreload",e.Bt="OfficeComExcelJsApiV2",e.Ht="OfficeComPptJsApiV2",e.Vt="OfficeComUiHost",e.Lt="OfficeComWordJsApiV2",e.Jt="OfficeHwaUiHost",e.Gt="OfficeUnifiedUiHostTeams",e.jt="WordViewToUnifiedRead",e.zt="PowerPointEarlySessionStart"}(J||(J={}));var ee,te,ie,ne,oe,re,se=function(){function e(){this.qt=[]}return e.prototype.add=function(e){e&&this.qt.push(e)},e.prototype.remove=function(e){if(e){var t=this.qt.indexOf(e);t>-1&&this.qt.splice(t,1)}},e.prototype.removeAll=function(){this.qt=[]},e.prototype.dispatch=function(e,t){this.qt.forEach((function(i){try{i(e)}catch(e){t&&t(e)}}))},e}(),ae=function(){function e(e,t){var i=this;this.Kt=0,this.Zt=function(){try{if(!window||!window.localStorage)return;var e=window.localStorage.getItem(i.$t);if(!e)return;var t=JSON.parse(e);i.Xt(t)}catch(e){i.Qt.ULS.Qe(592836768,P.H,A.Warning,"Failed to get settings from localStorage: "+X(e))}},this.Xt=function(e){return!!i.Yt(e)&&(i.ei=e,i.ti.dispatch({Ye:i},(function(e){i.Qt.ULS.Qe(592836769,P.H,A.Error,"Settings listener error: "+X(e))})),!0)},this.Yt=function(e){if(e&&"object"==typeof e){if(e.hasOwnProperty(B.dt)&&!isNaN(e.timestamp))return!0;i.Qt.ULS.Qe(592836770,P.H,A.Error,"Received invalid settings")}return!1},this.ii=function(){if(i.ni){var e=new XMLHttpRequest;window.location.href.indexOf("wdkestrelrouting=true")>-1?e.setRequestHeader("X-KestrelRouting","true"):window.location.href.indexOf("wdkestrelrouting=false")>-1&&e.setRequestHeader("X-KestrelRouting","false"),e.open("GET",i.ni),e.responseType="json",e.timeout=5e3,e.send(),e.onload=function(){if(200===e.status&&e.response?(i.oi(e.response),i.Kt=0):(i.Qt.ULS.Qe(592836771,P.H,A.Error,"Fetch settings error. Status: ".concat(e.status,", curErrors: ").concat(i.Kt)),i.Kt+=1),!(i.Kt>7)){var t=i.getValue(B.ct,3e5);i.Kt>3&&(t+=(i.Kt-3+1)*(t/2)),i.ri=window.setTimeout(i.ii,t)}}}},this.oi=function(e){"requestIdleCallback"in window?(i.si&&self.cancelIdleCallback(i.si),i.si=window.requestIdleCallback((function(){return i.ai(e)}),{timeout:1e4})):window.setTimeout((function(){return i.ai(e)}),0)},this.ai=function(e){if(i.Xt(e)&&window&&window.localStorage){var t=JSON.stringify(e);try{window.localStorage.setItem(i.$t,t)}catch(e){i.Qt.ULS.Qe(592836800,P.H,A.Warning,"Failed to set localStorage: "+X(e))}}},this.ci=e,this.$t="Prod"+e+"Settings",this.Qt=t,this.ti=new se,this.Zt()}return e.prototype.updateEnvironment=function(e){this.$t=(r(e)?"FF":"Prod")+this.ci+"Settings",this.Zt()},e.prototype.initializePeriodicFetch=function(e,t){this.$t=(r(e)?"FF":"Prod")+this.ci+"Settings",this.Zt(),this.ni=e+"AppSettingsHandler.ashx?app="+this.ci+"&usid="+t+"&build="+W(),this.ri||(this.ri=window.setTimeout(this.ii,3e4))},e.prototype.getValue=function(e,t){if(this.ei||this.Zt(),!this.ei||!this.ei.hasOwnProperty(e))return t;var i=this.ei[e],n=typeof t;if(typeof i===n)return i;if("string"==typeof i){if("number"===n)return parseInt(i,10);if("boolean"===n)return"true"===i}return t},e.prototype.addSettingsChangeListener=function(e){this.ti.add(e)},e.prototype.removeSettingsChangeListener=function(e){this.ti.remove(e)},e.prototype.dispose=function(){this.ri&&window.clearTimeout(this.ri),this.si&&self.cancelIdleCallback(this.si),this.ri=void 0,this.si=void 0,this.ei=void 0,this.ti.removeAll()},e}();!function(e){e.appReboot="appReboot",e.boot="boot",e.closeTab="closeTab",e.createNew="createNew",e.dispose="dispose",e.frameTrust="frameTrust",e.getAuthToken="getAuthToken",e.getHostKeyValue="getHostKeyValue",e.handleBootState="handleBootState",e.postWacToken="postWacToken",e.rename="rename",e.setOverlayContent="setOverlayContent",e.storeHostKeyValue="storeHostKeyValue",e.switchMode="switchMode",e.updateBootComplete="updateBootComplete",e.setWacFlightValue="setWacFlightValue"}(ee||(ee={})),function(e){e.blurFocus="blurFocus",e.boot="boot",e.completeCreateNew="completeCreateNew",e.continueAccessibilityLoop="continueAccessibilityLoop",e.createNew="createNew",e.dispose="dispose",e.grabFocus="grabFocus",e.moveToFolder="moveToFolder",e.popState="popState",e.sendChannelId="sendChannelId",e.sendConvId="sendConvId",e.teamsUsersReply="teamsUsersReply",e.teamsUserMentionReply="teamsUserMentionReply",e.backButtonPressed="backButtonPressed",e.getClientUrl="getClientUrl",e.getWebUrl="getWebUrl",e.rename="rename",e.completeSharedFilePicker="completeSharedFilePicker",e.sendAccessToken="sendAccessToken",e.sendAuthToken="sendAuthToken",e.sendCustomAuthConfig="sendCustomAuthConfig",e.sendEmbeddedViewUrl="sendEmbeddedViewUrl",e.sendFrameTrustResult="sendFrameTrustResult",e.sendHWRTelemetry="sendHWRTelemetry",e.sendSessionInfo="sendSessionInfo",e.sendUserAccessAndPermissions="sendUserAccessAndPermissions",e.sendWopiInfo="sendWopiInfo",e.sendDavUrl="sendDavUrl",e.switchMode="switchMode",e.signalShared="signalShared",e.postWacToken="postWacToken"}(te||(te={})),function(e){e.di="App_AccessibilityLoopComplete",e.li="Wac_ActionComplete",e.fi="WacInitialize_Ready",e.pi="Wac_AppFailed",e.hi="Wac_AppBootState",e.vi="Wac_AppCompleted",e.wi="BrowserEvent",e.mi="UI_Close",e.gi="App_CloseTab",e.Si="UI_Conversation",e.Ii="UI_CopyAndEdit",e.bi="App_CreateNewDocument",e._i="Wac_AppDataSavedStatus",e.Ti="UI_Download",e.Ci="UI_Edit",e.yi="Error",e.Pi="UI_FileEmbed",e.Ai="UI_FileProperties",e.Ui="File_Rename",e.Ei="File_RenameFailed",e.Oi="UI_FileVersions",e.Fi="StateChanged",e.ki="App_IsFrameTrusted",e.Wi="GetAccessToken",e.Ni="App_GetAuthToken",e.Ri="App_GetCustomAuthConfig",e.Mi="App_GetHostKeyValue",e.xi="App_WopiInfoFromUrl",e.Di="App_DavUrlFromIds",e.Bi="App_LoadingStatus",e.Hi="App_SwitchMode",e.Vi="App_MoveToFolder",e.Li="UI_OpenInMobileApp",e.Ji="UI_OpenInBrowser",e.Gi="UI_OpenInClient",e.ji="PageChanged",e.zi="App_PushCommentContext",e.qi="App_PushState",e.Ki="App_DocReboot",e.Zi="UI_RedeemForCommenting",e.$i="App_RefreshSessionInfo",e.Xi="UI_ReplyWithChanges",e.Qi="UI_ReportAbuse",e.Yi="App_FilePicker",e.en="UI_SaveStatus",e.tn="WopiSession_Complete_Ack",e.in="SetOverlayContent",e.nn="UI_Sharing",e.on="UI_ShareForm",e.rn="UI_SignIn",e.sn="App_StoreHostKeyValue",e.an="App_Unloaded",e.cn="App_UlsLog",e.dn="Wac_UnloadingApp",e.un="App_UpdateBootComplete",e.ln="PageCount",e.fn="UI_CheckUserAccessAndGrantPermissions",e.pn="User_Activity",e.hn="Edit_Notification",e.vn="UI_Workflow",e.wn="ZoomChanged",e.mn="CAAEMessage",e.gn="Excel_HostFrameCacheSave",e.Sn="Excel_HostFrameCacheEvict",e.In="Excel_RegenerateFileBundle",e.bn="App_SwitchToWacFrame",e._n="App_SaveSSRData",e.Tn="App_PurgeDataInHostCache",e.Cn="App_SaveHostRenderingV2Data",e.yn="App_SaveHostUtilsData",e.Pn="AcquireOAuthTokenTeams",e.An="App_SwitchNotebook",e.Un="FailedBoot_CheckFileInfo",e.En="GetTeamsUsers",e.On="SendTeamsUserMention",e.Fn="NavigateBackToHost",e.kn="App_GetClientUrlComplete",e.Wn="App_GetWebUrlComplete",e.Nn="App_CopyLinkComplete",e.Rn="App_SendConversationId",e.Mn="CloseTeamsConversation",e.xn="PageLoaded",e.Dn="Visio_BRS",e.Bn="Visio_SendLicenseInfo",e.Hn="Visio_Consumption_CLTComplete",e.Vn="Visio_SwitchMode_FromViewFrame",e.Ln="Visio_ModeSwitch_ToHost_Ack",e.Jn="Visio_UpdateEditUrl",e.Gn="Visio_PageViewLoaded",e.jn="Visio_ActiveAppFrameLoadFailed",e.zn="Visio_DisposeBkgFrame",e.qn="Visio_ReadyToReceiveDocData",e.Kn="Visio_DocReboot_HostNav",e.Zn="Visio_SwitchToVisioFrame",e.$n="WacAppPerfMetric",e.Xn="App_ModifyURLState",e.Qn="App_WacTokenAck",e.Yn="App_InitEnd",e.eo="App_SplashScreenShown",e.to="App_SetWacFlightValue"}(ie||(ie={})),function(e){e.io="Ack",e.no="WacInitialize_Ready_Ack",e.oo="Wac_BeforeUnloadApp",e.ro="Blur_Focus",e.so="Wac_AppFailed_Ack",e.ao="Wac_AppCompleted_Ack",e.co="WopiStartSession_Complete",e.do="WopiPendingSession_Complete",e.uo="Host_AccessibilityLoopComplete",e.ki="Host_IsFrameTrusted",e.lo="Grab_Focus",e.fo="HostCacheDiagnostic",e.po="Host_KeyValue",e.ho="JsApiDiagnostics",e.Vi="Host_MoveToFolder",e.vo="PageChanged_Ack",e.wo="App_PopState",e.mo="Host_SendChannelId",e.So="Host_SendConversationId",e.Io="GetTeamsUsers_Reply",e.bo="SendTeamsUserMention_Reply",e._o="Host_BackButtonPressed",e.To="Host_GetClientUrl",e.Co="Host_GetWebUrl",e.yo="File_Rename",e.Yi="Host_FilePicker",e.Po="PostAccessToken",e.Ao="Host_SetAuthToken",e.Uo="Host_SetCustomAuthConfig",e.Eo="App_PushCommentContext",e.Oo="CanEmbed",e.Fo="Host_RefreshSessionInfo",e.ko="CheckUserAccessAndGrantPermissions_Result",e.Wo="Host_WopiInfoFromUrl",e.No="Host_DavUrlFromIds",e.Ro="SetCurrentPage",e.Mo="SetZoomLevel",e.xo="WopiPendingSession_Fail",e.Do="SetOverlayContent",e.Bo="WopiPendingApplicationComplete_Received",e.Ho="Host_SwitchMode",e.Vo="Host_Unload",e.Lo="PageCount_Ack",e.Jo="ZoomChanged_Ack",e.Go="Host_ShareUI",e.jo="Host_Telemetry",e.zo="Visio_ConsumptionCLTComplete_Ack",e.qo="Visio_SwitchMode_FromHF_Ack",e.Ko="Visio_SwitchMode_FromHostFrame",e.Zo="Visio_FallbackToLegacySwitch",e.$o="Visio_DocumentData",e.Xo="Host_PostWacToken"}(ne||(ne={})),function(e){e.AccessibilityLoopCompleted="AccessibilityLoopCompleted",e.ActionCompleted="ActionCompleted",e.BrowserEvent="BrowserEvent",e.CAAEMessage="CAAEMessage",e.Close="Close",e.InitEnd="InitEnd",e.Conversation="Conversation",e.CopyAndEdit="CopyAndEdit",e.CreateNewDocument="CreateNewDocument",e.Download="Download",e.Edit="Edit",e.Error="Error",e.FileEmbed="FileEmbed",e.FileProperties="FileProperties",e.FileRenamed="FileRenamed",e.FileVersions="FileVersions",e.FrameStateChanged="FrameStateChanged",e.FrameTrust="FrameTrust",e.GetAccessToken="GetAccessToken",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.GetWopiInfoFromUrl="GetWopiInfoFromUrl",e.GetDavUrlFromIds="GetDavUrlFromIds",e.ModeSwitched="ModeSwitched",e.MoveToFolder="MoveToFolder",e.OpenInMobileApp="OpenInMobileApp",e.OpenInBrowser="OpenInBrowser",e.OpenInClient="OpenInClient",e.PageChanged="PageChanged",e.PushState="PushState",e.Reboot="Reboot",e.RedeemForCommenting="RedeemForCommenting",e.RefreshSessionInfo="RefreshSessionInfo",e.ReplyWithChanges="ReplyWithChanges",e.ReportAbuse="ReportAbuse",e.SharedFilePicker="SharedFilePicker",e.SaveStatus="SaveStatus",e.Share="Share",e.ShareForm="ShareForm",e.SignIn="SignIn",e.SplashScreenShown="SplashScreenShown",e.UserAccessAndPermissions="UserAccessAndPermissions",e.UserActivity="UserActivity",e.UserEditActivity="UserEditActivity",e.Workflow="Workflow",e.ZoomChanged="ZoomChanged",e.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",e.LoadingStatus="LoadingStatus",e.SwitchNotebook="SwitchNotebook",e.FailedBootCheckFileInfo="FailedBootCheckFileInfo",e.GetTeamsUsers="GetTeamsUsers",e.SendTeamsUserMention="SendTeamsUserMention",e.NavigateBackToHost="NavigateBackToHost",e.GetClientUrlComplete="GetClientUrlComplete",e.GetWebUrlComplete="GetWebUrlComplete",e.CopyLinkComplete="CopyLinkComplete",e.SendConversationId="SendConversationId",e.CloseTeamsConversation="CloseTeamsConversation",e.PageLoaded="PageLoaded",e.FrameChanged="FrameChanged"}(oe||(oe={}));var ce,de=((re={})[te.boot]={Qo:ee.boot},re[te.createNew]={Qo:ee.createNew},re[te.dispose]={Qo:ee.dispose},re[te.postWacToken]={Qo:ee.postWacToken},re[te.rename]={Qo:ee.rename},re[te.switchMode]={Qo:ee.switchMode},re[ie.hi]={Qo:ee.handleBootState},re[ie.gi]={Qo:ee.closeTab},re[ie.ki]={Qo:ee.frameTrust},re[ie.Ni]={Qo:ee.getAuthToken},re[ie.Mi]={Qo:ee.getHostKeyValue},re[ie.Ki]={Qo:ee.appReboot},re[ie.to]={Qo:ee.setWacFlightValue},re[ie.in]={Qo:ee.setOverlayContent},re[ie.sn]={Qo:ee.storeHostKeyValue},re[ie.un]={Qo:ee.updateBootComplete},re[te.blurFocus]={Yo:ne.ro},re[te.continueAccessibilityLoop]={Yo:ne.uo},re[te.grabFocus]={Yo:ne.lo},re[te.moveToFolder]={Yo:ne.Vi},re[te.popState]={Yo:ne.wo},re[te.sendChannelId]={Yo:ne.mo},re[te.sendConvId]={Yo:ne.So},re[te.teamsUsersReply]={Yo:ne.Io},re[te.teamsUserMentionReply]={Yo:ne.bo},re[te.backButtonPressed]={Yo:ne._o},re[te.getClientUrl]={Yo:ne.To},re[te.getWebUrl]={Yo:ne.Co},re[te.sendAccessToken]={Yo:ne.Po},re[te.sendAuthToken]={Yo:ne.Ao},re[te.sendHWRTelemetry]={Yo:ne.jo},re[te.sendCustomAuthConfig]={Yo:ne.Uo},re[te.sendDavUrl]={Yo:ne.No},re[te.sendEmbeddedViewUrl]={Yo:ne.Oo},re[te.sendFrameTrustResult]={Yo:ne.ki},re[te.sendSessionInfo]={Yo:ne.Fo},re[te.sendUserAccessAndPermissions]={Yo:ne.ko},re[te.sendWopiInfo]={Yo:ne.Wo},re[te.signalShared]={Yo:ne.Go},re[te.completeSharedFilePicker]={Yo:ne.Yi},re[ie.di]={er:oe.AccessibilityLoopCompleted},re[ie.li]={er:oe.ActionCompleted},re[ie.wi]={er:oe.BrowserEvent},re[ie.mn]={er:oe.CAAEMessage},re[ie.mi]={er:oe.Close},re[ie.Si]={er:oe.Conversation},re[ie.Ii]={er:oe.CopyAndEdit},re[ie.bi]={er:oe.CreateNewDocument},re[ie.Ti]={er:oe.Download},re[ie.Ci]={er:oe.Edit},re[ie.yi]={er:oe.Error},re[ie.Pi]={er:oe.FileEmbed},re[ie.Ai]={er:oe.FileProperties},re[ie.Ui]={er:oe.FileRenamed},re[ie.Oi]={er:oe.FileVersions},re[ie.Wi]={er:oe.GetAccessToken},re[ie.Di]={er:oe.GetDavUrlFromIds},re[ie.Ri]={er:oe.GetCustomAuthConfig},re[ie.xi]={er:oe.GetWopiInfoFromUrl},re[ie.Fi]={er:oe.FrameStateChanged},re[ie.Hi]={er:oe.ModeSwitched},re[ie.Vi]={er:oe.MoveToFolder},re[ie.Li]={er:oe.OpenInMobileApp},re[ie.Ji]={er:oe.OpenInBrowser},re[ie.Gi]={er:oe.OpenInClient},re[ie.ji]={er:oe.PageChanged},re[ie.qi]={er:oe.PushState},re[ie.Zi]={er:oe.RedeemForCommenting},re[ie.$i]={er:oe.RefreshSessionInfo},re[ie.Xi]={er:oe.ReplyWithChanges},re[ie.Yi]={er:oe.SharedFilePicker},re[ie.Qi]={er:oe.ReportAbuse},re[ie.en]={er:oe.SaveStatus},re[ie.nn]={er:oe.Share},re[ie.on]={er:oe.ShareForm},re[ie.rn]={er:oe.SignIn},re[ie.fn]={er:oe.UserAccessAndPermissions},re[ie.pn]={er:oe.UserActivity},re[ie.hn]={er:oe.UserEditActivity},re[ie.vn]={er:oe.Workflow},re[ie.wn]={er:oe.ZoomChanged},re[ie.Pn]={er:oe.AcquireOAuthTokenTeams},re[ie.Bi]={er:oe.LoadingStatus},re[ie.An]={er:oe.SwitchNotebook},re[ie.Un]={er:oe.FailedBootCheckFileInfo},re[ie.En]={er:oe.GetTeamsUsers},re[ie.On]={er:oe.SendTeamsUserMention},re[ie.Fn]={er:oe.NavigateBackToHost},re[ie.kn]={er:oe.GetClientUrlComplete},re[ie.Wn]={er:oe.GetWebUrlComplete},re[ie.Nn]={er:oe.CopyLinkComplete},re[ie.Rn]={er:oe.SendConversationId},re[ie.Mn]={er:oe.CloseTeamsConversation},re[ie.xn]={er:oe.PageLoaded},re[ie.Yn]={er:oe.InitEnd},re[ie.eo]={er:oe.SplashScreenShown},re);function ue(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},i=window.crypto||window.msCrypto;if(i){t.crypto=!0;try{return i.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: ".concat(X(e)))}}t.perfNow=!0;for(var n=0;n<e.length;n+=1){try{var o=Math.floor(100*window.performance.now())%10;(o<0||o>9)&&(o=0);for(var r=0;r<o;r+=1)Math.random()}catch(e){t.exceptions.push("Math.random: ".concat(X(e)))}e[n]=Math.floor(16*Math.random())}return t}(e),i=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[i];return i+=1,("x"===t?n:3&n|8).toString(16)})),t]}function le(){return"xxxxxxxx-xxxx-4xxx-xxxx-xxxxxxxxxxxx".replace(/[x]/g,fe)}function fe(){var e=new Uint8Array(1);return window.self.crypto&&window.self.crypto.getRandomValues?(window.self.crypto.getRandomValues(e),Math.floor(e[0]/16).toString(16)):window.msCrypto&&window.msCrypto.getRandomValues?(window.msCrypto.getRandomValues(e),Math.floor(e[0]/16).toString(16)):Math.floor(16*Math.random()).toString(16)}!function(e){e[e.Firefox=0]="Firefox",e[e.Opera=1]="Opera",e[e.IE=2]="IE",e[e.Edge=3]="Edge",e[e.Chrome=4]="Chrome",e[e.Safari=5]="Safari",e[e.TeamsElectron=6]="TeamsElectron",e[e.Unknown=7]="Unknown"}(ce||(ce={}));var pe,he=window.navigator,ve=he?he.userAgent:void 0;function we(){if(ve){if(ve.indexOf("Firefox")>-1)return ce.Firefox;if(ve.indexOf("Opera")>-1||ve.indexOf("OPR")>-1)return ce.Opera;if(ve.indexOf("Trident")>-1)return ce.IE;if(ve.indexOf("Electron")>-1&&ve.indexOf("Teams")>-1)return ce.TeamsElectron;if(ve.indexOf("Edg")>-1)return ce.Edge;if(ve.indexOf("Chrome")>-1)return ce.Chrome;if(ve.indexOf("Safari")>-1)return ce.Safari}return ce.Unknown}function me(){try{return!!ve&&ve.indexOf("iPad")>=0||!!ve&&ve.indexOf("Macintosh")>=0&&Te()&&!Ie()||!!ve&&ve.indexOf("Android")>=0||Te()}catch(e){return!1}}function ge(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch(e){return!1}}function Se(){try{return window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")}catch(e){return!1}}function Ie(){return!!ve&&ve.indexOf("iPhone")>=0}function be(){return Ie()||/android.+mobile/i.test(he.userAgent)}function _e(){return window.devicePixelRatio||(window.screen?window.screen.deviceXDPI/window.screen.logicalXDPI:1)||1}function Te(){return!!he&&he.maxTouchPoints>0}function Ce(e,t){t&&Object.keys(t).forEach((function(i){e[i]=t[i]}))}function ye(e,t){try{if(void 0===window.performance)return void t.ULS.Qe(595948609,P.H,A.Info,"Performance not supported");var i=window.performance.getEntriesByType("resource");if(void 0===i||i.length<=0)return void t.ULS.Qe(595948610,P.H,A.Info,"No resources under performance");for(var n=new RegExp(e+"(-boot\\.min|(\\.(app|preview))?\\.boot)(\\.[0-9a-f]{20})?\\.js","i"),o=i.length-1;o>=0;o-=1){var r=i[o],s=r.name.match(n);if(s){var a=JSON.stringify(r);return a=a.replace(new RegExp(r.name,"g"),s[0]),void t.ULS.Qe(595948616,P.H,A.Info,a)}}t.ULS.Qe(595948484,P.H,A.Info,"Could not find JSAPI resource timing entry")}catch(e){t.ULS.Qe(595948617,P.H,A.Info,"Could not trace the resource timing: ".concat(X(e)))}}function Pe(e){var t,i,n=j(j({},e.host),{sessionId:e.hostSessionId,domain:location?location.host:void 0});delete n.siteId,delete n.webId,delete n.uiHostTabId;var o={};if(e.wdParams){var r=JSON.parse(JSON.stringify(e.wdParams).toLowerCase());["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(e){r[e]&&(o[e]=r[e])}));var s=/^\w{8}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{12}$/i;o.wdprevioussession&&!s.test(o.wdprevioussession)&&delete o.wdprevioussession,o.wdpreviouscorrelation&&!s.test(o.wdpreviouscorrelation)&&delete o.wdpreviouscorrelation}var a=j({},e.rebootOverride);delete a.ackExpected,delete a["ui-language"],delete a.wdUserSession,delete a.rebootMode,delete a.documentUrl;var c,d,u=e.wopi;return{accessToken:u?{length:u.accessToken.length,expiry:u.expiry}:"N/A",wacToken:u&&u.wacToken?{length:u.wacToken.length}:void 0,bootParams:e.bootParams,build:W(),host:n,intent:e.intent,jsApiVersion:"v2",rebootOverride:a,region:(c=e.appBaseUrl,d=c.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i),d&&d[1]?d[1]:"public"),sessionOrigin:e.hostInitDiagnostics?e.hostInitDiagnostics.entryPoint:void 0,sessionContext:e.sessionContext,throttling:e.throttling,ui:e.ui,viewMode:e.viewMode,meeting:e.meeting?{id:null===(t=e.meeting)||void 0===t?void 0:t.id,isPresenter:null===(i=e.meeting)||void 0===i?void 0:i.isPresenter}:void 0,wdParams:o}}function Ae(){var e={perfNowSupported:!0,browser:ce[we()],touchMode:me(),highContrast:ge(),windows10x:Se()};try{var t=window.navigator,i=t.connection||t.mozConnection||t.webkitConnection;i&&(e.netDownlink=i.downlink,e.netDownlinkMax=i.downlinkMax,e.netEffectiveType=i.effectiveType,e.netRtt=i.rtt,e.netSaveData=i.saveData,e.netType=i.type),e.deviceMemory=t.deviceMemory,e.logicalProcessors=t.hardwareConcurrency}catch(e){}return e}function Ue(e){try{var t=e.hostInitDiagnostics;e.logger.ULS.Qe(558155803,P.H,A.Info,"HostInitDiagnostics: "+(t?JSON.stringify(t):"N/A")),e.logger.ULS.Qe(596444237,P.H,A.Info,JSON.stringify({session:Pe(e),client:e.clientDiagnostics}))}catch(t){e.logger.ULS.Qe(558155804,P.H,A.Error,"Failed to log init info: ".concat(X(t)))}}function Ee(){try{return localStorage.setItem("Test","Test"),localStorage.removeItem("Test"),!0}catch(e){return!1}}function Oe(e,t){try{var i=parseInt(e,10);if(!i)return;if(i<=x()-6e4)t.ULS.Qe(558155805,P.H,A.Warning,"Bad userClickTime or host took 60+s to kick off the session from click");else if(Ee()){var n=i.toString(),o=localStorage.getItem("lastUserClickTime");if(o){var r=parseInt(o,10);r&&i<=r?t.ULS.Qe(558155806,P.H,A.Warning,"Bad userClickTime: less than or equal to lastUserClickTime, delta: "+(r-i)):localStorage.setItem("lastUserClickTime",n)}else localStorage.setItem("lastUserClickTime",n)}}catch(e){t.ULS.Qe(558155807,P.H,A.Error,"Error when tracking userClickTime: "+X(e))}}function Fe(e){var t=window.performance.timing;t&&(e.hostPageNavigationStartTime||(e.hostPageNavigationStartTime=t.navigationStart),e.hostPageFetchStartTime||(e.hostPageFetchStartTime=t.fetchStart),e.hostPageRequestStartTime||(e.hostPageRequestStartTime=t.requestStart),e.hostPageResponseStartTime||(e.hostPageResponseStartTime=t.responseStart),e.hostPageResponseEndTime||(e.hostPageResponseEndTime=t.responseEnd),e.hostPageDomCompleteTime||(e.hostPageDomCompleteTime=t.domComplete));var i=window.performance.navigation;if(i&&(void 0===e.hostPageRedirectCount&&(e.hostPageRedirectCount=i.redirectCount),!e.hostPageNavigationType)){var n="UNKNOWN";switch(i.type){case 0:n="NAVIGATE";break;case 1:n="RELOAD";break;case 2:n="BACK_FORWARD";break;case 255:n="RESERVED"}e.hostPageNavigationType=n}}!function(e){e[e.Unknown=0]="Unknown",e[e.Normal=1]="Normal",e[e.Minor=2]="Minor",e[e.Medium=3]="Medium",e[e.Major=4]="Major",e[e.Critical=5]="Critical"}(pe||(pe={}));var ke=function(){function e(e,t){this.tr=function(){return We(e,"OnBeforeUnload",t)},this.ir=function(){return We(e,"OnPageHide",t)},this.nr=function(){return We(e,"VisibilityChange_"+document.visibilityState,t)},this.or=function(){return We(e,"OnUnload",t)},window.addEventListener("beforeunload",this.tr,{capture:!0,once:!0}),window.addEventListener("pagehide",this.ir,{capture:!0}),window.addEventListener("visibilitychange",this.nr,{capture:!0}),window.addEventListener("unload",this.or,{capture:!0,once:!0})}return e.prototype.dispose=function(){window.removeEventListener("beforeunload",this.tr,{capture:!0}),window.removeEventListener("pagehide",this.ir,{capture:!0}),window.removeEventListener("visibilitychange",this.nr,{capture:!0}),window.removeEventListener("unload",this.or,{capture:!0})},e}();function We(e,t,i){e.ULS.Qe(595957843,P.H,A.Info,"Page lifecycle: ".concat(t," fired")+(i?", flushing logger":"")),i&&e.ULS.flush()}var Ne=["https://augloop.office.com/v2","api://visio.officeapps.live.com/va/00695ed2-3202-4156-8da1-69f60065e255","394866fc-eedb-4f01-8536-3ff84b16be2a","https://officescripting.microsoft.com","https://officescripting-int.microsoft.com","https://nleditor.osi.office.net/nleditor","e03a13ee-9730-4cae-8525-47559c8cf18a","https://powerquery.microsoft.com","api://app.powerbi.com/00000009-0000-0000-c000-000000000000"],Re=function(){function e(e){var t=this;this.rr={},this.sr=[],this.ar=function(e){if(e&&e.origin)try{var i=e.data;if("string"==typeof i&&i.includes("AddinTrustedOrigin")){var n=JSON.parse(i),o=n.AddinTrustId;o&&"AddinTrustedOrigin"===n.MessageId&&(t.Qt.ULS.Qe(560754784,P.H,A.Info,"didReceiveMessage addinTrustId ".concat(o)),t.rr[o]=e.origin,t.sr.forEach((function(t){t(o,e.origin)})))}}catch(e){t.Qt.ULS.Qe(560754785,P.H,A.Error,"AuthTokenTrustValidator didReceiveMessage failed")}},this.Qt=e,window.addEventListener("message",this.ar)}return e.prototype.isResourceTrustedForMessage=function(e){return z(this,void 0,void 0,(function(){var t,i,n,o,r,s,a,c,d=this;return q(this,(function(u){switch(u.label){case 0:return e&&e.Resource?(t=e.Resource,i=e.AddinTrustId,(n=function(e){if(!e)return!1;for(var t=e.toLowerCase(),i=0,n=Ne;i<n.length;i++){var o=n[i];if(o===t||"".concat(o,"/")===t)return!0}return!1}(t))||!i?[2,n]:this.rr[i]?[2,Me(t,this.rr[i])]:(r=new Promise((function(e){o=function(n,o){i===n&&e(Me(t,o))},d.sr.push(o)})),s=-1,a=new Promise((function(e){s=window.setTimeout((function(){d.Qt.ULS.Qe(560754786,P.H,A.Warning,"isResourceTrustedForMessage - timeout waiting for addinTrustId: ".concat(i)),e(!1)}),2e3)})),[4,Promise.race([r,a])])):[2,!1];case 1:return c=u.sent(),this.sr=this.sr.filter((function(e){return e!==o})),window.clearTimeout(s),[2,c]}}))}))},e.prototype.dispose=function(){this.rr={},this.sr=[],window.removeEventListener("message",this.ar)},e}();function Me(e,t){try{if(!e||!t)return!1;for(var i=/[?&#%\\]/,n=0;n<e.length;n+=1){var o=e.charCodeAt(n);if(o<33||o>126)return!1;var r=e.charAt(n);if(i.test(r))return!1}var s=e;"api:"===s.substring(0,"api:".length).toLowerCase()&&(s="".concat("https:").concat(s.substring("api:".length)));var a=new URL(s);return"https:"===a.protocol&&t.toLowerCase()===a.origin.toLowerCase()}catch(e){return!1}}var xe,De=function(){function e(e,t,i,n,o,r,s){var a,c,d=this;this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.pendingReboot=!1,this.skipWopiValidation=!1,this.skipFileNameCheck=!1,this.appContext={},this.isLoggerFromOwl=!1,this.appUrl="",this.appBaseUrl="",this.appBasePath="",this.remoteTelemetryUrl="",this.cr={},this.onMessage=function(e){var t=e.MessageId,i=e.Values||{},n=d.cr[t];if(n&&n.length>0)d.dr(t,i);else{var o=de[t];if(o){var r=o.Qo,s=o.er;r?(d.logger.ULS.Qe(574654543,P.H,A.Info,"Running flow: ".concat(r)),d.ur[r](t,i,d,d.lr[r]).catch((function(e){d.pr(r,e)}))):s&&(s===oe.Share&&(i.sendTimeAsClickTime=e.SendTime),d.raiseEvent(s,i))}}},this.pr=function(e,t){d.logger.ULS.Qe(596459925,P.H,A.Error,"".concat(e," flow error: ").concat(X(t))),d.remoteTelemetryUrl&&R(d.remoteTelemetryUrl,d.appInfo.name,"flowException")},this.dr=function(e,t){d.logger.ULS.Qe(574654544,P.H,A.Info,"Dispatching action: ".concat(e));for(var i=d.cr[e].slice().reverse(),n=i.length-1;n>-1;n-=1)try{i[n](e,t)}catch(t){d.logger.ULS.Qe(596444186,P.H,A.Error,"".concat(e," action handler error: ").concat(X(t)))}return Promise.resolve({completion:"success"})},this.state=y.Unknown;var u=ue(),l=u[0],f=u[1];this.isLoggerFromOwl=!!i.logger,this.logger=null!==(c=i.logger)&&void 0!==c?c:L(),this.logger.ULS.Qe(593506837,P.H,A.Info,JSON.stringify(f)),this.sessionId=l,this.hostSessionId=i.hostSessionId,this.host=e.host,this.hostName=this.host.uiHostName||this.host.storageHostName,this.user=e.user,this.bootstrapperUrl=e.bootstrapperUrl,this.ui=e.ui||{},this.viewMode=e.viewMode,this.application=n,this.appInfo=t,this.session=o,this.featureManager=Q(e.host.capabilities&&e.host.capabilities.isFeatureEnabledCallback,this.logger),this.Ye=new ae(t.name,this.logger),this.preloader=t.preloader,a=r(this.featureManager),this.ur=a[0],this.lr=a[1],this.hr=s,this.clientDiagnostics=Ae(),this.pageStateObserver=new ke(this.logger,!0),this.authTokenTrustValidator=new Re(this.logger)}return Object.defineProperty(e.prototype,"diagnostics",{get:function(){return{hostInitDiagnostics:this.hostInitDiagnostics,appInitDiagnostics:this.appInitDiagnostics}},enumerable:!1,configurable:!0}),e.prototype.raiseEvent=function(e,t){this.logger.ULS.Qe(574654541,P.H,A.Info,"Raising event: ".concat(e));try{this.hr(e,t)}catch(e){this.logger.ULS.Qe(593506838,P.H,A.Error,"Event handler error: ".concat(X(e)))}},e.prototype.addActionHandler=function(e,t){this.cr[e]||(this.cr[e]=[]),this.cr[e].push(t)},e.prototype.removeActionHandler=function(e,t){var i=this.cr[e];if(i&&i.length>0){var n=i.indexOf(t);n>-1&&i.splice(n,1)}},e.prototype.run=function(e,t,i){var n=this;if(this.state===y.Disposed&&this.backgroundSession)return this.logger.ULS.Qe(525203609,P.H,A.Info,"Redirecting to background session: ".concat(e)),this.backgroundSession.run(e,t,i);var o=[],r=this.cr[e];if(r&&r.length>0)o.push(this.dr(e,t));else{var s=de[e];if(s){var a=s.Qo,c=s.Yo;if(a){this.logger.ULS.Qe(574654542,P.H,A.Info,"Running flow: ".concat(a));var d=this.ur[a](e,t,this,this.lr[a],i).catch((function(e){return n.pr(a,e),{completion:"failure",errorSource:"jsapi",error:e}}));o.push(d)}else c&&(this.container&&this.container.postMessage(c,t),o.push(Promise.resolve({completion:"success"})))}else o.push(Promise.resolve({completion:"failure"})),this.logger.ULS.Qe(593500189,P.H,A.Warning,"Unhandled command: ".concat(e))}return Promise.race(o)},e.prototype.dispose=function(){if(this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.Ye.dispose(),this.pageStateObserver.dispose(),this.authTokenTrustValidator.dispose(),this.cr={},!this.pendingReboot){var e=this.application.sessions,t=e.indexOf(this.session);t>-1&&e.splice(t,1)}},e}(),Be=function(){function e(e,t,i,n,o,r){var s=this;!function(e){if(!e)throw new TypeError("SessionInitParams");if(!e.hostSessionId)throw new TypeError("HostSessionId")}(i),this.vr=new De(e,t,i,n,this,r,(function(e,t){return o({type:e,data:t,session:s})})),this.vr.state=y.Initialized}return Object.defineProperty(e.prototype,"id",{get:function(){return this.vr.sessionId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"diagnostics",{get:function(){return this.vr.diagnostics},enumerable:!1,configurable:!0}),e.prototype.run=function(e,t,i){return this.vr.run(e,t,i)},e.prototype.boot=function(e,t){return this.vr.run(te.boot,e,t)},e.prototype.dispose=function(e){return this.vr.run(te.dispose,void 0,e)},e}();function He(e){if(!e)return"";var t=""+document.cookie,i=new RegExp("(?:^|; )"+e+"=([^;]*)"),n=t.match(i);return!n||n.length<2?"":n[1]}function Ve(e,t,i,n,o){void 0===n&&(n=xe.none);var r=e+"="+t,s="",a=new Date;a.setTime(a.getTime()+31536e6);var c=new Date;c.setTime(c.getTime()+864e5*i),c>a&&(c=a),c&&(s=";expires="+c.toUTCString());var d=r+s+";SameSite="+xe[n];return document.cookie=o?d+"; Secure":d,!(!document.cookie||-1===document.cookie.indexOf(r))||n===xe.none&&Ve(e,t,i,xe.doNotSet,o)}!function(e){e[e.doNotSet=0]="doNotSet",e[e.none=1]="none",e[e.lax=2]="lax",e[e.strict=3]="strict"}(xe||(xe={}));var Le,Je=function(){function e(e,t,i,n){var o,r,s=this;this.wr="",this.mr="",this.gr=!1,this.Sr=!1,this.Ir=!1,this.br=!1,this._r=function(e){var t,i=!1,n=!0,o="",r=!1;if(s.Tr&&s.Tr.contentWindow&&(i=!0,n=e.source===s.Tr.contentWindow),e.origin&&!(r=(o=d(e.origin,2).toLowerCase())===s.mr)&&s.Cr&&(o=d(e.origin).toLowerCase(),r=s.Cr.includes(o)),!s.gr&&(!s.Sr||r&&n)||s.Qt.ULS.Qe(593232850,P.H,A.Info,"Window: available["+i+"] valid["+n+"]; Origin: valid["+r+"] expected["+s.mr+"] actual["+o+"]"),r&&(!s.Ir||n)){var a;try{a=JSON.parse(e.data)}catch(e){return void s.Qt.ULS.Qe(593232851,P.H,A.Info,"Failed to parse event data: ".concat(X(e)))}var c=a.MessageId;if(c){if(s.Qt.ULS.Qe(593232854,P.H,A.Info,"Received message: ".concat(c,", correlation: ").concat(a.CorrelationId)),c!==ie.vi&&c!==ie.Bi||s.setTargetOrigin(e.origin),a.Values&&a.Values.ackExpected&&s.postMessage(ne.io,void 0,a.CorrelationId),s.br&&c===ie.$n)return window._pageTimings=null!==(t=window._pageTimings)&&void 0!==t?t:{},void(window._pageTimings[a.Values.name]=a.Values.time);if(s.yr)try{s.yr(a)}catch(e){s.Qt.ULS.Qe(594556386,P.H,A.Error,"Message handler error: ".concat(X(e)))}else s.Qt.ULS.Qe(591933923,P.H,A.Error,"No message handler")}else(s.gr||s.Sr)&&s.Qt.ULS.Qe(593232853,P.H,A.Info,"Missing message id")}},this.Qt=t,this.setTargetOrigin(e),this.Cr=n,i&&this.setMessageHandler(i),this.br=!!(null===(r=null===(o=window.location)||void 0===o?void 0:o.search)||void 0===r?void 0:r.match(/wdpa=1/gi))||"1"===He("EnableMetricLogging"),window.addEventListener("message",this._r,!1)}return e.prototype.setTargetOrigin=function(e){var t=c(e).toLowerCase();this.wr&&this.wr!==t&&this.Qt.ULS.Qe(593232847,P.H,A.Warning,"Updating origin: [".concat(T(this.wr),"]->[").concat(T(t),"]")),this.wr=t,this.mr=d(t,2),this.gr=r(t),this.Sr=s(t)},e.prototype.setTargetFrame=function(e,t){this.Tr=e,this.Ir=!!t},e.prototype.setMessageHandler=function(e){this.yr=e},e.prototype.removeMessageHandler=function(){this.yr=void 0},e.prototype.postMessage=function(e,t,i){if(this.Tr&&this.Tr.contentWindow){this.Qt.ULS.Qe(593232849,P.H,A.Info,"Sending message: "+e);var n={MessageId:e,SendTime:x(),CorrelationId:i,Values:t};this.Tr.contentWindow.postMessage(JSON.stringify(n),this.wr)}else this.Qt.ULS.Qe(593232848,P.H,A.Error,"Missing target to send message: "+e)},e.prototype.dispose=function(){window.removeEventListener("message",this._r,!1),this.yr=void 0},e}();function Ge(e,t){we()===ce.Safari?e.style.display=t?"none":"block":e.style.visibility=t?"hidden":"visible"}function je(e){try{return window===window.top||window.parent===window.top&&window.location.origin===window.top.origin}catch(t){return e&&e.ULS.Qe(591525084,P.H,A.Info,"Trust check error: ".concat(X(t))),!1}}function ze(e){return!(!e||!e.parentNode)&&(e.id?!!document.getElementById(e.id):void 0!==e.isConnected?e.isConnected:document.body.contains(e))}!function(e){e.Pr="access_token",e.Ar="access_token_ttl",e.Ur="wac_token",e.Er="bundleSrc",e.Or="bundleStaleness",e.Fr="DocID",e.kr="SiteID",e.Wr="WebID",e.Nr="ETag",e.Rr="feature_status",e.Mr="fileExtension",e.xr="fileGetUrl",e.Dr="customFontCatalogUrl",e.Br="fileName",e.Hr="fileSize",e.Vr="forceSLR",e.Lr="frameHeightPx",e.Jr="frameWidthtPx",e.Gr="highContrast",e.jr="highDpi",e.zr="host_diagnostics",e.qr="hostName",e.Kr="huictrls",e.Zr="owner_id",e.$r="sc",e.Xr="softBlockedBrowser",e.Qr="templateUrl",e.Yr="touchMode",e.es="user_id",e.ts="hfck",e.ns="hfcv",e.os="timeZoneId",e.rs="darkCssMedia",e.ss="caae",e.as="meetingId",e.cs="meetingTitle",e.ds="meetingType",e.us="scheduledStartTime",e.ls="scheduledEndTime",e.fs="isPresenter",e.ps="meetingOrganizerId",e.hs="meetingJoinUrl",e.vs="isMeetingTeamsRoom",e.ws="jsapibuild",e.ms="owlver",e.gs="owlro",e.Ss="caaemode",e.Is="traceparent",e.bs="tracestate",e._s="supports_zipit"}(Le||(Le={}));var qe=function(){function e(e,t){!function(e){if(!e||!e.appendChild)throw TypeError("Container")}(e),this.Ts=e,this.Cs=t,this.ys=t+"_Form",this.Ps=je()}return Object.defineProperty(e.prototype,"element",{get:function(){return this.Ts},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameId",{get:function(){return this.Cs},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formId",{get:function(){return this.ys},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTopFrameTrusted",{get:function(){return this.Ps},enumerable:!1,configurable:!0}),e.prototype.boot=function(e,t,i,n){var o=this;this.Qt=i,this.As=new Je(e,i,this.yr,n.additionalReceivingDomainList);var r=n.useAdditionalDiv,s=n.permissionsPolicy;this.Us&&!r?(this.Us.setAttribute("allow",s),this.Qt.ULS.Qe(588793045,P.H,A.Info,"Wac frame reused")):(this.Us=function(e,t,i,n,o,r,s,a){e.style.top="0",e.style.bottom="0",e.style.left="0",e.style.right="0",e.style.height="100%",e.style.width="100%";var c=e.ownerDocument,d=c.createElement("iframe");if(d.id=t,d.name=t,d.src="",d.title="Office on the web Frame",d.marginWidth="0",d.marginHeight="0",d.style.top="0",d.style.bottom="0",d.style.left="0",d.style.right="0",d.style.height="100%",d.style.width="100%",d.style.display="block",d.style.position="absolute",d.style.backgroundColor="transparent",d.style.border="none",d.frameBorder="0",d.setAttribute("allowfullscreen","true"),d.setAttribute("allowTransparency","true"),d.setAttribute("allow",i),Ge(d,s),n&&(e.style.minHeight=n,d.style.minHeight=n),o&&(e.style.minWidth=o,d.style.minWidth=o),a&&d.setAttribute("role","none"),r){var u=c.createElement("div");u.style.top="0",u.style.bottom="0",u.style.left="0",u.style.right="0",u.style.height="100%",u.style.width="100%",u.style.backgroundColor="#393a3d",u.style.backfaceVisibility="hidden",n&&(u.style.minHeight=n),o&&(u.style.minWidth=o),u.appendChild(d),e.appendChild(u)}else e.appendChild(d);return d}(this.Ts,this.Cs,s,n.minHeight,n.minWidth,r,n.isInvisible,n.setNoneRole),this.Qt.ULS.Qe(588793046,P.H,A.Info,"Wac frame created")),this.As.setTargetFrame(this.Us,n.enforceSameWindow),r&&(this.Es=this.Us.parentElement),n.useFrameFixForTeams&&i.ULS.Qe(509143245,P.H,A.Info,"Frame fix enabled for teams uiHost"),function(e,t,i){l(t,Le.Lr,String(i?window.outerHeight:e.offsetHeight)),l(t,Le.Jr,String(i?window.outerWidth:e.offsetWidth)),l(t,Le.Yr,String(me())),l(t,Le.Gr,String(ge())),l(t,Le.Vr,String(Se())),l(t,Le.rs,String(function(){try{return window.matchMedia("(prefers-color-scheme: dark)").matches}catch(e){return!1}}()))}(this.Us,t,n.useFrameFixForTeams),this.Os=function(e,t,i,n,o){var r=e.ownerDocument,s=r.createElement("form");for(var a in s.id=i,s.name=i,s.action=n,s.target=t,s.method="POST",o){var c=r.createElement("input");c.type="hidden",c.name=a,c.value=o[a],s.appendChild(c)}return e.appendChild(s),s}(this.Ts,this.Cs,this.ys,e,t);try{this.Os.submit()}catch(e){this.Qt.ULS.Qe(507909977,P.H,A.Warning,"WAC frame failed to submit, will retry. Error: ".concat(X(e))),new Promise((function(e){window.setTimeout(e,10)})).then((function(){o.Os.submit()})).catch((function(e){throw o.Qt.ULS.Qe(507909976,P.H,A.Error,"WAC frame failed to submit on retry. Error: ".concat(X(e))),e}))}},e.prototype.setVisibility=function(e){this.Us&&Ge(this.Us,e)},e.prototype.setMessageHandler=function(e){this.yr=e,this.As&&this.As.setMessageHandler(e)},e.prototype.setWrapperPostMessage=function(e){this.Fs=e},e.prototype.removeMessageHandler=function(){this.yr=void 0,this.As&&this.As.removeMessageHandler()},e.prototype.postMessage=function(e,t){this.Fs?this.Fs(e,t):this.As&&this.As.postMessage(e,t)},e.prototype.dispose=function(e,t){var i=this;return new Promise((function(n){if(i.Os&&(i.Ts.removeChild(i.Os),i.Os=void 0),i.As&&(i.As.dispose(),i.As=void 0,i.yr=void 0),i.Fs&&(i.Fs=void 0),i.Qt=void 0,!i.Us||!i.Es&&e)n();else{var o=function(){i.Es?(i.Es.removeChild(i.Us),i.Ts.removeChild(i.Es)):i.Ts.removeChild(i.Us),i.Us=void 0,i.Es=void 0,n()};t?o():(i.Us.src="about:blank",window.setTimeout(o,0))}}))},e}(),Ke=function(){function e(e,t,i){var n=this;this.sessions=[],this.containers=[],this.ks=function(e){n.Ws.dispatch(e)},function(e){if(!e)throw new TypeError("ApplicationInitParams");var t=e.host;if(!t||!t.storageHostName)throw new TypeError("HostInfo");var i=e.user;if(!i||null==i.id)throw new TypeError("UserInfo")}(e),this.Ns=e,this.Rs=t,this.Ms=i,this.Ws=new se,function(e){if(e&&(k.BUILD_NUMBER=e,e.includes("."))){var t=e.split(".");k.BUILD_NUMBER_MINOR=parseInt((t[0]||"").concat((t[1]||"").padStart(3,"0")),10)}}(e.host.owlVersion)}return Object.defineProperty(e.prototype,"name",{get:function(){return this.Rs.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return W()},enumerable:!1,configurable:!0}),e.prototype.addEventListener=function(e){this.Ws.add(e)},e.prototype.removeEventListener=function(e){this.Ws.remove(e)},e.prototype.createContainer=function(e){var t="WacFrame_".concat(this.Rs.name,"_").concat(this.containers.length),i=new qe(e,t);return this.containers.push(i),i},e.prototype.createSession=function(e){var t=new Be(this.Ns,this.Rs,e,this,this.ks,this.Ms);return this.sessions.push(t),t},e.prototype.dispose=function(e){var t=this,i=this.sessions.map((function(t){return t.dispose(e).catch((function(e){}))}));return Promise.all(i).then((function(e){return t.Ws.removeAll(),t.sessions=[],t.containers=[],{completion:"success"}}))},e}(),Ze=function(e,t,i){return new Promise((function(t){i.logger.ULS.Qe(590111070,P.H,A.Error,"Unsupported flow: ".concat(e)),t({completion:"failure"})}))};function $e(e){return!(!(e&&e.source&&e.accessToken)||!e.expiry&&0!==e.expiry)}function Xe(e){return function(e,t){var i={};return t&&Object.keys(t).forEach((function(e){i[e.toLowerCase()]=t[e]})),e.split("&").forEach((function(e){if(/^wd\w+=.+/i.test(e)){var t=e.split("=");i[t[0].toLowerCase()]=t[1]}})),i}(window.location.search.substring(1),e)}function Qe(e,t,i){var n=j(j(j({},function(e){var t={},i=e.indexOf("?");return-1===i||i===e.length-1||e.substring(i+1).replace(new RegExp(/<.*?>/g),"").split("&").forEach((function(e){if(e){var i=e.indexOf("=");-1!==i&&i!==e.length-1&&(t[e.substring(0,i).toLowerCase()]=e.substring(i+1))}})),t}(e.appUrl)),function(e){var t={};l(t,"jsapi","1"),l(t,"jsapiver","v2"),l(t,"corrid",e.sessionId),l(t,"usid",e.sessionId),l(t,"newsession","1"),l(t,"sftc","1"),e.hostSessionId&&l(t,"hid",encodeURIComponent(e.hostSessionId));var i=e.host;i.uiHostName&&l(t,"uih",i.uiHostName),i.uiHostIntegrationType&&l(t,"uihit",encodeURIComponent(i.uiHostIntegrationType)),i.metaUiHostVersion&&l(t,"muv",encodeURIComponent(i.metaUiHostVersion));var n=i.capabilities;n&&(n.accessibilityLoop&&l(t,"accloop","1"),n.rebootDoc&&l(t,"sdr",n.rebootDoc.toString()),n.createNewDoc&&l(t,"scnd","1"),n.authToken&&l(t,"sat","1"),n.customAuthConfig&&l(t,"cac","1"),n.refreshAccessToken&&l(t,"rat","1"),n.atMentions&&l(t,"sams","1"),n.moveToFolder&&l(t,"mtf","1"),n.noBrowserModalDialogs&&l(t,"nbmd","1"),n.commonFilePicker&&l(t,"sfp","1"),n.directDownload&&l(t,"sdd","1"),n.directPrint&&l(t,"sdp","1"));var o=e.ui;o.language&&l(t,"ui",encodeURIComponent(o.language)),o.uiEmbed&&l(t,"uiembed","1"),(o.hideHeader||"DocGen"===o.contentAssemblyMode||"Templatization"===o.contentAssemblyMode||"ContentAssemblyEdit"===o.contentAssemblyMode||"ContentAssemblyView"===o.contentAssemblyMode)&&l(t,"hhdr","1"),o.highContrast&&l(t,"hcm",encodeURIComponent(o.highContrast)),o.hideFileLocationPicker&&l(t,"hodflp","1"),o.hideAppLauncherInHeader&&l(t,"halh","1"),o.hideChatInHeader&&l(t,"hch","1"),o.hideMeInHeader&&l(t,"hmh","1"),o.hideSearchInHeader&&l(t,"hsh","1"),o.hideWorkflowInHeader&&l(t,"hwfh","1"),o.hideSettingsInHeader&&l(t,"hsth","1"),o.showAppIconInHeader&&l(t,"sih","1"),o.useNeutralColorInHeader&&l(t,"unh","1"),o.openLinksInNewWindow&&l(t,"onw","1"),o.useDarkTheme&&l(t,"udt","1"),"DocGen"!==o.contentAssemblyMode&&"ContentAssemblyView"!==o.contentAssemblyMode||l(t,"readOnly","1");var r=e.wopi;r&&r.source&&l(t,"wopisrc",encodeURIComponent(r.source));var s=e.bootParams;s&&(s.dataLanguage&&l(t,"rs",encodeURIComponent(s.dataLanguage)),s.readOnly&&l(t,"readonly","1"),s.disableChat&&l(t,"dchat","1"),s.cookieCompliant&&l(t,"mscc","1"),s.isNewFile&&(l(t,"new","1"),s.isFromHostTemplate&&l(t,"wdtpl","fromhost"))),e.user.isLicensed&&l(t,"islicenseduser","1"),e.user.isSynthetic&&l(t,"syn","1"),e.actNavId&&l(t,"actnavid",e.actNavId),e.sessionContext&&l(t,"sc",encodeURIComponent(e.sessionContext));var a=e.wdParams;if(a)for(var c in a)l(t,c,a[c]);var d=e.preseededSession;d&&(d.key&&l(t,"preseededsessionkey",encodeURIComponent(d.key)),d.id&&l(t,"preseededwacsessionid",encodeURIComponent(d.id)));var u=e.throttling;u&&(u.protection&&l(t,"ctp",u.protection),u.request&&l(t,"rct",u.request));var p=e.hostInitDiagnostics;p&&(p.entryPoint&&l(t,"wdorigin",encodeURI(p.entryPoint)),p.userClickTime&&l(t,"wdhostclicktime",p.userClickTime.toString()));var h=e.rebootOverride;return h&&h.previousSessionId&&l(t,"wdprevioussession",h.previousSessionId),f(t,"region"),t}(e)),i),o=e.rebootOverride;return o&&o.queryOverrides&&(n=j(j({},n),o.queryOverrides)),function(e,t,i){var n=[];for(var o in i)i[o]&&n.push(o+"="+i[o]);return e+t+(n.length>0?"?"+n.join("&"):"")}(e.appBasePath,t,n)}function Ye(e,t){var i=function(e){var t={};l(t,"highdpi",String(window.devicePixelRatio>1.24)),l(t,"softblockedbrowser",String(we()===ce.IE&&!(we()===ce.IE&&null!=document.documentMode&&void 0!==document.documentMode&&document.documentMode>=11))),l(t,"hostname",e.hostName),l(t,"feature_status",Y(e.featureManager,e.wdParams)),l(t,"jsapibuild",W());var i=e.wopi;i&&(l(t,"access_token",i.accessToken),l(t,"access_token_ttl",i.expiry.toString()),i.wacToken&&l(t,"wac_token",i.wacToken));var n=e.customFontCatalogUrl;n&&l(t,"customfontcatalogurl",n);var o=e.contentBundle;if(o){if(o.url){l(t,"bundlesrc",o.url);var r=o.staleness,s=null!=r;s&&l(t,Le.Or,r.toString()),e.logger.ULS.Qe(577783775,P.H,A.Info,"Content bundle staleness: "+(s?r:"N/A"))}o.urlNoAuth&&l(t,"bundleurlnoauth",o.urlNoAuth),o.bundleCode&&l(t,"bundlecode",o.bundleCode)}var a=e.file,c=a.name;if(c){l(t,"filename",c);var d=Z(c);d&&l(t,"fileextension",d)}a.getUrl&&l(t,"filegeturl",a.getUrl),a.downloadCode&&l(t,"filedownloadcode",a.downloadCode),a.urlNoAuth&&l(t,"fileurlnoauth",a.urlNoAuth),a.size&&l(t,"filesize",a.size.toString()),a.eTag&&l(t,"etag",a.eTag),a.cTag&&l(t,"revid",a.cTag),a.uniqueId&&l(t,"docid",a.uniqueId),void 0!==a.immutableReason&&l(t,"immutableReason",a.immutableReason.toString()),void 0!==a.supportsZipIt&&l(t,"supports_zipit",a.supportsZipIt.toString());var u=e.newFileTemplate;u&&(u.getUrl&&l(t,"templateurl",u.getUrl),u.size&&l(t,"filesize",u.size.toString()),u.eTag&&l(t,"etag",u.eTag),u.uniqueId&&l(t,"docid",u.uniqueId)),e.user.id&&l(t,"user_id",e.user.id),e.ownerId&&l(t,"owner_id",e.ownerId),e.sessionContext&&l(t,"sc",e.sessionContext);var f=e.ui;f.controls&&l(t,"huictrls",JSON.stringify(f.controls)),"Templatization"!==f.contentAssemblyMode&&"DocGen"!==f.contentAssemblyMode&&"ContentAssemblyEdit"!==f.contentAssemblyMode&&"ContentAssemblyView"!==f.contentAssemblyMode||l(t,"caae","1"),f.contentAssemblyMode&&l(t,"caaemode",f.contentAssemblyMode);var p=e.meeting;p&&(p.id&&l(t,"meetingId",p.id),p.title&&l(t,"meetingTitle",p.title),p.type&&l(t,"meetingType",p.type),p.scheduledStartTime&&l(t,"scheduledStartTime",p.scheduledStartTime),p.scheduledEndTime&&l(t,"scheduledEndTime",p.scheduledEndTime),p.isPresenter&&l(t,"isPresenter",p.isPresenter.toString()),p.organizerId&&l(t,"meetingOrganizerId",p.organizerId),p.joinUrl&&l(t,"meetingJoinUrl",encodeURIComponent(p.joinUrl)),p.isMeetingTeamsRoom&&l(t,"isMeetingTeamsRoom",p.isMeetingTeamsRoom.toString()));var h=e.host;return h.owlVersion&&l(t,"owlver",h.owlVersion),h.owlRollout&&l(t,"owlro",h.owlRollout),t}(e);return Object.keys(t).forEach((function(e){t[e]?i[e]=t[e]:delete i[e]})),i}var et=function(e,t,i,n,o){return e!==te.createNew?Promise.reject("Wrong flow"):new Promise((function(r){var s={wopiPendingInitializeTime:x()},a=!!(n&&n.parallelizeStartSessionRequest&&n.buildStartSessionRequestParams)&&n.parallelizeStartSessionRequest(i),c=!1,d=!1,u=!1,l=!1,f=void 0,p=void 0,h=!1,v=!1;if(we()===ce.IE||n&&n.fallBackToSingleStepBootFlow&&n.fallBackToSingleStepBootFlow(i,t))!function(){i.logger.ULS.Qe(578074079,P.H,A.Info,"Waiting for WOPI info to start boot");var e=function(e,r){if(c)i.logger.ULS.Qe(578074080,P.H,A.Warning,"completeCreateNew already called");else{if(c=!0,s.wopiPendingCompleteTime=x(),"failure"===r.state)return O(r.reason),i.state=y.Failed,void n({completion:"failure"});tt(r.newFile),i.run(te.boot,j(j({},t),{wopi:r.wopi}),o).then((function(e){n(e)}))}};i.addActionHandler(te.completeCreateNew,e);var n=function(t){i.removeActionHandler(te.completeCreateNew,e),r(t)};o&&o.subscribe((function(){n({completion:"cancelled"})}))}();else{var w=function(e,t){c?i.logger.ULS.Qe(587236372,P.H,A.Warning,"completeCreateNew already called"):(c=!0,s.wopiPendingCompleteTime=x(),"failure"!==t.state?$e(f=t.wopi)?(i.wopi=f,i.logger.ULS.Qe(587286030,P.H,A.Info,"WOPI info received. Access token: "+JSON.stringify({length:f.accessToken.length,expiry:f.expiry})+", current state: "+JSON.stringify({parallelizeStartSessionRequest:a,wacFrameLoaded:d,wacCanAcceptStartSessionResponse:u})),!a||d&&!u?d&&_():g(),d&&i.container&&i.container.postMessage(ne.Bo,void 0),tt(t.newFile)):m("InvalidWopiInfo"):m(t.reason))},m=function(e){O(e),d&&i.container&&i.container.postMessage(ne.xo,void 0)},g=function(){i.logger.ULS.Qe(587233056,P.H,A.Info,"Making parallelized StartSession request");var t=n.buildStartSessionRequestParams(i,e,f),o=Qe(i,t.appPageName,t.queryParamsOverrides),r="access_token="+encodeURIComponent(f.accessToken)+"&access_token_ttl="+encodeURIComponent(f.expiry.toString());s.startSessionStartTime=x(),function(e,t,i,n){var o=new XMLHttpRequest;for(var r in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{n&&n(o)}finally{null!=o&&(o.onreadystatechange=function(){})}}},o.open("POST",e),i)o.setRequestHeader(r,i[r]);o.send(t)}(o,r,{"Content-Type":"application/x-www-form-urlencoded"},S)},S=function(e){var t=x();s.startSessionCompleteTime=t,i.logger.ULS.Qe(587233057,P.H,A.Info,"StartSession request completed. Status code: ".concat(e.status,", time: ").concat(t)),p={RequestStatus:e.status,ResponseText:e.responseText},d&&u?b():i.logger.ULS.Qe(587233058,P.H,A.Info,"StartSession response not yet sent: "+JSON.stringify({wacFrameLoaded:d,wacCanAcceptStartSessionResponse:u,wopiInfoSent:h,startSessionResponseSent:v}))},I=function(e,t){s.readyMessageReceiveTime=x(),i.container&&i.container.postMessage(ne.no,void 0),d||(d=!0,u=t.CanAcceptStartSessionComplete,i.logger.ULS.Qe(587321567,P.H,A.Info,"App ready: "+JSON.stringify({parallelizeStartSessionRequest:a,wacCanAcceptStartSessionResponse:u,startSessionResponseAvailable:!!p,wopiInfoAvailable:!!f})),c&&i.container&&i.container.postMessage(f?ne.Bo:ne.xo,void 0),a&&u?b():_(),Ce(i.appInitDiagnostics,t.Diagnostics))},b=function(){v||h||!p||(200===p.RequestStatus?(v=!0,s.completeMessageCreateTime=x(),T(ne.co,{StartSessionResponse:p,Diagnostics:s},3)):_())},_=function(){v||h||!f||(h=!0,s.completeMessageCreateTime=x(),n&&n.sendCreateNewWopiInfo?n.sendCreateNewWopiInfo(i):T(ne.do,{WopiDetails:{WopiSrc:f.source,AccessToken:f.accessToken,AccessTokenTtl:f.expiry.toString()},Diagnostics:s},3))},T=function(e,t,n){var o=x();n<=0?i.logger.ULS.Qe(587233165,P.H,A.Error,"Attempted to complete but no ack. Time: ".concat(o)):(i.logger.ULS.Qe(587233166,P.H,A.Info,"Sending complete message. Retries left: ".concat(n-1,", Time: ").concat(o)),s.completeMessageSendTime=o,i.container&&i.container.postMessage(e,t),window.setTimeout(C,1e3,e,t,n-1))},C=function(e,t,n){l||(i.logger.ULS.Qe(587233167,P.H,A.Info,"Timeout session complete ack. Retries left: ".concat(n)),T(e,t,n))},U=function(e,t){l=!0},E=function(e){i.removeActionHandler(te.completeCreateNew,w),i.removeActionHandler(ie.fi,I),i.removeActionHandler(ie.tn,U),r(e)};i.addActionHandler(te.completeCreateNew,w),i.addActionHandler(ie.fi,I),i.addActionHandler(ie.tn,U),o&&o.subscribe((function(){E({completion:"cancelled"})})),i.skipWopiValidation=!0,i.skipFileNameCheck=!0,i.wopi=void 0,i.run(te.boot,t,o).then((function(e){i.skipWopiValidation=!1,i.wopi=f,E(e)}))}function O(e){i.logger.ULS.Qe(596444188,P.H,A.Warning,"Fail with reason: "+(e?JSON.stringify(e):"N/A"))}}))};function tt(e){e&&(e.path&&history.replaceState({},"",e.path),e.title&&(document.title=e.title))}var it=function(){function e(e){var t=this;this.xs=!1,this.Ds="",this.Bs=[],this.Hs=function(e){t.xs||(t.xs=!0,t.Ds=e?"timeout":"cancelled",t.Bs.map((function(e){return e()})),t.Bs=[])},this.Vs=e,window.setTimeout((function(){return t.Hs(!0)}),e)}return Object.defineProperty(e.prototype,"isCancelled",{get:function(){return this.xs},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeoutInMs",{get:function(){return this.Vs},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.Ds},enumerable:!1,configurable:!0}),e.prototype.cancel=function(){this.Hs(!1)},e.prototype.subscribe=function(e){this.xs?e():this.Bs.push(e)},e}();function nt(e){return new it(e)}var ot,rt=function(e,t,i,n,o){return e!==te.dispose?Promise.reject("Wrong flow"):new Promise((function(e){i.logger.ULS.Qe(595714433,P.H,A.Info,"start disposing the application");var r=i.host.requireExplicitUnload,s={disposeStartTime:x(),forceAppUnload:r};i.state=y.Disposing;var a=function(){i.state=y.Disposed,e({completion:"success"})},c=function(e){n&&n.disposeAppSpecificResources&&n.disposeAppSpecificResources(i,t),i.dispose(),s.disposeEndTime=x(),function(e,t,i){if(i){var n=Number(i.hostMessageReceived);t.appUnloadStartTime&&!isNaN(n)&&(t.hostToAppPostMessageLatency=n-t.appUnloadStartTime);var o=Number(i.appMessageSent);!isNaN(o)&&t.appUnloadEndTime&&(t.appToHostPostMessageLatency=t.appUnloadEndTime-o);var r=Number(i.appUnloadStart),s=Number(i.appUnloadEnd);if(isNaN(r)||isNaN(s)||(t.appUnloadLatency=s-r),i.serverTimings){var a=i.serverTimings;for(var c in a)t["st-"+c.toString()]=a[c]}}e.logger.ULS.Qe(592524822,P.H,A.Info,"App disposed: "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(i,s,e),i.container?i.container.dispose(i.pendingReboot,r).then(a):a()};r?(s.appUnloadStartTime=x(),i.addActionHandler(ie.an,(function(e,t){s.appUnloadEndTime=x(),c(t)})),(o||new it(5e3)).subscribe((function(){i.state===y.Disposing&&(s.appUnloadTimedOut=!0,c())})),i.container&&i.container.postMessage(ne.Vo,void 0)):c()}))},st=function(e,t,i,n,o){return e!==ie.ki?Promise.reject("Wrong flow"):new Promise((function(e){if(i.host.capabilities&&i.host.capabilities.frameTrustCheck)i.raiseEvent(oe.FrameTrust,t);else{var n=!!i.container&&i.container.isTopFrameTrusted;i.logger.ULS.Qe(592445957,P.H,A.Info,"Top frame is trusted: ".concat(n)),i.container&&i.container.postMessage(ne.ki,{isTopFrameTrusted:n})}e({completion:"success"})}))},at=function(e,t,i,n,o){return e!==ie.Ni?Promise.reject("Wrong flow"):new Promise((function(e){i.authTokenTrustValidator.isResourceTrustedForMessage(t).then((function(n){n?i.raiseEvent(oe.GetAuthToken,t):(i.container.postMessage(ne.Ao,{AuthToken:"",Error:"accessDenied",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"success"}))}),(function(n){i.container.postMessage(ne.Ao,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"failure",error:n})}))}))},ct=function(e,t,i,n,o){return e!==ie.hi?Promise.reject("Wrong flow"):new Promise((function(e){var o=t&&t.state?t.state:"Unknown";i.logger.ULS.Qe(592839750,P.H,A.Info,"Boot state: [".concat(o,"]")),n&&n.beforeComplete&&n.beforeComplete(o),e({completion:"success"})}))},dt=function(e,t,i,n,o){if(e!==te.postWacToken)return Promise.reject("Wrong flow");var r=M();return i.logger.ULS.Qe(507774685,P.H,A.Important,"postWacToken flow initiated"),new Promise((function(e){var n=function(e,t){i.logger.ULS.Qe(507597017,P.H,A.Info,"postWacToken flow completed in ".concat(M()-r," ms")),window.clearInterval(a),window.clearTimeout(c);var n={completion:"success"};t&&void 0!==t.TokenAlreadySet&&(n.data={TokenAlreadySet:t.TokenAlreadySet}),o(n)},o=function(t){i.removeActionHandler(ie.Qn,n),e(t)},s=function(){var e;return null===(e=i.container)||void 0===e?void 0:e.postMessage(ne.Xo,t)};i.addActionHandler(ie.Qn,n),s();var a=window.setInterval(s,100),c=window.setTimeout((function(){window.clearInterval(a),i.logger.ULS.Qe(507844190,P.H,A.Warning,"postWacToken flow timed out after ".concat(6e4," milliseconds")),o({completion:"timeout"})}),6e4)}))},ut=function(e,t,i,n,o){return e!==te.rename?Promise.reject("Wrong flow"):new Promise((function(e){var n=function(e,i){var n={completion:i.NewName===t.NewName?"success":"failure"};s(n)},r=function(e,t){s({completion:"failure"})},s=function(t){i.removeActionHandler(ie.Ui,n),i.removeActionHandler(ie.Ei,r),e(t)};i.addActionHandler(ie.Ui,n),i.addActionHandler(ie.Ei,r),(o||new it(5e3)).subscribe((function(){s({completion:"cancelled"})})),i.container&&i.container.postMessage(ne.yo,t)}))},lt=function(e,t,i,n,o){return e!==ie.in?Promise.reject("Wrong flow"):new Promise((function(e){var n,o;n=t.overlayContent,(o=window.navigator)&&o.virtualKeyboard&&void 0!==o.virtualKeyboard.overlaysContent&&window===top&&(o.virtualKeyboard.overlaysContent=n),i.container&&i.container.postMessage(ne.Do,void 0),e({completion:"success"})}))},ft=function(e,t,i,n,o){return e!==ie.to?Promise.reject("Wrong flow"):new Promise((function(e){var n,o=t.flightKey,r=t.flightValue;i.logger.ULS.Qe(507343134,P.Ie,A.Info,"setWacFlightValue ".concat(o,": ").concat(r)),n=t,localStorage.setItem(n.flightKey,n.flightValue.toString()),e({completion:"success"})}))};!function(e){e[e.NotCreateNew=0]="NotCreateNew",e[e.UnifiedCreateNew=1]="UnifiedCreateNew",e[e.LegacyCreateNew=2]="LegacyCreateNew"}(ot||(ot={}));var pt,ht="powerpoint.officeapps.live.com",vt="https://ffc-"+ht,wt="https://ppc-"+ht,mt="https://eurppc-"+ht,gt="https://usc-"+ht,St="https://euc-"+ht,It="https://cac-"+ht,bt="https://ukc-"+ht,_t="https://auc-"+ht,Tt="https://jpc-"+ht,Ct="https://inc-"+ht,yt="https://krc-"+ht,Pt="https://frc-"+ht,At="https://sgc-"+ht,Ut="https://zac-"+ht,Et="https://aec-"+ht,Ot="https://gbc-"+ht,Ft="https://dec-"+ht,kt="https://chc-"+ht,Wt="https://noc-"+ht,Nt="https://brc-"+ht,Rt="https://sec-"+ht,Mt="https://qtc-"+ht,xt="https://plc-"+ht,Dt="https://"+ht,Bt="https://cnc-powerpoint.partner.officewebapps.cn",Ht="https://powerpoint.gov.online.office365.us",Vt="https://powerpoint.dod.online.office365.us",Lt="https://powerpoint.wac.online.office.eaglex.ic.gov",Jt="https://powerpoint.wac.online.office.microsoft.scloud",Gt="https://devpr.officeapps.live-int.com",jt="https://c4-powerpoint-15.cdn.office.net/pods/s/",zt="https://c1-powerpoint-15.cdn.office.net/pods/s/",qt=((pt={})[vt]=Zt(vt,"https://c5-powerpoint-15.cdn.office.net/pods/s/"),pt[wt]=Zt(wt,jt),pt[mt]=Zt(mt,jt),pt[Dt]=Zt(Dt),pt[gt]=Zt(gt),pt[St]=Zt(St),pt[It]=Zt(It),pt[bt]=Zt(bt),pt[_t]=Zt(_t),pt[Tt]=Zt(Tt),pt[Ct]=Zt(Ct),pt[yt]=Zt(yt),pt[Pt]=Zt(Pt),pt[At]=Zt(At),pt[Ut]=Zt(Ut),pt[Et]=Zt(Et),pt[Ft]=Zt(Ft),pt[kt]=Zt(kt),pt[Wt]=Zt(Wt),pt[Nt]=Zt(Nt),pt[Rt]=Zt(Rt),pt[Mt]=Zt(Mt),pt[xt]=Zt(xt),pt["https://powerpoint.online.office.de"]=Zt("https://powerpoint.online.office.de","https://powerpoint.cdn.office.de/pods/s/"),pt[Bt]=Zt(Bt,"https://cdn.partner.officewebapps.cn/pods/s/"),pt[Ht]=Zt(Ht,"https://powerpoint.cdn.office365.us/pods/s/"),pt[Ot]=Zt(Ot,"https://powerpoint.cdn.office365.us/pods/s/"),pt[Vt]=Zt(Vt,"https://powerpoint.dod.cdn.office365.us/pods/s/"),pt[Lt]=Zt(Lt,"https://powerpoint.cdn.wac.online.office.eaglex.ic.gov/pods/s/"),pt[Jt]=Zt(Jt,"https://powerpoint.cdn.wac.online.office.microsoft.scloud/pods/s/"),pt[Gt]=Zt(Gt,Gt+"/pods/s/"),pt),Kt={"https://ffc-powerpoint.officeapps.live.com":"ring1","https://ppc-powerpoint.officeapps.live.com":"ring2_2","https://eurppc-powerpoint.officeapps.live.com":"ring2_1","https://powerpoint.officeapps.live.com":"ring5_3","https://usc-powerpoint.officeapps.live.com":"ring5_3","https://euc-powerpoint.officeapps.live.com":"ring5_3","https://cac-powerpoint.officeapps.live.com":"ring5_2","https://ukc-powerpoint.officeapps.live.com":"ring5_2","https://auc-powerpoint.officeapps.live.com":"ring5_2","https://jpc-powerpoint.officeapps.live.com":"ring5_2","https://inc-powerpoint.officeapps.live.com":"ring5_2","https://krc-powerpoint.officeapps.live.com":"ring5_2","https://frc-powerpoint.officeapps.live.com":"ring5_2","https://sgc-powerpoint.officeapps.live.com":"ring5_2","https://zac-powerpoint.officeapps.live.com":"ring5_2","https://aec-powerpoint.officeapps.live.com":"ring5_2","https://dec-powerpoint.officeapps.live.com":"ring5_1","https://chc-powerpoint.officeapps.live.com":"ring5_1","https://noc-powerpoint.officeapps.live.com":"ring5_1","https://brc-powerpoint.officeapps.live.com":"ring5_1","https://sec-powerpoint.officeapps.live.com":"ring5_1","https://qtc-powerpoint.officeapps.live.com":"ring5_1","https://plc-powerpoint.officeapps.live.com":"ring5_0"};function Zt(e,t){return void 0===t&&(t=zt),{PodsUrl:e+"/pods/",WacCdnStaticServer:t}}function $t(e){var t=e.substring(0,e.indexOf("/p/"));return qt[t.toLowerCase()]}var Xt=["wdPodsUrl","wdPopsUrl","wdNewPodsFrame","wdNewEnabled","wdfs","wdfsection","wdIncludeHostUrl","wdoverrides"];function Qt(e,t,i){if(!t)return e;var n=e,o=null==i,r=n.indexOf("?");if(-1===r)return o?e:n+"?"+t+"="+i;for(var s=n.substr(r+1),a=s.split("&"),c=t+"=",d=!1,u=0;u<a.length;u+=1)if(0===a[u].indexOf(c)){n=n.replace(a[u],o?"":c+i),d=!0;break}return d||o||(s.length>0&&(n+="&"),n+=c+i),n}function Yt(e,t){return!e||"wd"!==e.substring(0,2)||Xt.indexOf(e)>=0?"":e+"="+t}function ei(e){for(var t=e,i="",n=0,o=window.location.search.substring(1).split("&");n<o.length;n++){"wdoverrides"===(d=o[n].split("="))[0]&&(i=d[1]);var r=Yt(d[0],d[1]);r&&(t+="&"+r)}for(var s=[],a=0,c=(i=i||"").split(/,|%2C/);a<c.length;a++){var d;2===(d=c[a].split(/:|%3A/)).length&&"devicepixelratio"!==d[0].toLowerCase()&&s.push(d[0]+":"+d[1])}return s.push("devicepixelratio:"+_e()),s.push("RenderGifSlideShow:true"),Qt(t,"wdoverrides",s.join(","))}function ti(e){var t=S("wdPodsUrl");return t&&!_(t)&&(t=""),t||(t=e),"/"!==t.substr(t.length-1)&&(t+="/"),t}function ii(e,t){var i=e.bootParams,n=e.file;if(!i.isNewFile){if(!n.getUrl)throw Error("Missing FileGetUrl");if(!n.name)throw Error("Missing FileName")}var o=e.preseededSession;o&&o.key&&("_._._."===o.key.slice(0,6)&&"-.-.-."===o.key.slice(-6)||(o.key="_._._."+o.key+"-.-.-."));var r=e.appContext;r.wopiInfoSent=!1,r.bootComplete=!1,r.bootFlowResolve=t,r.bootRecorded=!1;var s=qt[e.appBaseUrl];e.appBasePath=s?s.PodsUrl:e.appBaseUrl+"/pods/";var a=e.wdParams,c=a.wdpodsurl;c&&!_(c)&&(c=""),c||(c=e.appBasePath);var d=/\/$/;if(d.test(c)||(c+="/"),!c)throw Error("Invalid PODS URL");r.podsUrl=c;var u=a.wdpopsurl;if(u&&!_(u)&&(u=""),u||(u=(u=c).substring(0,u.indexOf("/pods/"))),d.test(u)||(u+="/"),!u)throw Error("Invalid POPS URL");r.popsUrl=u,e.bootstrapperUrl?r.cdnBasePath=e.bootstrapperUrl.split("/pods/s/")[0]+"/pods/s/":r.cdnBasePath=s?s.WacCdnStaticServer:zt,r.createNewScenario=function(e,t,i,n){var o=ot.NotCreateNew,r="NotCreateNew";t.isNewFile?i.size?(o=ot.LegacyCreateNew,r="CreateNewWithNonZeroByteFile"):(o=ot.UnifiedCreateNew,r="IsNewFile"):t.isFromHostTemplate?(o=ot.UnifiedCreateNew,r="CreateNewFromHostTemplate"):n&&n.getUrl&&(o=ot.UnifiedCreateNew,r="CreateNewFromTemplateSourceUrl");var s={CreateNewScenario:ot[o],reason:r};return e.ULS.Qe(34932951,P.H,A.Info,JSON.stringify(s)),o}(e.logger,i,n,e.newFileTemplate),r.shouldUsePods=function(e,t,i,n,o,r,s){var a=!1,c=!1,d="";t?(a="false"!==t,c=!0,d="wdPodsEnabled is available"):i?e===ot.LegacyCreateNew?(a=!1,c=!1,d="Legacy Create New Scenario because non-zero file size"):n?(a=!1,c=!1,d="Embed View fallback to WAC"):(a=!0,c=!0,d="Supported Region"):(a=!1,c=!1,d="Wac region not currently supported by PODS",s.ULS.Qe(589168768,P.H,A.Warning,d+": "+r)),o||e!==ot.NotCreateNew||(a=!1,c=!1,d+=" | FileGetUrl is empty");var u={ShouldUsePodsOrCached:a,ShouldUsePods:a,CanUsePods:c,ApplicationUrl:r,Reason:d,CreateNewScenario:ot[e]};return s.ULS.Qe(561640788,P.H,A.Info,JSON.stringify(u)),a}(r.createNewScenario,a.wdpodsenabled,!!s,m(e.appUrl,"embed"),!!n.getUrl,T(e.appBaseUrl),e.logger);var l=e.hostInitDiagnostics;l&&l.userClickTime&&Oe(l.userClickTime,e.logger),function(e){var t=e.hostInitDiagnostics,i=e.bootParams,n=e.file,o=!!n.getUrl,r=!!e.customFontCatalogUrl,s=e.contentBundle,a={BootstrapperType:"TypeScript",JsApiVersion:"v2",Preview:!1,Scenario:"Unified App",ApplicationUrl:T(e.appBaseUrl),IsDeepLink:!!S("nav"),BootstrapperInstanceId:le(),IsMobileView:be(),ApplicationCustomSettings:{OnDemandServer:T(e.appBasePath),EnableWacFallback:!0},SessionInformation:{HostName:e.hostName,HostSessionId:e.hostSessionId,UiLocale:e.ui.language,DataLocale:i.dataLanguage,DocumentClickTime:t.userClickTime,CurrentTime:x(),UiHost:e.host.uiHostName,WdParams:e.wdParams},Diagnostics:{EntryPoint:t.entryPoint,FileHost:e.host.storageHostName,PodsRing:"",UnifiedUiHostDiagnostics:t.unifiedUiHostDiagnostics},WopiPrecheckInfo:{FileSize:n.size,FileGetUrlBool:o,CustomFontCatalogBool:r,FileGetUrlLength:o?n.getUrl.length:null,FileNameBool:!!n.name,ReadOnly:i.readOnly,IrmEnabled:i.irmEnabled,SupportsDecryptedContentDownload:i.supportsDecryptedContentDownload,ViewOnly:i.viewOnly,PreseededSessionKey:!!e.preseededSession&&!!e.preseededSession.key,FileExtension:Z(n.name)||null,BundleInfo:s?{MajorVersion:s.majorVersion,URLBool:!!s.url}:{}},AppInfo:{AppVersionMajor:1,AppVersionMinor:N(),Environment:"wac",UserAgent:window.navigator.userAgent},AdditionalTelemetry:{PostMessageToken:e.sessionId}};e.logger.ULS.Qe(22357763,P.H,A.Info,JSON.stringify(a,$))}(e)}function ni(e){return e.appBasePath}function oi(e){return e.appBasePath+"RemoteTelemetry.ashx"+((t=e.sessionId)?"?usid="+t:"");var t}function ri(e){return!e.appContext.shouldUsePods}var si,ai="\n  @media screen and (-ms-high-contrast:active)\n  {\n   div#".concat("highContrastDetectionDiv"," a#").concat("highContrastDetectionAnchor","\n   {\n  \tbackground-image: none !important;\n   }\n  }\n\n  div#").concat("highContrastDetectionDiv","\n  {\n   background-color: Window;\n   position: absolute;\n   top: 0px;\n   left: -99999px;\n   width: 1px;\n   height: 1px;\n   opacity: 0;\n   overflow: hidden;\n  }\n\n  div#").concat("highContrastDetectionDiv"," a#").concat("highContrastDetectionAnchor","\n  {\n   background-image: url('data:image/png;base64,").concat("highcontrastdetectordefault","');\n  }\n");function ci(e){var t=e.ownerDocument.createElement("div");t.id="highContrastDetectionDiv",t.ariaHidden="true";var i=e.ownerDocument.createElement("a");i.id="highContrastDetectionAnchor",i.setAttribute("href","#"),i.ariaHidden="true",t.appendChild(i),e.appendChild(t);var n=e.ownerDocument.createElement("style");n.innerHTML=ai,e.ownerDocument.head.appendChild(n);var o=function(){e.ownerDocument.head.removeChild(n),e.removeChild(t)},r=li(t),s=li(i);if(r&&s){if(-1===s.backgroundImage.toLowerCase().indexOf("highcontrastdetectordefault")){var a=function(e,t,i){var n=di(e),o=di(t),r=di(i);if(n&&o&&r)return{foregroundTextColor:n,backgroundColor:o,linkColor:r}}(r.color.toLowerCase(),r.backgroundColor.toLowerCase(),s.color.toLowerCase());return o(),{isInHighContrastMode:!0,highContrastColors:a}}return o(),{isInHighContrastMode:!1}}o()}function di(e){return new RegExp("#[0-9A-Fa-f]{6}").test(e)?e:"transparent"===e||"window"===e?"transparent":function(e){var t=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);if(t&&4===t.length)return function(e,t,i){return"#"+ui(Number(e),2)+ui(Number(t),2)+ui(Number(i),2)}(t[1],t[2],t[3])}(e)}function ui(e,t){for(var i=e.toString(16);i.length<t;)i="0"+i;return i.toLowerCase()}function li(e){if(e.ownerDocument&&e.ownerDocument.defaultView&&e.ownerDocument.defaultView.getComputedStyle)return e.ownerDocument.defaultView.getComputedStyle(e)}function fi(){var e,t,i,n=((i=(t={width:(e={width:window.document.documentElement.clientWidth,height:window.document.documentElement.clientHeight-50}).width,height:e.height}).width<320)&&(t.height-=17),t.height<256&&(t.width-=17),!i&&t.width<320&&(i=!0,t.height-=17),t.width=Math.max(t.width,320),t.height=Math.max(t.height,256),t);return(""+document.cookie).indexOf("WACRibbonMinimizedPPT=true")>=0&&(n.height-=me()?108:94),n.height-=30,n.height-=23,n}function pi(e){var t,i;return(i={width:(t={height:e.height-32-1,width:e.width-238-1-17}).width-20,height:t.height-20}).width<424?i.width=424:i.width>1696&&(i.width=1696),i.height<238.5?i.height=238.5:i.height>954&&(i.height=954),i}function hi(e){return e.Diagnostics&&e.Diagnostics.entryPoint?e.Diagnostics.entryPoint:e.ApplicationUrl&&g(e.ApplicationUrl,"wdOrigin")||null}function vi(e,t,i){if(e)for(var n=0;n<e.length;n+=1){var o=e[n];if(o.name.indexOf(t)>=0)return o.name.toLowerCase()!==t.toLowerCase()&&i.ULS.Qe(38147726,P.H,A.Info,"Found partial match for bootstrapper URL perf entry"),o}}function wi(e,t){if(t)try{if(!e)return void t.ULS.Qe(557454687,P.H,A.Info,"Missing BootstrapperUrl");if(!window.performance)return void t.ULS.Qe(557454688,P.H,A.Info,"Performance API not found on browser");var i=void 0;if(window.performance.getEntriesByName&&(i=vi(window.performance.getEntriesByName(e),e,t)),!i&&window.performance.getEntries&&(t.ULS.Qe(557454689,P.H,A.Info,"Searching all entries for bootstrapper timing entry"),i=vi(window.performance.getEntries(),e,t)),!i)return void t.ULS.Qe(557454690,P.H,A.Info,"Unable to extract Bootstrapper perf info");var n={name:e,logReason:"UnifiedTSBoot",nameMatchesExpected:i.name===e,connectEnd:i.connectEnd,connectStart:i.connectStart,domainLookupEnd:i.domainLookupEnd,domainLookupStart:i.domainLookupStart,fetchStart:i.fetchStart,initiatorType:i.initiatorType,redirectEnd:i.redirectEnd,redirectStart:i.redirectStart,requestStart:i.requestStart,responseEnd:i.responseEnd,responseStart:i.responseStart,duration:i.duration,entryType:i.entryType,startTime:i.startTime,nextHopProtocol:i.nextHopProtocol,workerStart:i.workerStart,secureConnectionStart:i.secureConnectionStart,transferSize:i.transferSize,encodedBodySize:i.encodedBodySize,decodedBodySize:i.decodedBodySize};t.ULS.Qe(34928845,P.H,A.Info,JSON.stringify(n))}catch(e){t.ULS.Qe(557454691,P.ae,A.Warning,"Exception extracting Bootstrapper perf info: ".concat(X(e)))}}function mi(e){return!e||e.toLowerCase().indexOf("#")>-1?Math.random().toString(36).substring(2,25):e}function gi(e){if(!e)return"";switch(e){case"MSTeams":case"TeamsAndroid":case"TeamsiOS":return"teams";case"ParticipantApp":case"DragonGate":return e;default:return""}}function Si(e){if(!e)return"";switch(e){case"MSTeams":case"TeamsAndroid":case"TeamsiOS":case"OneDrive":case"ParticipantApp":case"DragonGate":return"SharePoint Online";default:return e}}function Ii(e,t,i){if(e){var n="Page lifecycle: "+t+" fired.";i&&(n+="Flushing ULS logger",e.ULS.flushOnClose()),e.ULS.Qe(579384268,P.H,A.Warning,n)}}function bi(e){return e.toLocaleLowerCase().indexOf("pod")>=0||e.toLocaleLowerCase().indexOf("pop")>=0}function _i(e){var t="";for(var i in e)bi(i)||(t+="&"+i+"="+e[i]);return t}function Ti(e){var t,i=e.wdParams,n=be(),o="true"===i.wdembedview||m(e.appUrl,"embed"),r=e.appContext,s=n?"pptmobileapp.aspx":o?"pptembed.aspx":"ppt.aspx",a={},c={};Xt.forEach((function(e){f(a,e)}));var d=["devicepixelratio:"+_e(),"RenderGifSlideShow:true"],u=i.wdoverrides;u&&u.split(/,|%2C/).forEach((function(e){var t=e.split(/:|%3A/);2===t.length&&"devicepixelratio"!==t[0].toLowerCase()&&d.push(t[0]+":"+t[1])})),l(a,"wdoverrides",d.join(",")),o&&(f(a,"corrid"),f(a,"usid")),me()&&l(c,"touchdevice","1");var h=window.document.documentElement;h&&(void 0!==h.clientWidth&&l(c,"windowwidth",h.clientWidth.toString()),void 0!==h.clientHeight&&l(c,"windowheight",h.clientHeight.toString()));var v=S("previoussessionid");if(v&&l(c,"previoussessionid",v),e.featureManager.isFeatureEnabled(J.zt)||(null===(t=e.Ye)||void 0===t?void 0:t.getValue(B.yt,!1))){var w=null===window||void 0===window?void 0:window._wopiContextJson;if(null==w?void 0:w.PredictedOfficeAppEndPointHintForRealSession){var g=null==w?void 0:w.PredictedOfficeAppEndPoint;if(g)if(e.Ye.getValue(B.Ot,!1)){var _=null==w?void 0:w.PredictedOfficeAppEndPointAccessTime;if(_){var T=new Date(_);((new Date).getTime()-T.getTime()+3e5)/36e5<=e.Ye.getValue(B.Et,48)&&l(a,"wdwaccluster",g)}else e.logger.ULS.Qe(507299216,P.H,A.Important,"PredictedOfficeAppEndPointAccessTime is null")}else l(a,"wdwaccluster",g)}}Ee()&&l(c,"lssupported","1");var C=e.host.capabilities;C&&(C.rebootDoc&&(l(c,"sdr",C.rebootDoc.toString()),f(a,"sdr")),C.createNewDoc&&(l(c,"scnd","1"),f(a,"scnd")),C.authToken&&(l(c,"sat","1"),f(a,"sat")),C.customAuthConfig&&(l(c,"cac","1"),f(a,"cac")),C.refreshAccessToken&&(l(c,"rat","1"),f(a,"rat")),C.atMentions&&(l(c,"sams","1"),f(a,"sams")),C.moveToFolder&&(l(c,"mtf","1"),f(a,"mtf")),C.noBrowserModalDialogs&&(l(c,"nbmd","1"),f(a,"nbmd")),C.commonFilePicker&&(l(c,"sfp","1"),f(a,"sfp")),C.directDownload&&(l(c,"sdd","1"),f(a,"sdd")),C.directPrint&&(l(c,"sdp","1"),f(a,"sdp")));var y=e.ui;(y.hideHeader||"DocGen"===y.contentAssemblyMode||"Templatization"===y.contentAssemblyMode||"ContentAssemblyEdit"===y.contentAssemblyMode||"ContentAssemblyView"===y.contentAssemblyMode)&&(l(c,"hhdr","1"),f(a,"hhdr")),y.hideFileLocationPicker&&(l(c,"hodflp","1"),f(a,"hodflp")),y.hideAppLauncherInHeader&&(l(c,"halh","1"),f(a,"halh")),y.hideChatInHeader&&(l(c,"hch","1"),f(a,"hch")),y.hideMeInHeader&&(l(c,"hmh","1"),f(a,"hmh")),y.hideSearchInHeader&&(l(c,"hsh","1"),f(a,"hsh")),y.hideWorkflowInHeader&&(l(c,"hwfh","1"),f(a,"hwfh")),y.hideSettingsInHeader&&(l(c,"hsth","1"),f(a,"hsth")),y.showAppIconInHeader&&(l(c,"sih","1"),f(a,"sih")),y.useNeutralColorInHeader&&(l(c,"unh","1"),f(a,"unh")),e.hostName&&l(c,"filesrc",e.hostName),e.user.id&&l(c,"userid",e.user.id),y.openLinksInNewWindow&&(l(c,"onw","1"),f(a,"onw")),y.useDarkTheme&&(l(c,"udt","1"),f(a,"udt"));var U=e.viewMode;U&&U.hideToolbar&&l(c,"hvt","1");var E=e.file;E.name&&(l(a,"filename",I(E.name)),f(c,"filename")),E.getUrl&&(l(c,"fileurl",E.getUrl),f(c,"filegeturl")),l(a,"filegeturlbool",E.getUrl?"true":"false"),E.size&&(l(a,"fs",E.size.toString()),f(c,"filesize"));var O=e.newFileTemplate;O&&O.size&&(l(a,"fs",O.size.toString()),f(c,"filesize"));var F=e.contentBundle;F&&F.url&&(l(c,"bundleurl",F.url),f(c,"bundlesrc"));var k=e.bootParams;k.irmEnabled&&l(c,"irmenabled",k.irmEnabled.toString()),k.supportsDecryptedContentDownload&&l(c,"supportsdecryptedcontentdownload",k.supportsDecryptedContentDownload.toString()),k.readOnly&&f(a,"readonly"),l(a,"ro",k.readOnly?k.readOnly.toString():"false"),k.viewOnly&&l(c,"viewonly",k.viewOnly.toString()),k.openViewByDefault&&l(c,"ovbd",k.openViewByDefault.toString());var W=e.preseededSession;W&&(W.key&&(o||l(c,"preseededsessionkey",W.key),f(a,"preseededsessionkey")),W.id&&f(a,"preseededwacsessionid"));var R=e.throttling;R&&(R.protection&&(l(c,"ctp",R.protection),f(a,"ctp")),R.request&&(l(c,"rct",R.request),f(a,"rct")));var M=S("nav");if(M||(M=e.actNavId?e.actNavId:p(e.appUrl,"actnavid")),M){try{var x=b(M),D=JSON.parse(x),H=D.sId;H&&(l(a,"wdslideid",H),l(a,"dc","1"));var V=D.commentId;V&&"null"!==V&&l(a,"wdcommentid",V);var L=D.openMode;L&&"null"!==L&&l(a,"wdopenmode",L)}catch(t){e.logger.ULS.Qe(560329684,P.H,A.Error,"Failed to parse navigation id: ".concat(M))}f(a,"actnavid")}if(r.shouldUsePods){e.appBasePath=r.podsUrl,f(a,"powerpointview"),l(a,"wdpodsurl",I(r.podsUrl)),l(a,"wdpopsurl",I(r.popsUrl)),l(a,"fastboot","true"),l(a,"noauth","1");var G=fi(),j=pi(G);l(a,"thpanel",G.height.toString()),l(a,"sw",j.width.toString()),l(a,"sh",j.height.toString());var z=i.wdfs;z&&l(a,"fslide",z);var q=i.wdfsection;q&&l(a,"fsection",q),(z||q||i.wdincludehosturl&&"false"!==i.wdincludehosturl)&&l(a,"frameurl",I(window.location.href));var K=S("automation");K&&l(a,"automation",K);var Z=S("startrehearsal");if(Z&&l(a,"startrehearsal",Z),l(a,"postmessagetoken",e.sessionId),l(c,"postmessagetoken",e.sessionId),e.wdParams){var $=_i(e.wdParams);$&&l(c,"wdparams",$)}if(l(c,"jsapiversionminor",N().toString()),(Q=e.wopi)&&Q.source&&(l(c,"wopisrc",Q.source),f(a,"wopisrc")),e.container){var X=ci(e.container.element);X&&X.isInHighContrastMode&&(l(c,"isinhighcontrastmode","true"),X.highContrastColors&&l(c,"clientcolorsettings",X.highContrastColors.foregroundTextColor+"_"+X.highContrastColors.backgroundColor+"_"+X.highContrastColors.linkColor))}}else{e.appBasePath||l(a,"nolog","True");var Q,Y=e.appUrl.substring(0,e.appUrl.indexOf("?")),ee=Y.lastIndexOf("/")+1;if(e.appBasePath=Y.substring(0,ee),s=Y.substring(ee),(Q=e.wopi)&&Q.source){var te=Q.source;te.toLowerCase().indexOf("powerpointframe.aspx")>=0&&(te=decodeURIComponent(p(te,"wopisrc"))),l(a,"wopisrc",I(te))}l(a,"wdenableroaming","1"),l(a,"wdo","1")}return{appPageName:s,queryParamsOverrides:a,postDataOverrides:c}}function Ci(e){if(e.appContext.shouldUsePods){var t=function(i,n){yi(e),e.removeActionHandler(ie.fi,t)};e.addActionHandler(ie.fi,t),e.addActionHandler(ie.cn,(function(t,i){t===ie.cn&&function(e,t){var i=t;if(i&&"number"==typeof i.Tag&&"number"==typeof i.Category&&"number"==typeof i.Level&&"string"==typeof i.Message)try{e.logger.ULS.Qe(i.Tag,i.Category,i.Level,i.Message)}catch(t){e.logger.ULS.Qe(512235072,P.H,A.Error,"ulsLog exception: "+t)}}(e,i)}))}wi(e.bootstrapperUrl,e.logger),window.setTimeout((function(){e.logger.ULS.flush()}),1e4)}function yi(e){var t,i,n=e.appContext;if(!n.wopiInfoSent&&e.wopi){n.wopiInfoSent=!0;var o="";e.wdParams&&(o=Object.keys(e.wdParams).filter((function(e){return!/po[d/p]/i.test(e)})).reduce((function(t,i){return"".concat(t,"&").concat(i,"=").concat(e.wdParams[i])}),""));var r=e.bootParams,s=e.wopi,a=e.hostInitDiagnostics,c={WopiSrc:s.source,AccessToken:s.accessToken,AccessTokenTTL:s.expiry,ReadOnly:r.readOnly,IrmEnabled:r.irmEnabled,SupportsDecryptedContentDownload:r.supportsDecryptedContentDownload,FileName:e.file.name,SessionContext:e.sessionContext,WdParams:o,DocumentURL:window.location.href,PreviousSessionID:S("PreviousSessionID"),FirstPageFlushTime:null!==(t=window.WOPIPerf_FirstPageFlush)&&void 0!==t?t:a.hostPageFirstFlushTime,BootJsStartTime:window.WOPIPerf_BootJsStartTime,BootJsEndTime:window.WOPIPerf_BootJsEndTime,InitializeWacTime:window.WOPIPerf_InitializeWac,UserClickTime:null!==(i=window.WOPIPerf_UserClick)&&void 0!==i?i:a.userClickTime,UnifiedUiHostDiagnostics:a.unifiedUiHostDiagnostics,ClientDiagnostics:e.clientDiagnostics};if(s.wacToken&&(c.WacToken=s.wacToken),e.hostSessionId){var d=e.hostSessionId.indexOf(".");c.HostSessionId=d>0?e.hostSessionId.substring(0,d):e.hostSessionId}if(a.legacyPerformanceData){var u=a.legacyPerformanceData.host;u&&(void 0!==u.timing.navigationStart&&(c.NavigationStart=u.timing.navigationStart),void 0!==u.timing.fetchStart&&(c.FetchStart=u.timing.fetchStart),void 0!==u.timing.requestStart&&(c.RequestStart=u.timing.requestStart),void 0!==u.timing.responseStart&&(c.ResponseStart=u.timing.responseStart),void 0!==u.timing.responseEnd&&(c.ResponseEnd=u.timing.responseEnd),void 0!==u.navigation.type&&(c.NavigationType=u.navigation.type),void 0!==u.navigation.redirectCount&&(c.NavigationRedirects=u.navigation.redirectCount))}else if(window.performance){var l=window.performance.timing;l&&(c.NavigationStart=l.navigationStart,c.FetchStart=l.fetchStart,c.RequestStart=l.requestStart,c.ResponseStart=l.responseStart,c.ResponseEnd=l.responseEnd);var f=window.performance.navigation;f&&(c.NavigationType=f.type,c.NavigationRedirects=f.redirectCount)}e.container.postMessage(ne.do,c)}}!function(e){e.bootWithoutWopiInfo="",e.unifiedSingleFlush="Unified_SingleFlush",e.unifiedIrmEnabled="Unified_IrmEnabled",e.unifiedViewActionUrl="Unified_ViewActionUrl",e.unifiedNotEditOrViewActionUrl="Unified_NotEditOrViewActionUrl",e.forceSingleStepBoot="Force_SingleStepBoot",e.wordUiEmbedReadOnlyEarlyRedirect="WordUiEmbed_ReadOnlyEarlyRedirect",e.wordUiEmbedIrmEnabledEarlyRedirect="WordUiEmbed_IrmEnabledEarlyRedirect",e.wordViewToUnifiedReadRedirect="WordView_UnifiedReadRedirect"}(si||(si={}));function Pi(e,t){var i=document.createElement("input");return i.type="hidden",i.name=e,i.value=t,i}var Ai,Ui=function(){function e(e){this.Ls=e}return e.prototype.GetApplicationType=function(){return"PowerPoint"},e.prototype.GetVersion=function(){return W()},e.prototype.GetSessionId=function(){return this.Ls},e.prototype.RegisterEventHandler=function(){},e.prototype.RemoveEventHandler=function(){},e.prototype.RegisterErrorHandler=function(){},e.prototype.RemoveErrorHandler=function(){},e.prototype.PostCommand=function(){},e.prototype.Dispose=function(){},e}();function Ei(e,t){var i;if(!e.IsFileNew){if(!e.WopiPrecheckInfo.FileGetUrl)throw Error("Missing FileGetUrl from contentParams");if(!e.WopiPrecheckInfo.FileName)throw Error("Null or Empty Filename")}var n=ti(e.OnDemandServer);if(!n)throw Error("Invalid Pods URL");var o,r,s=(o=e.OnDemandServer,(r=S("wdPopsUrl"))&&!_(r)&&(r=""),r||(r=(r=ti(o)).substr(0,r.indexOf("/pods/"))),"/"!==r.substr(r.length-1)&&(r+="/"),r);if(!s)throw Error("Invalid Pops URL");var a=fi(),c=pi(a),d="true"===S("wdEmbedView")||m(e.ApplicationUrl,"embed"),u=d?"pptembed.aspx":"ppt.aspx",l=be();t.ULS.Qe(51380293,P.H,A.Info,"IsRequestForMobileView:".concat(l));var f=n+(u=l?"pptmobileapp.aspx":u)+"?wdPodsUrl="+I(n)+"&wdPopsUrl="+I(s)+"&fastBoot=true&sw="+c.width+"&sh="+c.height+"&thPanel="+a.height+"&ro="+e.WopiPrecheckInfo.ReadOnly+"&sftc=1&NoAuth=1&jsApi=1&jsapiver=v1";e.WopiPrecheckInfo.FileName&&(f+="&fileName="+I(e.WopiPrecheckInfo.FileName)),"DocGen"!==e.SessionInformation.ContentAssemblyMode&&"ContentAssemblyView"!==e.SessionInformation.ContentAssemblyMode||(f+="&readonly=1");var h=S("wdfs");h&&(f+="&fslide="+h);var v=S("wdfsection");if(v&&(f+="&fsection="+v),e.FeatureManager.isFeatureEnabled(J.zt)||(null===(i=e.SettingsManager)||void 0===i?void 0:i.getValue(B.yt,!1))){var w=null===window||void 0===window?void 0:window._wopiContextJson;if(null==w?void 0:w.PredictedOfficeAppEndPointHintForRealSession){var T=null==w?void 0:w.PredictedOfficeAppEndPoint;if(T)if(e.SettingsManager.getValue(B.Ot,!1)){var C=null==w?void 0:w.PredictedOfficeAppEndPointAccessTime;if(C){var y=new Date(C);((new Date).getTime()-y.getTime()+3e5)/36e5<=e.SettingsManager.getValue(B.Et,48)&&(f+="&wdwaccluster="+T)}}else f+="&wdwaccluster="+T}}var U=S("wdIncludeHostUrl");(h||v||U&&"false"!==U)&&(f=Qt(f,"frameURL",I(window.location.href))),f=function(e,t){var i=e,n=function(e){return e.SessionInformation.UiLocale?e.SessionInformation.UiLocale:g(e.ApplicationUrl,"ui")}(t);n&&(i=Qt(i,"ui",n));var o=function(e){return e.SessionInformation.DataLocale?e.SessionInformation.DataLocale:g(e.ApplicationUrl,"rs")}(t);o&&(i=Qt(i,"rs",o));var r=p(t.ApplicationUrl,"mscc");r&&(i=Qt(i,"mscc",r));var s=p(t.ApplicationUrl,"wdFR");s&&(i=Qt(i,"wdFR",s));var a=hi(t);a&&(i=Qt(i,"wdOrigin",I(a)));var c=mi(t.PostMessageToken);return t.PostMessageToken&&(i+="&postMessageToken="+c),(t.SessionInformation.DisableChat||t.ApplicationUrl.toLowerCase().indexOf("dchat=1")>-1)&&(i=Qt(i,"dchat","1")),function(e,t){var i=t.indexOf("?");if(-1===i)return e;for(var n=e,o=0,r=t.substring(i+1).split("&");o<r.length;o++){var s=r[o].split("=");if(""===p(e,s[0])){var a=Yt(s[0],s[1]);a&&(n+="&"+a)}}return n}(i,t.ApplicationUrl)}(f=ei(f),e),e.IsFileNew&&(f+="&new=1"),e.NewFileTemplateSource&&e.NewFileTemplateSource.FileSize?f+="&fs="+e.NewFileTemplateSource.FileSize:e.WopiPrecheckInfo.FileSize&&(f+="&fs="+e.WopiPrecheckInfo.FileSize);var E,O=!(E=e.SessionInformation.HostSessionId)||E.toLowerCase().indexOf("#")>-1?Math.random().toString(36).substring(2,25):E;e.SessionInformation.HostSessionId&&(f+="&hid="+O);var F=S("Automation");F&&(f+="&Automation="+F);var k=S("StartRehearsal");k&&(f+="&StartRehearsal="+k),d||(f+="&usid="+e.SessionId),e.ApplicationUrl.toLowerCase().indexOf("uiembed=1")>-1&&(f+="&uiEmbed=1"),e.SessionInformation.SupportsAccessibilityLoop&&(f+="&accloop=1"),e.SessionInformation.IsSynthetic&&(f+="syn=1");var R=g(e.ApplicationUrl,"uih");R&&(f+="&uih="+R),e.SessionInformation.UiHostIntegrationType&&(f+="&uihit="+I(e.SessionInformation.UiHostIntegrationType)),"Microsoft Teams"===e.SessionInformation.HostName&&(t.ULS.Qe(507121920,P.H,A.Important,"PowerPoint setting Force View only for Teams WXP Files session."),f+="&fvo=1"),e.SessionInformation.MetaUiHostVersion&&(f+="&muv="+I(e.SessionInformation.MetaUiHostVersion)),e.SessionInformation.HighContrastMode&&(f+="&hcm="+I(e.SessionInformation.HighContrastMode));var M=S("nav");if(M||(M=p(e.ApplicationUrl,"actNavId")),M)try{var x=b(M),D=JSON.parse(x),H=D.sId;H&&(f=Qt(f,"wdSlideId",H),f=Qt(f,"DC","1"));var V=D.commentId;V&&"null"!==V&&(f=Qt(f,"wdCommentId",V));var L=D.openMode;L&&"null"!==L&&(f=Qt(f,"wdOpenMode",L))}catch(e){t.ULS.Qe(38580688,P.H,A.Error,"Failed to parse navigation ID: ".concat(M))}var G=e.Container;if(G){var j=document.createElement("iframe");j.id="WebApplicationFrame",j.name="wac_frame",j.title="Office Online Frame",j.frameBorder="0",j.style.top="0",j.style.bottom="0",j.style.left="0",j.style.right="0",j.style.height="100%",j.style.width="100%",j.style.minHeight="200px",j.style.minWidth="300px",j.style.position="absolute",j.setAttribute("allowfullscreen","true"),j.setAttribute("allowTransparency","true");var z="";if(we()===ce.Safari)z+="autoplay;",z+="microphone;",z+="camera;",z+="clipboard-read;",z+="clipboard-write;",z+="display-capture;";else{var q=n+" "+function(e,t){if(t)return t.split("/pods/s/")[0]+"/pods/s/";if(e){var i=$t(e);if(i)return i.WacCdnStaticServer;throw Error("Application url provided but region not in region allow list")}return zt}(e.ApplicationUrl,e.BootstrapperUrl)+";";z+="autoplay "+q,z+="microphone "+q,z+="camera "+q,z+="clipboard-read "+q,z+="clipboard-write "+q,z+="display-capture "+q}j.setAttribute("allow",z),G.style.top="0",G.style.bottom="0",G.style.left="0",G.style.right="0",G.style.height="100%",G.style.width="100%",G.style.minHeight="200px",G.style.minWidth="300px",G.appendChild(j);var K=Date.now(),Z=e.WopiPrecheckInfo.FileGetUrl;t.ULS.Qe(38580689,P.H,A.Info,Z?Z.toString().length.toString():"null"),f+="&fileGetUrlBool="+!!Z;var $=document.createElement("form");if($.name="frameForm",$.id="frameForm",$.target="wac_frame",$.action=f,$.method="post",G.appendChild($),e.WopiInfo){var X=e.WopiInfo.WopiSrc;X&&$.appendChild(Pi("WOPISrc",X));var Q=e.WopiInfo.AccessToken;Q&&$.appendChild(Pi("access_token",I(Q)));var ee=e.WopiInfo.AccessTokenExpiry;ee&&$.appendChild(Pi("access_token_ttl",ee.getTime().toString()));var te=e.WopiInfo.WacToken;te&&$.appendChild(Pi("wac_token",I(te)))}var ie=e.SessionInformation.SessionContext;if(ie&&$.appendChild(Pi("sc",ie)),e.SessionInformation.WdParams){var ne=_i(e.SessionInformation.WdParams);ne&&$.appendChild(Pi("wdparams",ne))}$.appendChild(Pi("jsapiversionminor",N().toString())),e.SessionInformation.HideViewerToolbar&&$.appendChild(Pi("hvt","1")),Z&&$.appendChild(Pi("fileUrl",Z));var oe=e.WopiPrecheckInfo.CustomFontCatalogUrl;oe&&$.appendChild(Pi("customFontCatalogUrl",oe)),e.NewFileTemplateSource&&e.NewFileTemplateSource.FileGetUrl&&$.appendChild(Pi("templateUrl",e.NewFileTemplateSource.FileGetUrl)),e.SessionInformation.UserId&&($.appendChild(Pi("UserID",e.SessionInformation.UserId)),$.appendChild(Pi("user_id",e.SessionInformation.UserId))),e.WopiPrecheckInfo.IrmEnabled&&$.appendChild(Pi("irmEnabled",e.WopiPrecheckInfo.IrmEnabled.toString())),e.WopiPrecheckInfo.SupportsDecryptedContentDownload&&$.appendChild(Pi("SupportsDecryptedContentDownload",e.WopiPrecheckInfo.SupportsDecryptedContentDownload.toString())),e.WopiPrecheckInfo.ViewOnly&&$.appendChild(Pi("ViewOnly",e.WopiPrecheckInfo.ViewOnly.toString())),e.NewFileTemplateSource&&e.NewFileTemplateSource.ETag?$.appendChild(Pi("ETag",e.NewFileTemplateSource.ETag)):e.WopiPrecheckInfo.ETag&&$.appendChild(Pi("ETag",e.WopiPrecheckInfo.ETag)),e.WopiPrecheckInfo.CTag&&$.appendChild(Pi("RevID",e.WopiPrecheckInfo.CTag)),e.NewFileTemplateSource&&e.NewFileTemplateSource.DocUniqueId?$.appendChild(Pi("DocID",e.NewFileTemplateSource.DocUniqueId)):e.WopiPrecheckInfo.DocUniqueId&&$.appendChild(Pi("DocID",e.WopiPrecheckInfo.DocUniqueId)),e.WopiPrecheckInfo.BundleInfo&&e.WopiPrecheckInfo.BundleInfo.Url&&$.appendChild(Pi("bundleUrl",e.WopiPrecheckInfo.BundleInfo.Url)),e.WopiPrecheckInfo.PreseededSessionKey&&!d&&$.appendChild(Pi("PreseededSessionKey",e.WopiPrecheckInfo.PreseededSessionKey)),e.SessionInformation.HostName&&$.appendChild(Pi("fileSrc",e.SessionInformation.HostName)),e.ApplicationCustomSettings&&e.ApplicationCustomSettings.HostUIControls&&$.appendChild(Pi("huictrls",JSON.stringify(e.ApplicationCustomSettings.HostUIControls))),$.appendChild(Pi("feature_status",Y(e.FeatureManager,{wdFlights:S("wdFlights")}))),me()&&$.appendChild(Pi("touchDevice","1")),window.document.documentElement&&(void 0!==window.document.documentElement.clientWidth&&$.appendChild(Pi("windowWidth",window.document.documentElement.clientWidth.toString())),void 0!==window.document.documentElement.clientHeight&&$.appendChild(Pi("windowHeight",window.document.documentElement.clientHeight.toString())));var re=S("PreviousSessionID");if(re&&$.appendChild(Pi("PreviousSessionID",re)),Ee()&&$.appendChild(Pi("LSSupported","1")),$.appendChild(Pi("postMessageToken",e.PostMessageToken)),(e.SessionInformation.HideHeader||"teams"===R&&"UnifiedUiHostTeams"!==e.SessionInformation.UiHostIntegrationType&&"TeamsModern"!==e.SessionInformation.UiHostIntegrationType||"owa"===R||"DocGen"===e.SessionInformation.ContentAssemblyMode||"Templatization"===e.SessionInformation.ContentAssemblyMode||"ContentAssemblyEdit"===e.SessionInformation.ContentAssemblyMode||"ContentAssemblyView"===e.SessionInformation.ContentAssemblyMode)&&$.appendChild(Pi("hhdr","1")),e.SessionInformation.HideAppLauncherInHeader&&$.appendChild(Pi("halh","1")),e.SessionInformation.HideSearchInHeader&&$.appendChild(Pi("hsh","1")),e.SessionInformation.HideMeInHeader&&$.appendChild(Pi("hmh","1")),e.SessionInformation.HideChatInHeader&&$.appendChild(Pi("hch","1")),e.SessionInformation.HideWorkflowInHeader&&$.appendChild(Pi("hwfh","1")),e.SessionInformation.HideSettingsInHeader&&$.appendChild(Pi("hsth","1")),e.SessionInformation.ShowAppIconInHeader&&$.appendChild(Pi("sih","1")),e.SessionInformation.UseNeutralColorInHeader&&$.appendChild(Pi("unh","1")),e.SessionInformation.SupportsAuthToken&&$.appendChild(Pi("sat","1")),e.SessionInformation.SupportsCustomAuthConfig&&$.appendChild(Pi("cac","1")),e.SessionInformation.SupportsCreateNewDocument&&$.appendChild(Pi("scnd","1")),e.SessionInformation.UseDarkTheme&&$.appendChild(Pi("udt","1")),e.SessionInformation.SupportsDirectPrint&&$.appendChild(Pi("sdp","1")),e.SessionInformation.SupportsDirectDownload&&$.appendChild(Pi("sdd","1")),"Templatization"!==e.SessionInformation.ContentAssemblyMode&&"DocGen"!==e.SessionInformation.ContentAssemblyMode&&"ContentAssemblyEdit"!==e.SessionInformation.ContentAssemblyMode&&"ContentAssemblyView"!==e.SessionInformation.ContentAssemblyMode||$.appendChild(Pi("caae","1")),e.SessionInformation.ContentAssemblyMode&&$.appendChild(Pi("caaemode",e.SessionInformation.ContentAssemblyMode)),e.ApplicationUrl.toLowerCase().indexOf("uiembed=1")>-1&&e.SessionInformation.SupportsDocReboot&&$.appendChild(Pi("sdr",!0===e.SessionInformation.SupportsDocReboot?"1":e.SessionInformation.SupportsDocReboot.toString())),e.SessionInformation.HideWACOneDriveFileLocationPicker&&$.appendChild(Pi("hodflp","1")),e.SessionInformation.SupportsAtMentions&&$.appendChild(Pi("sams","1")),e.WopiPrecheckInfo.RequestedCallThrottling){var se=e.WopiPrecheckInfo.RequestedCallThrottling;$.appendChild(Pi("rct",se))}if(e.WopiPrecheckInfo.ClientThrottlingProtection){var ae=e.WopiPrecheckInfo.ClientThrottlingProtection;$.appendChild(Pi("ctp",ae))}e.WopiPrecheckInfo.OpenViewByDefault&&$.appendChild(Pi("ovbd",e.WopiPrecheckInfo.OpenViewByDefault.toString())),e.SessionInformation.SupportsMoveToFolder&&$.appendChild(Pi("mtf","1")),e.SessionInformation.NoBrowserModalDialogs&&$.appendChild(Pi("nbmd","1")),e.SessionInformation.SupportsCommonFilePicker&&$.appendChild(Pi("sfp","1")),e.SessionInformation.OpenLinksInNewWindow&&$.appendChild(Pi("onw","1"));var de=ci(G);de&&de.isInHighContrastMode&&($.appendChild(Pi("IsInHighContrastMode","true")),de.highContrastColors&&$.appendChild(Pi("ClientColorSettings",de.highContrastColors.foregroundTextColor+"_"+de.highContrastColors.backgroundColor+"_"+de.highContrastColors.linkColor)));var ue=e.SessionInformation.OwlVersion;ue&&$.appendChild(Pi("owlver",ue));var le=e.SessionInformation.OwlRollout;return le&&$.appendChild(Pi("owlro",le)),$.appendChild(Pi("jsapibuild",W())),$.submit(),{IFrameElement:j,FrameCreateTime:K}}}function Oi(e){var t=e.appContext,i="";if(we()===ce.Safari)i+="autoplay;microphone;camera;clipboard-read;clipboard-write;display-capture;";else{var n=t.podsUrl+" "+t.cdnBasePath+";";i+="autoplay "+n,i+="microphone "+n,i+="camera "+n,i+="clipboard-read "+n,i+="clipboard-write "+n,i+="display-capture "+n}return{permissionsPolicy:i,minHeight:t.shouldUsePods?"200px":"150px",minWidth:"300px",useAdditionalDiv:!t.shouldUsePods}}function Fi(e,t){return function(e,t){return e+"RemoteTelemetry.ashx"+(t?"?usid="+t:"")}(function(e){var t=e.match(/^(.*?\/\/[^\/]+\/[^\/]+\/)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}(e),t)}!function(e){e.AppInitError="AppInitError",e.ApiDisabledError="ApiDisabledError",e.CannotLoadFirstPage="CannotLoadFirstPage",e.InvalidWopiInfo="InvalidWopiInfo",e.TimeoutWacReady="TimeoutWacReady",e.WacFailed="WacFailed"}(Ai||(Ai={}));var ki={errorType:Ai.AppInitError,errorObject:"Timed out waiting for FnOnInitializeSuccess",Category:0,Code:5,ErrorName:"TimeoutInitialize",EventType:13,ExtraInfo:"Initialization timeout"},Wi=function(e,t){var i=this;if(this.Js=0,this.Gs=0,this.js=0,this.zs=0,this.qs=!1,this.Ks=function(e,t){i.Js=x();var n=6e5,o=S("wdOnSuccessTimeout");o&&parseInt(o,10).toString()===o&&(n=parseInt(o,10),t.ULS.Qe(527521921,P.H,A.Warning,"App Timeout is overridden with url override param wdOnSuccessTimeout: ".concat(n))),n&&window.setTimeout((function(){return i.Zs(e,t)}),n)},this.$s=function(e,t,n,o){var r={Message:"Received ".concat(e," callback after timeout had elapsed"),timeoutTimeMs:i.zs,successTimeMs:i.Gs,startTimeMs:i.Js,appInitDiagnostics:n,error:o};t&&t.ULS.Qe(38589660,P.H,A.Info,JSON.stringify(r))},this.Zs=function(e,t){if(!(i.js||i.Gs||i.zs)){i.zs=x();try{if(ze(e.Container)){if(t){var n="Timed out waiting for FnOnInitializeSuccess to be called. startMs:".concat(i.Js,", timeoutMs:").concat(i.zs,", scenario:Unified, hostSessionId:").concat(e.SessionInformation.HostSessionId,", host: ").concat(e.SessionInformation.HostName);t.ULS.Qe(38589661,P.H,A.Error,n),Ni(e,5,"TimeoutInitialize",n,t,i.zs,!0)}e.FnOnInitializeFailure&&e.FnOnInitializeFailure(ki)}else t&&(t.ULS.Qe(579604899,P.H,A.Warning,"App container is unloaded. Scenario: Unified"),Ni(e,7,"AppContainerUnloadedTimeout","App container is unloaded",t,i.zs,!1))}catch(e){t&&t.ULS.Qe(579604898,P.H,A.Error,"timeoutIfSuccessNotCalled exception: "+X(e))}}},e.FnOnInitializeSuccess){var n=e.FnOnInitializeSuccess;e.FnOnInitializeSuccess=function(o,r){i.Gs=x(),i.qs||(i.qs=!0,i.zs?i.$s("success",t,r):(t&&(t.ULS.Qe(38836226,P.H,A.Info,"TimeoutWrapper: Calling fnOnInitializeSuccess"),Ni(e,void 0,void 0,void 0,t,x(),!1,r)),n(o,r)))}}if(e.FnOnInitializeFailure){var o=e.FnOnInitializeFailure;e.FnOnInitializeFailure=function(n,r){i.js=x(),i.qs||(i.qs=!0,i.zs&&n!==ki?i.$s("failure",t,r,n):(t&&(Ni(e,n.Code,n.ErrorName,n.errorObject,t,x(),!1,r),t.ULS.Qe(38836227,P.H,A.Info,"TimeoutWrapper: Calling fnOnInitializeFailure")),o(n,r)))}}this.Ks(e,t)};function Ni(e,t,i,n,o,r,s,a){var c=null==t&&null==i&&null==n&&!s,d=e.SessionInformation,u=e.WopiPrecheckInfo,l=u.BundleInfo,f=0;null!=d.DocumentClickTime&&d.DocumentClickTime.getTime&&(f=d.DocumentClickTime.getTime());var p={AppMetadata:{BrowserTechnology:"",Browser:"",FileSizeHint:u.FileSize,ApiStartTime:0,HostInitTime:d.HostInitTime,AppVersion:"1."+N(),UseBabylon:"",EntryPoint:hi(e),SessionId:e.SessionId,UserAgent:window.navigator.userAgent,WACRegion:T(e.ApplicationUrl),FileHost:Si(d.HostName),Host:d.HostName,PodsRing:"",UiHost:gi(d.HostName)},BootInfo:{PreloadCompleteTime:0,DocumentClickTime:f,BootSuccess:c,BootTime:r,BootMode:""},BundleMetadata:"[]",FatalErrors:c?"":{ErrorCategory:"fatal",ExtraInfo:"",CorrelationId:"",ErrorCode:t,ErrorName:i,Message:n},NonFatalErrors:[],WopiPrecheckInfo:{FileGetUrlBool:!!u.FileGetUrl,FileNameBool:!!u.FileName,ReadOnly:u.ReadOnly,SupportsDecryptedContentDownload:u.SupportsDecryptedContentDownload,ViewOnly:u.ViewOnly,PreseededSessionKey:u.PreseededSessionKey,BundleInfo:l?{MajorVersion:l.MajorVersion,URLBool:!!l.Url}:""},AppBootTimings:a?a.appBootTimingDict:""};o.ULS.Qe(s?592007955:587843200,P.H,s?A.Error:A.Info,JSON.stringify(p)),R(Fi(e.ApplicationUrl,e.SessionId),"PowerPoint",c?"bootSuccess":"bootFailure")}function Ri(e){var t=6e5,i=e.wdParams.wdonsuccesstimeout;return i&&parseInt(i,10).toString()===i&&(t=parseInt(i,10)),t}function Mi(e){e.appContext.bootComplete=!0,xi(e),e.logger.ULS.Qe(34932955,P.H,A.Warning,JSON.stringify(e.diagnostics)),Di(e)}function xi(e){if(e.appContext.shouldUsePods){var t=e.appInitDiagnostics;t.officeFrameServerDocumentFlushTime=t.documentFlushTime,t.officeFrameServerFirstFlushTime=t.serverFirstFlushTime,t.officeFrameServerStartTime=t.serverStartTime,t.officeServerDocumentProcessStartTime=t.bootStartMs,t.officeServerDocumentProcessEndTime=t.bootEndMs,t.fileRequestsData=[{browserRequest:!1,status:200,isAppCompleteCritical:!0,isDocumentLoadCritical:!0,name:"BootRequest",correlationId:t.downloadCorrelation,startTime:t.downloadStartMs,endTime:t.downloadEndMs,size:t.downloadSize,incremental:t.incDownload}],delete t.documentFlushTime,delete t.serverFirstFlushTime,delete t.serverStartTime,delete t.bootStartMs,delete t.bootEndMs,delete t.downloadCorrelation,delete t.downloadStartMs,delete t.downloadEndMs,delete t.downloadSize,delete t.incDownload}}function Di(e,t,i,n){var o=e.appContext;if(!o.bootRecorded){o.bootRecorded=!0;var r=void 0!==t||void 0!==i||void 0!==n,s=!!e.timeoutTime,a=!!e.failureTime,c=!(!e.successTime||s||a||r),d=c?e.successTime:a?e.failureTime:e.timeoutTime,u=e.file,l=e.hostInitDiagnostics,f=e.bootParams,p=e.contentBundle,h=e.preseededSession,v=e.appInitDiagnostics,w={AppMetadata:{BrowserTechnology:"",Browser:"",FileSizeHint:u.size,ApiStartTime:0,HostInitTime:l.hostInitializeCallTime,AppVersion:"1."+N(),UseBabylon:"",EntryPoint:l.entryPoint,SessionId:e.sessionId,UserAgent:window.navigator.userAgent,WACRegion:T(e.appBasePath),FileHost:e.host.storageHostName,Host:e.hostName,PodsRing:"",UiHost:e.host.uiHostName},BootInfo:{PreloadCompleteTime:0,DocumentClickTime:l.userClickTime,BootSuccess:c,BootTime:d,BootMode:""},BundleMetadata:"[]",FatalErrors:c?"":{ErrorCategory:"fatal",ExtraInfo:"",CorrelationId:"",ErrorCode:t,ErrorName:i,Message:n},NonFatalErrors:[],WopiPrecheckInfo:{FileGetUrlBool:!!u.getUrl,FileNameBool:!!u.name,ReadOnly:f.readOnly,SupportsDecryptedContentDownload:f.supportsDecryptedContentDownload,ViewOnly:f.viewOnly,PreseededSessionKey:h?h.key:void 0,BundleInfo:p?{MajorVersion:p.majorVersion,URLBool:!!p.url}:""},AppBootTimings:v?v.appBootTimingDict:""};e.logger.ULS.Qe(s?592007955:587843200,P.H,s?A.Error:A.Info,JSON.stringify(w))}}function Bi(e,t){Di(e,void 0,t.errorType,X(t.errorObject))}function Hi(e){try{var t=!e.container||!ze(e.container.element),i=t?7:5,n=t?"AppContainerUnloadedTimeout":"TimeoutInitialize",o=t?"App container is unloaded":"Timed out waiting for boot success. startMs:".concat(e.hostInitDiagnostics.hostInitializeCallTime,", timeoutMs:").concat(e.timeoutTime,", scenario:Unified, hostSessionId:").concat(e.hostSessionId,", host: ").concat(e.hostName);if(t)e.failureTime=e.timeoutTime,e.timeoutTime=0;else if(e.appContext.shouldUsePods){var r=function(t,i){Ce(e.appInitDiagnostics,i.Diagnostics),xi(e);var n=j({message:"Received success message after timeout had elapsed",timeoutTime:e.timeoutTime,currentTime:x()},e.diagnostics);e.logger.ULS.Qe(558195677,P.H,A.Info,JSON.stringify(n)),e.removeActionHandler(ie.vi,r)};e.addActionHandler(ie.vi,r)}Di(e,i,n,o)}catch(t){e.logger.ULS.Qe(558893250,P.H,A.Error,"onTimeout exception: "+X(t))}}function Vi(e,t){Di(e,void 0,"AppInitError",X(t))}function Li(){return!1}function Ji(e){e.appContext.shouldUsePods&&yi(e)}var Gi=function(e,t,i,n,o){return e!==ie.Ki?Promise.reject("Wrong flow"):i.ui.uiEmbed?function(e,t,i,n,o){return e!==ie.Ki?Promise.reject("Wrong flow"):new Promise((function(e){i.pendingReboot=!0;var n=void 0;if(t.queryOverrides)try{n=JSON.parse(t.queryOverrides)}catch(e){i.logger.ULS.Qe(592217694,P.H,A.Error,"Failed to parse queryOverrides: ".concat(n))}i.raiseEvent(oe.Reboot,j(j({},t),{previousSessionId:i.sessionId,queryOverrides:n})),e({completion:"success"})}))}(e,t,i):new Promise((function(e){var n=window.location.href;m(n,"wdccsoff")&&(n=v(n,"wdccsoff")),n=h(n,"previoussessionid",i.sessionId,!0),t.controllerServicesParam&&(n=h(n,t.controllerServicesParamName,t.controllerServicesParam)),i.logger.ULS.Qe(560740507,P.H,A.Info,"Updating window.location.href"),window.location.href=n,e({completion:"success"})}))};function ji(e,t,i){if(void 0===i&&(i=!1),!e)throw new TypeError("SessionBootParams");var n=e.appUrl,o=e.appBaseUrl;if(!n&&!o)throw new TypeError("Either appUrl or appBaseUrl should exist");if(n&&"string"!=typeof n)throw new TypeError("AppUrl");if(o&&"string"!=typeof o)throw new TypeError("AppBaseUrl");var r=e.file;if(!r||!i&&!r.name)throw new TypeError("FileInfo");var s=e.container;if(!s||!(s instanceof qe)&&!s.appendChild)throw new TypeError("Container");if(!t&&!$e(e.wopi))throw new TypeError("WopiInfo")}var zi=function(){function e(e,t,i,n,o){this.Xs=0,this.Qs=[],this.gr=!1,this.gr=e,this.Ys=t,this.Qt=i,this.ea=n,this.ta=o,this.restart()}return e.prototype.restart=function(){var e=this,t=this.Ys.getValue(B.lt,!1);this.Xs=M()+(this.ta?this.ta:this.Ys.getValue(B.ot,6e5));var i=this.gr?3e3:5e3;this.ia=window.setInterval((function(){t&&e.Qt.ULS.Qe(595724178,P.H,A.Info,"Boot_HeartBeat"),M()>e.Xs&&(e.stop(),qi(e.Qt),e.ea&&e.ea())}),this.Ys.getValue(B.ut,i)),this.Qs.push(window.setTimeout(qi,this.Ys.getValue(B.rt,6e4),this.Qt,1)),this.Qs.push(window.setTimeout(qi,this.Ys.getValue(B.st,18e4),this.Qt,2))},e.prototype.stop=function(){this.Xs=0,this.ia&&(window.clearInterval(this.ia),this.ia=void 0),this.Qs.forEach((function(e){window.clearTimeout(e)})),this.Qs=[]},e}();function qi(e,t){e.ULS.Qe(594901218,P.H,A.Warning,"Boot_NotComplete_".concat(t||"Final")),e.ULS.flush()}var Ki,Zi=function(e,t,i,n,o){var s,d,l,f,h;if(e!==te.boot)return Promise.reject("Wrong flow");var v=t.appBaseUrl?t.appBaseUrl.toLowerCase():c(t.appUrl).toLowerCase();t.appUrl&&(v=a(v,p(t.appUrl,"region")));var S,I=qt[v];S=I?I.PodsUrl:v+"/pods/",i.Ye.updateEnvironment(S);var b=i.Ye.getValue(B.wt,!1),_=i.Ye.getValue(B.Ut,100),T=b&&_>window.crypto.getRandomValues(new Uint8Array(1))[0]%100,C=i.Ye.getValue(B.gt,!1),U=i.Ye.getValue(B.It,!1),E=m((t.appUrl||"").toLowerCase(),"wdhostscenario","oneuplightspeed")?C:T;"true"===p(t.appUrl||"","wdForceModernEmbedView").toLowerCase()&&(E=!0);var O,F=O=m(t.appUrl||"","embed","1")&&m(t.appUrl||"","PowerPointView","ChromelessView")||void 0!==t.intent&&-1!==t.intent.indexOf("embed")||"interactivepreview"===t.intent?"embed":(null===(s=i.bootParams)||void 0===s?void 0:s.viewOnly)||(null===(d=i.bootParams)||void 0===d?void 0:d.openViewByDefault)&&"default"===(null!==(l=t.intent)&&void 0!==l?l:"default")||"view"===t.intent?"reading":"editor";U||"reading"!==F||(F="embed");var k="editor"===O||"embed"===O&&!E;k&&(F="editor");var N="embed"===O?i.Ye.getValue(B.Pt,"{}"):"reading"===O?i.Ye.getValue(B.At,"{}"):"{}";return i.logger.ULS.Qe(507863259,P.H,A.Info,JSON.stringify({requestedUiType:O,actualUiType:F,modernEmbedEnabled:E,modernReadingEnabled:U,intent:t.intent,uiEmbed:i.ui.uiEmbed,viewOnly:null===(f=i.bootParams)||void 0===f?void 0:f.viewOnly,openViewByDefault:null===(h=i.bootParams)||void 0===h?void 0:h.openViewByDefault,featureGates:N})),k?function(e,t,i,n,o){return e!==te.boot?Promise.reject("Wrong flow"):new Promise((function(e){var s,d=x();if(i.state=y.Booting,i.pendingReboot=!1,ji(t,i.skipWopiValidation,i.skipFileNameCheck),i.intent=t.intent,i.file=t.file,i.customFontCatalogUrl=t.customFontCatalogUrl,i.wopi=t.wopi,i.contentBundle=t.contentBundle,i.newFileTemplate=t.newFileTemplate,i.ownerId=t.ownerId,i.sessionContext=t.sessionContext,i.actNavId=t.actNavId,i.preseededSession=t.preseededSession,i.throttling=t.throttling,i.meeting=t.meeting,i.tenantId=t.tenantId,i.wdParams=Xe(t.wdParams),i.pinnedTarget=t.pinnedTarget,i.rebootOverride=t.rebootOverride,i.bootParams=t.bootParams||{},i.hostInitDiagnostics=j(j({},t.diagnostics),{hostInitializeCallTime:d}),i.Ye.getValue(B.ht,!1)&&Fe(i.hostInitDiagnostics),t.appUrl){var l=t.appUrl;i.appUrl=l;var f=i.bootParams;m(l,"new")&&(f.isNewFile=!0),f.dataLanguage||(h=g(l,"rs"))&&(f.dataLanguage=h);var h,v=i.ui;if(m(l,"uiembed")&&(v.uiEmbed=!0),v.language||(h=g(l,"ui"))&&(v.language=h),!i.hostInitDiagnostics.entryPoint){var S=g(l,"wdorigin");S&&(i.hostInitDiagnostics.entryPoint=S)}if(!i.host.uiHostName){var I=g(l,"uih");I&&(i.host.uiHostName=I)}}else i.appUrl="";i.appBaseUrl=t.appBaseUrl?t.appBaseUrl.toLowerCase():c(t.appUrl).toLowerCase(),i.appBaseUrl=a(i.appBaseUrl,p(i.appUrl,"region")),i.Ye.updateEnvironment(i.appBaseUrl),n.initializeAppContext(i,e,t),i.appBasePath=n.buildAppBasePath(i);var b=!1,_=i.preseededSession;i.appInfo.usePreseededSessionId&&_&&_.id&&(i.sessionId=_.id,b=!0);var T,C=!1,U=t.hostGeneratedSessionId;if(!b&&U&&(i.sessionId=U,C=!0),t.rebootOverride&&(b||C||(s=ue(),i.sessionId=s[0],T=s[1]),i.pageStateObserver=new ke(i.logger,!0),i.authTokenTrustValidator=new Re(i.logger)),i.logger.ULS.Qe(38580693,P.H,A.Info,"User session id: ".concat(i.sessionId,", is preseeded: ").concat(b,", is host generated: ").concat(C)),i.remoteTelemetryUrl=n.buildRemoteTelemetryUrl(i),R(i.remoteTelemetryUrl,i.appInfo.name,"init"),!i.isLoggerFromOwl){var E=i.Ye.getValue(B.nt,"").toString();E||(E=u(i.appBasePath)),i.logger.configure({remoteUlsEndpoint:E,sessionId:i.sessionId})}if(i.Ye.initializePeriodicFetch(i.appBasePath,i.sessionId),T&&i.logger.ULS.Qe(590966790,P.H,A.Info,JSON.stringify(T)),Ue(i),n.onContextReady&&n.onContextReady(i),i.appInitDiagnostics={officeSessionId:i.sessionId,officeBootstrapperVersion:W(),hostName:i.hostName,documentLoadedWithTabSwitch:"hidden"===document.visibilityState},document.addEventListener("visibilitychange",(function(){i.appInitDiagnostics.documentLoadedWithTabSwitch=!0}),{once:!0}),!i.container){var O=t.container;i.container=O instanceof qe?O:i.application.createContainer(O)}i.container.setMessageHandler(i.onMessage);var F=!!n.ignoreCompletionMessage&&n.ignoreCompletionMessage(i),k=function(e,t){i.successTime=x(),F||(i.container.postMessage(ne.ao,void 0),Ce(i.appInitDiagnostics,t.Diagnostics)),i.Ye.addSettingsChangeListener(i.logger.settingsChangeHandler),n.onSuccess&&n.onSuccess(i,t),i.logger.ULS.Qe(596448985,P.H,A.Info,JSON.stringify(i.diagnostics)),R(i.remoteTelemetryUrl,i.application.name,"bootSuccess"),i.logger.ULS.flush(),i.container.postMessage(ne.ho,{HostInitializeDiagnostics:i.hostInitDiagnostics,ClientDiagnostics:i.clientDiagnostics}),i.state=y.Booted,M({completion:"success"}),ye(i.appInfo.name,i.logger)},N=function(e,t){var o;i.failureTime=x(),n.onFailure&&n.onFailure(i,t.Error),i.logger.ULS.Qe(596448986,P.H,A.Error,JSON.stringify({error:t.Error,diagnostics:i.diagnostics})),R(i.remoteTelemetryUrl,i.application.name,"bootFailure"),i.logger.ULS.flush(),i.state=y.Failed,M({completion:"failure",error:t.Error,errorSource:"app",documentLoadedWithTabSwitch:null===(o=i.appInitDiagnostics)||void 0===o?void 0:o.documentLoadedWithTabSwitch}),ye(i.appInfo.name,i.logger)},M=function(t){F||(i.bootHeartBeat&&i.bootHeartBeat.stop(),i.removeActionHandler(ie.vi,k),i.removeActionHandler(ie.pi,N)),e(t)};o&&o.subscribe((function(){var e;M({completion:o.reason||"cancelled",documentLoadedWithTabSwitch:null===(e=i.appInitDiagnostics)||void 0===e?void 0:e.documentLoadedWithTabSwitch})})),F||(i.addActionHandler(ie.vi,k),i.addActionHandler(ie.pi,N)),function(e){var t;if(function(e){return"wdjs"in e||"wd1js"in e}(e))"true"===window.sessionStorage.getItem("sideLoadingIsEnabled")?(!1,"true"===(t=He("sideLoadingIsEnabled"))||"false"!==t&&!1||Ve("sideLoadingIsEnabled","true",1)):Ve("sideLoadingIsEnabled","false",0)}(i.wdParams);var D=n.buildBootRequestParams(i),H=Qe(i,D.appPageName,D.queryParamsOverrides),V=Ye(i,D.postDataOverrides);if(i.bootstrapperUrl&&i.preconnector&&i.preconnector.shouldPreconnect(i.hostName)&&i.preconnector.preconnect(i.bootstrapperUrl),i.bootstrapperUrl&&i.preloader&&i.preloader.shouldPreload(H,i.host.origin))try{n.beforePreload&&n.beforePreload(i);var L=i.bootstrapperUrl;i.featureManager.isFeatureEnabled(J.Mt)&&(i.logger.ULS.Qe(590966791,P.H,A.Info,"HTTP2 preload enabled"),L=w(L)),i.preloader.preload(L,i.ui.language,i.logger,i.featureManager)}catch(e){i.logger.ULS.Qe(590966792,P.H,A.Error,"Error preloading")}n.beforeContainerBoot&&n.beforeContainerBoot(i,H),i.appInitDiagnostics.officeFrameCreateTime=x(),i.container.boot(H,V,i.logger,n.buildContainerBootParams(i)),F?k(ie.vi,{Diagnostics:{}}):(i.bootHeartBeat=new zi(r(i.appBaseUrl),i.Ye,i.logger,(function(){var e;i.timeoutTime=x(),n.onTimeout&&n.onTimeout(i),R(i.remoteTelemetryUrl,i.application.name,"bootTimeout"),M({completion:"timeout",error:{documentLoadedWithTabSwitch:null===(e=i.appInitDiagnostics)||void 0===e?void 0:e.documentLoadedWithTabSwitch}}),o&&o.cancel()}),o&&n.overrideBootTimeout?Math.min(o.timeoutInMs,n.overrideBootTimeout(i)):o?o.timeoutInMs:n.overrideBootTimeout?n.overrideBootTimeout(i):void 0),n.beforeBootCompletionMessage&&n.beforeBootCompletionMessage(i))})).catch((function(e){throw i.failureTime=x(),n.onException&&n.onException(i,e),i.remoteTelemetryUrl&&R(i.remoteTelemetryUrl,i.application.name,"bootException"),i.bootHeartBeat&&i.bootHeartBeat.stop(),{error:e.toString(),errorStack:e.stack}}))}(e,t,i,n,o):new Promise((function(e){return z(void 0,void 0,void 0,(function(){var o,r,s,a,c,d,l,f,h,w,I,b,_,T,C,U,E,O,k,M,D,H,V,L,J,G,K,Z,$,X;return q(this,(function(Q){switch(Q.label){case 0:o=x(),i.state=y.Booting,i.pendingReboot=!1,ji(t,!0),i.intent=t.intent,i.file=t.file,i.customFontCatalogUrl=t.customFontCatalogUrl,i.contentBundle=t.contentBundle,i.newFileTemplate=t.newFileTemplate,i.ownerId=t.ownerId,i.sessionContext=t.sessionContext,i.actNavId=t.actNavId,i.preseededSession=t.preseededSession,i.throttling=t.throttling,i.meeting=t.meeting,i.tenantId=t.tenantId,i.wdParams=Xe(t.wdParams),i.pinnedTarget=t.pinnedTarget,i.rebootOverride=t.rebootOverride,i.bootParams=t.bootParams||{},i.hostInitDiagnostics=j(j({},t.diagnostics),{hostInitializeCallTime:o}),i.Ye.getValue(B.bt,!0)&&(i.wdParams.wdForceModernSlideShowInTeams="true"),i.Ye.getValue(B.ht,!1)&&Fe(i.hostInitDiagnostics),t.appUrl?(r=t.appUrl,i.appUrl=r,s=i.bootParams,m(r,"new")&&(s.isNewFile=!0),s.dataLanguage||(c=g(r,"rs"))&&(s.dataLanguage=c),a=i.ui,m(r,"uiembed")&&(a.uiEmbed=!0),a.language||(c=g(r,"ui"))&&(a.language=c),i.hostInitDiagnostics.entryPoint||(d=g(r,"wdorigin"))&&(i.hostInitDiagnostics.entryPoint=d),i.host.uiHostName||(l=g(r,"uih"))&&(i.host.uiHostName=l)):i.appUrl="",i.appBaseUrl=v,i.appBasePath=S,i.remoteTelemetryUrl=n.buildRemoteTelemetryUrl(i),R(i.remoteTelemetryUrl,i.appInfo.name,"init"),""===(f=i.Ye.getValue(B.nt,"").toString())&&(f=u(i.appBasePath)),i.logger.configure({remoteUlsEndpoint:f,sessionId:i.sessionId}),i.Ye.initializePeriodicFetch(i.appBasePath,i.sessionId),Ue(i),i.appInitDiagnostics={officeSessionId:i.sessionId,officeBootstrapperVersion:W(),hostName:i.hostName,documentLoadedWithTabSwitch:"hidden"===document.visibilityState},document.addEventListener("visibilitychange",(function(){i.appInitDiagnostics.documentLoadedWithTabSwitch=!0}),{once:!0}),h=function(t,n){i.failureTime=x(),i.logger.ULS.Qe(596448986,P.H,A.Error,JSON.stringify({diagnostics:i.diagnostics})),R(i.remoteTelemetryUrl,i.application.name,"bootFailure"),i.logger.ULS.flush(),i.state=y.Failed,e({completion:"failure",error:j(j({},t),{errorSource:n})}),ye(i.appInfo.name,i.logger)},Q.label=1;case 1:if(Q.trys.push([1,3,,4]),!i.bootstrapperUrl)throw new Error("No bootstrapperUrl");if(!(w=new URL(v).hostname).includes("powerpoint"))throw new Error("Invalid appBaseUrl");if(I=Kt[v],i.logger.ULS.Qe(507357262,P.H,A.Info,JSON.stringify({appBaseUrl:w,previewerRing:I})),!I)throw new Error("Unsupported region");return(b=new URL(i.bootstrapperUrl)).hostname=b.hostname.replace("wise.","res."),b.hostname=b.hostname.replace(".gcc.",".gcch."),b.pathname="/pptlive-m/5mttl/bootstrap/".concat(I,"/powerpoint.preview.boot.js"),[4,(Y=b,z(void 0,void 0,void 0,(function(){return q(this,(function(e){return[2,new Promise((function(e,t){var i=document.createElement("script");i.src=Y.href,i.async=!0,i.onload=function(){e()},i.onerror=function(e){t(e)},document.head.appendChild(i)}))]}))})))];case 2:return Q.sent(),[3,4];case 3:return _=Q.sent(),h(_,"JsApi"),[2];case 4:return(null===(k=null===(O=null===(E=null===(U=null===window||void 0===window?void 0:window.Microsoft)||void 0===U?void 0:U.Office)||void 0===E?void 0:E.PowerPoint)||void 0===O?void 0:O.Bootstrap)||void 0===k?void 0:k.InitializeWopiPending)?(T=parseInt(p(t.appUrl||"","wdslideindex"),10),C={ApplicationUrl:i.appUrl,Container:t.container,SessionInformation:{HostName:i.hostName,HostSessionId:i.hostSessionId,UserId:i.user.id,DocumentClickTime:null===(M=i.hostInitDiagnostics)||void 0===M?void 0:M.userClickTime,EntryPoint:null===(D=i.hostInitDiagnostics)||void 0===D?void 0:D.entryPoint,HostInitTime:(new Date).toISOString(),WdParams:i.wdParams,UiHostRing:null===(H=null==t?void 0:t.diagnostics)||void 0===H?void 0:H.teamsRing,PptFeatureGates:N,UiLocale:i.ui.language},WopiPrecheckInfo:{FileName:i.file.name,FileGetUrl:i.file.getUrl,FileSize:i.file.size,ReadOnly:null===(V=i.bootParams)||void 0===V?void 0:V.readOnly,IrmEnabled:null===(L=i.bootParams)||void 0===L?void 0:L.irmEnabled,DocUniqueId:i.file.uniqueId,CTag:i.file.cTag,ETag:i.file.cTag,ViewOnly:null===(J=i.bootParams)||void 0===J?void 0:J.viewOnly},ApplicationCustomSettings:{ForceAccessibilityMode:!1,EnableWacFallback:!1,UseTransparentBackground:!1,UiType:F,StartingSlideIndex:!isNaN(T)&&T>=0?T:-1},Diagnostics:{entryPoint:null===(G=i.hostInitDiagnostics)||void 0===G?void 0:G.entryPoint,userClickTime:null===(K=i.hostInitDiagnostics)||void 0===K?void 0:K.userClickTime,hostPageFirstFlushTime:null===(Z=i.hostInitDiagnostics)||void 0===Z?void 0:Z.hostPageFirstFlushTime,officeBootstrapperStartTime:null===($=i.hostInitDiagnostics)||void 0===$?void 0:$.officeBootstrapperStartTime,officeBootstrapperEndTime:null===(X=i.hostInitDiagnostics)||void 0===X?void 0:X.officeBootstrapperEndTime},FnOnInitializeSuccess:function(){i.successTime=x(),i.logger.ULS.Qe(596448985,P.H,A.Info,JSON.stringify(i.diagnostics)),R(i.remoteTelemetryUrl,i.application.name,"bootSuccess"),i.logger.ULS.flush(),ye(i.appInfo.name,i.logger),i.state=y.Booted,e({completion:"success"})},FnOnInitializeFailure:function(e){h(e,"App")}},window.Microsoft.Office.PowerPoint.Bootstrap.InitializeWopiPending(C).Complete(),[2]):(h(new Error("InitializeWopiPending not found"),"JsApi"),[2])}var Y}))}))}))},$i=function(e,t,i,n,o){return e!==ie.un?Promise.reject("Wrong flow"):new Promise((function(e){var n=i.appContext;"FatalError"===t.Reason?function(e,t){var i=e.hostInitDiagnostics,n={ErrorName:t,BootCompleted:e.appContext.bootComplete,SessionInfo:{HostName:e.hostName,HostSessionId:e.hostSessionId,UiLocale:e.ui.language,DataLocale:e.bootParams.dataLanguage,DocumentClickTime:i.userClickTime,HostInitTime:i.hostInitializeCallTime,UiHost:e.host.uiHostName,WdParams:e.wdParams}};e.logger.ULS.Qe(587236555,P.H,A.Error,JSON.stringify(n))}(i,t.ErrorName):i.logger.ULS.Qe(558421913,P.H,A.Info,"Updating boot complete - reason [".concat(t.Reason,"]")),n.bootComplete||(i.bootHeartBeat&&i.bootHeartBeat.stop(),n.bootFlowResolve({completion:"success"})),i.successTime=x(),Di(i),e({completion:"success"})}))},Xi=function(){var e,t;return[(e={},e[ee.appReboot]=Gi,e[ee.boot]=Zi,e[ee.closeTab]=Ze,e[ee.createNew]=et,e[ee.dispose]=rt,e[ee.frameTrust]=st,e[ee.getAuthToken]=at,e[ee.getHostKeyValue]=Ze,e[ee.handleBootState]=ct,e[ee.postWacToken]=dt,e[ee.rename]=ut,e[ee.setOverlayContent]=lt,e[ee.setWacFlightValue]=ft,e[ee.storeHostKeyValue]=Ze,e[ee.switchMode]=Ze,e[ee.updateBootComplete]=$i,e),(t={},t[ee.boot]={initializeAppContext:ii,buildAppBasePath:ni,buildRemoteTelemetryUrl:oi,ignoreCompletionMessage:ri,buildBootRequestParams:Ti,beforeContainerBoot:Ci,buildContainerBootParams:Oi,overrideBootTimeout:Ri,onSuccess:Mi,onFailure:Bi,onTimeout:Hi,onException:Vi},t[ee.createNew]={parallelizeStartSessionRequest:Li,sendCreateNewWopiInfo:Ji},t)]};!function(e){e[e.AppPageLoading=0]="AppPageLoading",e[e.AppReadyForPostMessage=1]="AppReadyForPostMessage",e[e.AppBootComplete=2]="AppBootComplete",e[e.DEPRECATED=3]="DEPRECATED",e[e.RefreshPage=4]="RefreshPage",e[e.UpdateInitializationComplete=6]="UpdateInitializationComplete",e[e.ProfileClientResourceUsage=7]="ProfileClientResourceUsage",e[e.ULSLog=8]="ULSLog"}(Ki||(Ki={}));var Qi=function(){function e(){var t=this;this.na={},this.oa=function(e,i){for(var n in t.na){var o=t.na[n];o&&o.log(e,i)}},this.ra=function(t){var i;try{i=JSON.parse(t.data)}catch(e){i=null}if(i){var n=i.m_id||i.Token;if(n){var o=e.getInstance(),r=o.get(n);r?r.onMessage(i,t.source):o.oa("Message received with no targetApi. Id: "+n.toString(),t.data)}}},window.addEventListener("message",this.ra)}return e.getInstance=function(){return this.sa||(this.sa=new e),this.sa},e.prototype.add=function(e,t){this.na[e]=t},e.prototype.get=function(e){return this.na[e]},e.prototype.remove=function(e){this.na[e]=null},e}();function Yi(e,t,i,n){return{ShouldUsePODS:e,CanUsePODS:t,Reason:i,CreateNewScenario:n}}function en(e,t){var i,n,o=e.WopiPrecheckInfo,r=e.ApplicationUrl,s=function(e,t,i,n){var o,r;e.CreateNewInfo?(r=ot.UnifiedCreateNew,o="CreateNewInfo"):e.IsNewFile?(r=ot.UnifiedCreateNew,o="CreateNewInfoIsNewFile"):e.IsNewFileFromHostTemplate?(r=ot.UnifiedCreateNew,o="CreateNewInfoFromHostTemplate"):i&&i.FileGetUrl?(r=ot.UnifiedCreateNew,o="CreateNewInfoFromTemplateSourceUrl"):m(t,"new")?0!==e.FileSize?(r=ot.LegacyCreateNew,o="ApplicationUrlContainsNewAndNonZeroByteFile"):(r=ot.UnifiedCreateNew,o="ApplicationUrlContainsNew"):(r=ot.NotCreateNew,o="NotCreateNew");var s={};return s.CreateNewScenario=ot[r],s.reason=o,n.ULS.Qe(34932951,P.H,A.Info,JSON.stringify(s)),r}(o,r,e.NewFileTemplateSource,t),a=S("wdPodsEnabled");return i=o.FileGetUrl,n=a?Yi("false"!==a,!0,"wdPodsEnabled is available",s):function(e,t,i){if($t(e))return t===ot.LegacyCreateNew?Yi(!1,!1,"Legacy Create New Scenario because application url contains new, but non-zero file size",t):-1!==e.indexOf("&Embed=1")?Yi(!1,!1,"Embed View fallback to WAC",t):Yi(!0,!0,"Supported Region",t);var n="Wac region not currently supported by PODS: "+(T(e)||"");return i.ULS.Qe(589168768,P.H,A.Warning,n),Yi(!1,!1,n,t)}(r,s,t),i||n.CreateNewScenario!==ot.NotCreateNew?n:Yi(!1,!1,n.Reason+"| FileGetUrl is empty",n.CreateNewScenario)}var tn,nn,on=function(){function e(){var e=this;if(this.aa=[],this.ca=[],this.da=function(){var t={visibility:document.visibilityState,time:x(),initialState:!1};e.aa.push(t);for(var i=0,n=e.ca;i<n.length;i++){var o=n[i];o&&o(t)}},"hidden"===document.visibilityState){var t={visibility:document.visibilityState,time:x(),initialState:!0};this.aa.push(t)}document.addEventListener("visibilitychange",this.da)}return e.prototype.registerEventHandler=function(e){this.ca.push(e)},e.prototype.removeEventHandler=function(e){if(e){var t=this.ca.indexOf(e);this.ca.splice(t,1)}},e.prototype.stop=function(){document.removeEventListener("visibilitychange",this.da)},e.prototype.getVisibilityChangeEvents=function(){return this.aa},e.prototype.dispose=function(){this.stop(),this.ca=[],this.aa=[]},e}(),rn=((tn={})[te.blurFocus]=ne.ro,tn[te.continueAccessibilityLoop]=ne.uo,tn[te.grabFocus]=ne.lo,tn[te.moveToFolder]=ne.Vi,tn[te.popState]=ne.wo,tn[te.rename]=ne.yo,tn[te.sendAccessToken]=ne.Po,tn[te.sendAuthToken]=ne.Ao,tn[te.sendCustomAuthConfig]=ne.Uo,tn[te.sendEmbeddedViewUrl]=ne.Oo,tn[te.sendSessionInfo]=ne.Fo,tn[te.sendUserAccessAndPermissions]=ne.ko,tn[te.sendWopiInfo]=ne.Wo,tn[te.sendDavUrl]=ne.No,tn[te.completeSharedFilePicker]=ne.Yi,tn[te.switchMode]=ne.Ho,tn[te.signalShared]=ne.Go,tn),sn=function(){function e(e,t){var i,n,o=this;if(this.ua=!1,this.ca={},this.wr="",this.mr="",this.Ir=!1,this.gr=!1,this.Sr=!1,this.br=!1,this.la=[],this.fa=!0,this.pa=function(e,t,i){if(e){var n={MessageId:ne.io,CorrelationId:i,SendTime:x()};o.Qt.ULS.Qe(595732176,P.H,A.Info,"Sending Ack back"),e.postMessage(JSON.stringify(n),t)}else o.Qt.ULS.Qe(595736136,P.H,A.Info,"Missing target to send Ack back")},this.ha=function(e){var t,i=!1,n=!0,r="",s=!1;if(o.va&&o.va.contentWindow&&(i=!0,n=e.source===o.va.contentWindow),e.origin&&!(s=(r=d(e.origin,2).toLowerCase())===o.mr)&&o.Cr&&(r=d(e.origin).toLowerCase(),s=o.Cr.includes(r)),!o.gr&&(!o.Sr||s&&n)||o.Qt.ULS.Qe(595730526,P.H,A.Info,"Window is available: ".concat(i,", window is valid: ").concat(n,", origin is valid: ").concat(s,", expected origin: ").concat(o.mr,", actual origin: ").concat(r)),s&&(!o.Ir||n)){var a;try{a=JSON.parse(e.data)}catch(e){return void o.Qt.ULS.Qe(596464282,P.H,A.Info,"Failed to parse event data: ".concat(X(e),"."))}var c=a.MessageId;if(c){if(o.Qt.ULS.Qe(595714715,P.H,A.Info,"Received messageId: ".concat(c,", correlation: ").concat(a.CorrelationId)),c!==ie.vi&&c!==ie.Bi||o.wa(e.origin),o.br&&c===ie.$n)return window._pageTimings=null!==(t=window._pageTimings)&&void 0!==t?t:{},void(window._pageTimings[a.Values.name]=a.Values.time);a.Values&&a.Values.ackExpected&&o.pa(e.source,e.origin,a.CorrelationId);var u=o.ca[c];if(!u)return o.Qt.ULS.Qe(596464289,P.H,A.Info,"No handler found for message id: ".concat(c)),void(o.fa&&c===ie.Ni&&(o.la.push(a),o.Qt.ULS.Qe(543207888,P.H,A.Info,"Kept for later process: ".concat(c))));o.Qt.ULS.Qe(596464288,P.H,A.Info,"Processing message: ".concat(c)),c===ie.nn&&(a.Values=j(j({},a.Values||{}),{sendTimeAsClickTime:a.SendTime}));try{u(a.Values||{})}catch(e){o.Qt.ULS.Qe(593773704,P.H,A.Error,"Handler error: ".concat(X(e)))}}else(o.gr||o.Sr)&&o.Qt.ULS.Qe(595730520,P.H,A.Info,"Could not find message id")}},this.ma=function(){o.fa=!1,o.la.forEach((function(e){var t=e.MessageId,i=o.ca[t];if(i){o.Qt.ULS.Qe(543207890,P.H,A.Info,"Processing message after boot complete: ".concat(t));try{i(e.Values||{})}catch(e){o.Qt.ULS.Qe(543207891,P.H,A.Error,"Handler error: ".concat(X(e)))}}else o.Qt.ULS.Qe(543207889,P.H,A.Info,"No handler found after boot complete: ".concat(t))})),o.la=[]},this.ga=function(e,t,i){e.postMessage(t,i)},this.wa=function(e){var t=e.toLowerCase();o.wr&&o.wr!==t&&o.Qt.ULS.Qe(596128131,P.H,A.Warning,"Updating origin: [".concat(T(o.wr),"]->[").concat(T(t),"]")),o.wr=t,o.mr=d(t,2),o.gr=r(t),o.Sr=s(t)},!e)throw new Error("Missing origin for PostMessageHandler");this.gr=r(e),this.Sr=s(e),this.Qt=t,this.wa(e),this.br=!!(null===(n=null===(i=window.location)||void 0===i?void 0:i.search)||void 0===n?void 0:n.match(/wdpa=1/gi))||"1"===He("EnableMetricLogging")}return e.prototype.registerMessagePayloadHandler=function(e,t){if(this.ca[e])throw new Error("Duplicate registration!");this.ca[e]=t},e.prototype.removeMessageHandler=function(e){delete this.ca[e]},e.prototype.sendPostMessage=function(e,t,i){if(e&&e.contentWindow){this.Qt.ULS.Qe(596464334,P.H,A.Info,"Sending message: "+t);var n={MessageId:t,SendTime:x(),Values:i};this.ga(e.contentWindow,JSON.stringify(n),this.wr)}else this.Qt.ULS.Qe(595948308,P.H,A.Info,"Missing target for SendPostMessage")},e.prototype.activate=function(e,t){this.va=e,this.Ir=!!t,this.ua||(window.addEventListener("message",this.ha,!1),this.ua=!0)},e.prototype.postMessageForCommand=function(e,t,i){var n=rn[t];n?(this.Qt.ULS.Qe(595702598,P.H,A.Info,"Sending message ".concat(n," for command ").concat(t)),this.sendPostMessage(e,n,i)):this.Qt.ULS.Qe(595702599,P.H,A.Warning,"No mapping for command ".concat(t))},e.prototype.dispose=function(){this.ca={},this.ua&&(window.removeEventListener("message",this.ha,!1),this.ua=!1)},e}();!function(e){e.BrowserEvent="BrowserEvent",e.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",e.PageChanged="PageChanged",e.ZoomChanged="ZoomChanged",e.ContentRefreshBegin="ContentRefreshBegin",e.ContentRefreshEnd="ContentRefreshEnd",e.AppClosed="UI_Close",e.UserEdit="Edit_Notification",e.FileRename="File_Rename",e.FileShare="UI_Sharing",e.ShowFileVersions="UI_FileVersions",e.UIWorkflow="UI_Workflow",e.IsDisabled="IsDisabled",e.AccessibilityLoopComplete="App_AccessibilityLoopComplete",e.Unloaded="Unloaded",e.Disposed="Disposed",e.SwitchMode="App_SwitchMode",e.DocumentReboot="DocReboot",e.WopiInfoFromUrl="WopiInfoFromUrl",e.DavUrlFromIds="DavUrlFromIds",e.ModeSwitched="ModeSwitched",e.CreateNewDocument="App_CreateNewDocument",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.SetOverlayContent="SetOverlayContent",e.MoveToFolder="MoveToFolder",e.SharedFilePicker="SharedFilePicker"}(nn||(nn={}));var an=!1,cn=!1;function dn(e){if(!an)try{an=!0,cn=!1,function(e){e.innerApplicationFrame&&(e.innerApplicationFrame.src="about:blank",window.setTimeout((function(){e.innerApplicationFrame&&e.innerApplicationFrame.parentElement&&e.innerApplicationFrame.parentElement.removeChild(e.innerApplicationFrame),e.onFrameRemoved&&e.onFrameRemoved()}),0))}(e),function(e){var t={disposeStartTime:e.disposeStartTime,disposeEndTime:x(),forceAppUnload:e.forceAppUnload,appUnloadTimedOut:e.appUnloadTimedOut};if(e.forceAppUnloadStartTime&&(t.appUnloadStartTime=e.forceAppUnloadStartTime),e.forceAppUnloadEndTime&&(t.appUnloadEndTime=e.forceAppUnloadEndTime),e.appUnloadedMessageValues){var i=e.appUnloadedMessageValues,n=Number(i.hostMessageReceived);e.forceAppUnloadStartTime&&!isNaN(n)&&(t.hostToAppPostMessageLatency=n-e.forceAppUnloadStartTime);var o=Number(i.appMessageSent);!isNaN(o)&&e.forceAppUnloadEndTime&&(t.appToHostPostMessageLatency=e.forceAppUnloadEndTime-o);var r=Number(i.appUnloadStart),s=Number(i.appUnloadEnd);if(isNaN(r)||isNaN(s)||(t.appUnloadLatency=s-r),i.serverTimings){var a=i.serverTimings;for(var c in a)t["st-"+c.toString()]=a[c]}}e.logger.ULS.Qe(595855436,P.H,A.Info,"App disposed "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(e),e.onDisposed&&e.onDisposed()}catch(t){e.logger.ULS.Qe(595714434,P.H,A.Error,"Error disposing: ".concat(X(t)))}}var un,ln=function(e){function t(t,i,n,o,r){var s=e.call(this,t,i,n,o,r)||this;return s.Sa={},s.Ia=!1,s.ba=!1,s._a=function(){s.ba||(s.ba=!0,s.Ia=!1,s.Ta&&s.Ta(),s.Ca(nn.Unloaded,{}),s.Ca(nn.Disposed,{}),s.Sa.disposeEndTime=x(),s.Qt.ULS.Qe(41710159,P.H,A.Info,JSON.stringify(s.Sa)),s.ca={})},s.ya=function(e){s.Sa.appUnloadEndTime=x(),e&&(s.Sa.wacDisposeTelemetry=e),s._a()},s.Pa=function(){!s.Ia&&s.ba||(s.Qt.ULS.Qe(41710160,P.H,A.Warning,"Unload timed out"),s.Sa.appUnloadTimedOut=!0),s._a()},s.Aa.registerMessagePayloadHandler(ie.an,s.ya),s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}G(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}(t,e),t.prototype.Dispose=function(e,t){if(!(this.ba||this.Ia&&e))if(this.Sa.disposeStartTime=x(),e){this.Ia=!0,this.Sa.appUnloadStartTime=x(),this.Sa.forceAppUnload=e,this.Aa.sendPostMessage(this.va,ne.Vo,{});var i=t||1e3;window.setTimeout(this.Pa,i)}else this._a()},t}(function(){function e(e,t,i,n,o){var r=this;this.ca={},this.Ua=function(){r.Aa.registerMessagePayloadHandler(ie.Ki,r.Ea),r.Aa.registerMessagePayloadHandler(ie.xi,r.Oa),r.Aa.registerMessagePayloadHandler(ie.Di,r.Fa),r.Aa.registerMessagePayloadHandler(ie.Ni,r.ka),r.Aa.registerMessagePayloadHandler(ie.nn,r.Wa),r.Aa.registerMessagePayloadHandler(ie.Ri,r.Na),r.Aa.registerMessagePayloadHandler(ie.Vi,r.Ra),r.Aa.registerMessagePayloadHandler(ie.Yi,r.Ma)},this.Ca=function(e,t){var i=r.ca[e];if(i)try{i(t||{})}catch(e){r.Qt.ULS.Qe(593773706,P.H,A.Error,"Handler error: ".concat(X(e)))}},this.Ea=function(e){e.previousSessionId=r.Ls,r.Ca(nn.DocumentReboot,e)},this.Oa=function(e){r.Ca(nn.WopiInfoFromUrl,e)},this.Fa=function(e){r.Ca(nn.DavUrlFromIds,e)},this.ka=function(e){Promise?r.xa.isResourceTrustedForMessage(e).then((function(t){t?r.Ca(nn.GetAuthToken,e):r.Aa.sendPostMessage(r.va,ne.Ao,{AuthToken:"",Error:"accessDenied",RequestId:e.RequestId,IdentityType:e.IdentityType})}),(function(){r.Aa.sendPostMessage(r.va,ne.Ao,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:e.RequestId,IdentityType:e.IdentityType})})):r.Aa.sendPostMessage(r.va,ne.Ao,{AuthToken:"",Error:'"Promise" does not exist natively in browser',RequestId:e.RequestId,IdentityType:e.IdentityType})},this.Wa=function(e){r.Ca(nn.FileShare,e)},this.Na=function(e){r.Ca(nn.GetCustomAuthConfig,e)},this.Ra=function(e){r.Ca(nn.MoveToFolder,e)},this.Ma=function(e){r.Ca(nn.SharedFilePicker,e)},this.Ls=e,this.Qt=t,this.va=o.innerApplicationFrame,this.Aa=i,this.Ta=n,this.xa=new Re(t),this.Ua(),an=!1}return e.prototype.GetApplicationType=function(){return"PowerPoint"},e.prototype.GetVersion=function(){return W()},e.prototype.GetSessionId=function(){return this.Ls},e.prototype.RegisterEventHandler=function(e,t){switch(e){case nn.Unloaded:case nn.Disposed:case nn.DocumentReboot:case nn.WopiInfoFromUrl:case nn.DavUrlFromIds:case nn.GetAuthToken:case nn.GetCustomAuthConfig:case nn.MoveToFolder:case nn.SharedFilePicker:case nn.SetOverlayContent:case nn.FileShare:if(this.ca[e])throw new Error("Duplicate registration");this.ca[e]=t;break;default:this.Aa.registerMessagePayloadHandler(e,t)}},e.prototype.RemoveEventHandler=function(e,t){switch(e){case nn.Unloaded:case nn.Disposed:case nn.DocumentReboot:case nn.FileShare:case nn.WopiInfoFromUrl:case nn.DavUrlFromIds:case nn.GetAuthToken:case nn.GetCustomAuthConfig:case nn.MoveToFolder:case nn.SharedFilePicker:case nn.SetOverlayContent:if(this.ca[e]!==t)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.ca[e];break;default:this.Aa.removeMessageHandler(e)}},e.prototype.RegisterErrorHandler=function(e){},e.prototype.RemoveErrorHandler=function(e){},e.prototype.PostCommand=function(e,t){this.Aa.postMessageForCommand(this.va,e,t)},e.prototype.Dispose=function(e,t){var i=this;!function(e,t,i,n,o,r,s){if(t.ULS.Qe(595714433,P.H,A.Info,"Starting disposing the application. unloadApp:".concat(e,"; disposed:").concat(an,"; unloading:").concat(cn)),an||cn&&e)t.ULS.Qe(595714908,P.H,A.Info,"Application is already disposed or unloading");else{var a,c={logger:t,postMessenger:i,innerApplicationFrame:n,onDisposed:o,onFrameRemoved:r,unloadTimeoutInMs:s||1e3,forceAppUnload:!1,disposeStartTime:x(),appUnloadTimedOut:!1};if(e&&n)return cn=!0,c.forceAppUnload=!0,(a=c).forceAppUnloadStartTime=x(),a.logger.ULS.Qe(595855490,P.H,A.Info,"Sending postmessage to unload app"),a.logger.ULS.flush(),a.postMessenger.registerMessagePayloadHandler(ie.an,(function(e){return function(e,t){e.forceAppUnloadEndTime=x(),e.appUnloadedMessageValues=t,e.logger.ULS.Qe(595855491,P.H,A.Info,"AppUnloaded received from app"),dn(e)}(a,e)})),a.postMessenger.sendPostMessage(a.innerApplicationFrame,ne.Vo,{}),void window.setTimeout((function(){return function(e){!cn&&an||(e.appUnloadTimedOut=!0,e.logger.ULS.Qe(595855492,P.H,A.Info,"ApplicationUnload timed out, forcing dispose"),dn(e))}(a)}),a.unloadTimeoutInMs);dn(c)}}(e||!1,this.Qt,this.Aa,this.va,(function(){delete i.va,i.Ta(),i.Aa.dispose(),i.Ca(nn.Unloaded,{})}),(function(){try{i.Ca(nn.Disposed,{}),i.ca={}}catch(e){i.Qt.ULS.Qe(589108815,P.H,A.Error,"onFrameRemoved error: ".concat(X(e)))}}),t)},e}()),fn=function(){function e(){this.hasAppBooted=!1}return e.prototype.getIfAllFieldsSet=function(){if(this.wopiInfo&&this.hasAppBooted&&this.iframe&&this.podsUrl)return{wopiInfo:this.wopiInfo,iframe:this.iframe,podsUrl:this.podsUrl,readonly:this.readonly,hasAppBooted:this.hasAppBooted,irmEnabled:this.irmEnabled,supportsDecryptedContentDownload:this.supportsDecryptedContentDownload,fileName:this.fileName}},e}(),pn=function(){function e(e,t,i,n,o){var r,s=this;this.Da=new fn,this.Ba=!1,this.Ha=new on,this.Va=function(){var e=Qi.getInstance();e&&s.La&&e.remove(s.La.PptInitParams.PostMessageToken),s.As&&s.As.dispose(),s.Ja&&s.Ja.parentElement&&s.Ja.parentElement.removeChild(s.Ja),s.Ja&&delete s.Ja,s.Ga(),s.Qt.ULS.Qe(587552790,P.H,A.Warning,"PPTUnifiedSessionLoader::dispose:: App dispose"),s.Ha.stop()},this.ja=function(){var e,t,i,n,o=s.Da&&s.Da.getIfAllFieldsSet();if(!s.za&&o&&o.iframe.contentWindow){var r={};r.WopiSrc=o.wopiInfo.WopiSrc,r.AccessToken=o.wopiInfo.AccessToken,r.AccessTokenTTL=o.wopiInfo.AccessTokenExpiry?o.wopiInfo.AccessTokenExpiry.getTime():0,r.ReadOnly=o.readonly,r.IrmEnabled=o.irmEnabled,r.SupportsDecryptedContentDownload=o.supportsDecryptedContentDownload,r.FileName=o.fileName,r.SessionContext=s.qa,r.WdParams=s.Ka,r.DocumentURL=window.location.href,o.wopiInfo.WacToken&&(r.WacToken=o.wopiInfo.WacToken);var a=S("PreviousSessionID");a&&(r.PreviousSessionID=a),(null===(i=null===(t=null===(e=s.La)||void 0===e?void 0:e.PptInitParams)||void 0===t?void 0:t.SessionInformation)||void 0===i?void 0:i.HostSessionId)&&(r.HostSessionId=null===(n=s.La)||void 0===n?void 0:n.PptInitParams.SessionInformation.HostSessionId),s.Za(r),o.iframe.contentWindow.postMessage(JSON.stringify(r),o.podsUrl),s.za=!0}},this.Za=function(e){var t,i,n,o,r,a,c=null!==(t=window.WOPIPerf_FirstPageFlush)&&void 0!==t?t:null===(n=null===(i=s.La)||void 0===i?void 0:i.AppInitDiagnostics)||void 0===n?void 0:n.hostPageFirstFlushTime;c&&(e.FirstPageFlushTime=c);var d=window.WOPIPerf_BootJsStartTime;d&&(e.BootJsStartTime=d);var u=window.WOPIPerf_BootJsEndTime;u&&(e.BootJsEndTime=u);var l=window.WOPIPerf_InitializeWac;l&&(e.InitializeWacTime=l);var f=window.WOPIPerf_UserClick,p=s.La&&s.La.AppInitDiagnostics&&s.La.AppInitDiagnostics.userClickTime;if(f?e.UserClickTime=f:p&&(e.UserClickTime=p),window.performance){var h=window.performance.timing;h&&(e.NavigationStart=h.navigationStart,e.FetchStart=h.fetchStart,e.RequestStart=h.requestStart,e.ResponseStart=h.responseStart,e.ResponseEnd=h.responseEnd);var v=window.performance.navigation;v&&(e.NavigationType=v.type,e.NavigationRedirects=v.redirectCount)}e.UnifiedUiHostDiagnostics=null===(r=null===(o=s.La)||void 0===o?void 0:o.AppInitDiagnostics)||void 0===r?void 0:r.unifiedUiHostDiagnostics,e.ClientDiagnostics=null===(a=s.La)||void 0===a?void 0:a.PptInitParams.ClientDiagnostics,s.$a(e)},this.$a=function(e){var t;if(window.performance&&window.performance.getEntriesByType){var i=null===(t=window.performance.getEntriesByType("navigation")[0])||void 0===t?void 0:t.toJSON();i&&i.name&&(delete i.name,e.HostPerfNavigationTelemetry=i)}},this.Xa=function(e,t,i){s.Da&&(s.Da.wopiInfo=e),t===ot.UnifiedCreateNew&&function(e){if(e&&e.NewFilePath)window.history.replaceState(null,"",e.NewFilePath),e.UpdatedPageTitle&&(window.document.title=e.UpdatedPageTitle);else if(window.location.href.indexOf("action=editnew")>=0){var t=window.location.href.replace("action=editnew","action=edit");window.history.replaceState(null,window.document.title||"",t)}}(i),window.setTimeout(s.ja,1)},this.Ga=function(){window.removeEventListener("beforeunload",s.tr,{capture:!0}),window.removeEventListener("pagehide",s.ir,{capture:!0}),window.removeEventListener("visibilitychange",s.nr,{capture:!0})},this.Qa=function(){var e=je(s.Qt);s.As?s.As.sendPostMessage(s.Ja,ne.ki,{isTopFrameTrusted:e}):s.Qt.ULS.Qe(51237655,P.H,A.Error,"Trust frame request received but the wac frame is null")};var d,u=void 0;Promise&&(this.Ya=new Promise((function(e){return s.ec=e})));try{var l=void 0,f=!1;e.WopiPrecheckInfo&&e.WopiPrecheckInfo.PreseededWacSessionId?(d=e.WopiPrecheckInfo.PreseededWacSessionId,f=!0):i?d=i:(d=(r=ue())[0],l=r[1]),R(Fi(e.ApplicationUrl,d),"PowerPoint","init"),function(e){if(void 0===e)throw new TypeError("initParams");var t=e.Container;if(void 0===t||void 0===t.appendChild)throw new TypeError("Container");var i=e.SessionInformation;if(void 0===i||void 0===i.HostName||void 0===i.HostSessionId||void 0===i.UserId)throw new TypeError("SessionInformation");var n=e.ApplicationUrl;if(void 0===n||"string"!=typeof n)throw new TypeError("ApplicationUrl");var o=e.WopiPrecheckInfo;if(void 0===o||void 0===o.FileName)throw new TypeError("WopiPrecheckInfo");if(void 0===e.FnOnInitializeSuccess)throw new TypeError("FnOnInitializeSuccess");if(void 0===e.FnOnInitializeFailure)throw new TypeError("FnOnInitializeFailure")}(e),function(e){!e.WopiPrecheckInfo.PreseededSessionKey||"_._._."===e.WopiPrecheckInfo.PreseededSessionKey.slice(0,6)&&"-.-.-."===e.WopiPrecheckInfo.PreseededSessionKey.slice(-6)||(e.WopiPrecheckInfo.PreseededSessionKey="_._._."+e.WopiPrecheckInfo.PreseededSessionKey+"-.-.-.")}(e),e.ApplicationUrl=a(e.ApplicationUrl,p(e.ApplicationUrl,"region")),e.ApplicationUrl=v(e.ApplicationUrl,"region");var h=function(e){if(e){var t=$t(e);return t?t.PodsUrl:e.substring(0,e.toLowerCase().indexOf("powerpointframe.aspx")).replace("/p/","/pods/")}return""}(e.ApplicationUrl);u=t||L({remoteUlsEndpoint:h+"RemoteUls.ashx",sessionId:d}),this.Qt=u;var w=mi(e.SessionInformation.HostSessionId),g=j(j({},e),{SessionId:d,PostMessageToken:w,OnDemandServer:h,FeatureManager:n||Q(e.FnIsFeatureEnabled,u),SettingsManager:o||new ae("PowerPoint",u),UsePodsDetails:en(e,u),ClientDiagnostics:Ae()});o||(g.SettingsManager.addSettingsChangeListener(u.settingsChangeHandler),g.SettingsManager.initializePeriodicFetch(h,d)),new Wi(g,u),u.ULS.Qe(38580693,P.H,A.Warning,"PPTBootstrapper - initializing session. Build version: ".concat(W(),"; UserSessionId: ").concat(d,"; IsSessionIdPreseeded: ").concat(f,"; IsSessionIdToUseProvided: ").concat(!!i)),u.ULS.Qe(38580694,P.H,A.Info,"Bootstrapper Init Time: ".concat((new Date).getTime())),l&&u.ULS.Qe(572618978,P.H,A.Info,JSON.stringify(l)),window.addEventListener("unload",(function(){u.ULS.Qe(41157219,P.H,A.Warning,"Unloading bootstrapper window."),u.ULS.flushOnClose()})),this.tr=function(){return Ii(u,"OnBeforeUnload",!0)},this.ir=function(){return Ii(u,"OnPageHide",!0)},this.nr=function(){return Ii(u,"VisibilityChange_"+document.visibilityState,!0)},window.addEventListener("beforeunload",this.tr,{capture:!0,once:!0}),window.addEventListener("pagehide",this.ir,{capture:!0}),window.addEventListener("visibilitychange",this.nr,{capture:!0}),u.ULS.Qe(38580695,P.H,A.Info,"Application.InitializeWopiPending"),function(e,t){var i={BootstrapperType:"TypeScript",JsApiVersion:"v1",Preview:!1,Scenario:"Unified App",ApplicationUrl:T(e.ApplicationUrl)||null,IsDeepLink:!!S("nav"),BootstrapperInstanceId:le(),IsMobileView:be()};i.ApplicationCustomSettings={OnDemandServer:T(e.OnDemandServer)||null,EnableWacFallback:!0};var n=e.SessionInformation,o=e.Diagnostics,r=o&&o.userClickTime?o.userClickTime:n.DocumentClickTime?n.DocumentClickTime.getTime():null;i.SessionInformation={HostName:n.HostName,HostSessionId:n.HostSessionId,UiLocale:n.UiLocale,DataLocale:n.DataLocale,DocumentClickTime:r,HostInitTime:n.HostInitTime,CurrentTime:x(),UiHost:gi(n.HostName),WdParams:n.WdParams},i.Diagnostics={EntryPoint:hi(e),FileHost:Si(e.SessionInformation.HostName),PodsRing:"",UnifiedUiHostDiagnostics:o?o.unifiedUiHostDiagnostics:null};var s=e.WopiPrecheckInfo,a=!!s.FileGetUrl,c=!!s.CustomFontCatalogUrl;i.WopiPrecheckInfo={FileSize:s.FileSize,FileGetUrlBool:a,CustomFontCatalogBool:c,FileGetUrlLength:a?s.FileGetUrl.length:null,FileNameBool:!!s.FileName,ReadOnly:s.ReadOnly,IrmEnabled:s.IrmEnabled,SupportsDecryptedContentDownload:s.SupportsDecryptedContentDownload,ViewOnly:s.ViewOnly,PreseededSessionKey:!!s.PreseededSessionKey,FileExtension:Z(s.FileName)||null,BundleInfo:s.BundleInfo?{MajorVersion:s.BundleInfo.MajorVersion,URLBool:!!s.BundleInfo.Url}:{}},i.AppInfo={AppVersionMajor:1,AppVersionMinor:N(),Environment:"wac",UserAgent:window.navigator.userAgent},i.AdditionalTelemetry={PostMessageToken:e.PostMessageToken},t.ULS.Qe(22357763,P.H,A.Info,JSON.stringify(i,$))}(g,u);var b=g.UsePodsDetails;!function(e,t,i){var n={ShouldUsePodsOrCached:e.ShouldUsePODS,ShouldUsePods:e.ShouldUsePODS,CanUsePods:e.CanUsePODS,ApplicationUrl:T(t)||null,Reason:e.Reason,CreateNewScenario:ot[e.CreateNewScenario]};i.ULS.Qe(38580687,P.H,A.Info,JSON.stringify(n))}(b,g.ApplicationUrl,u);var _=b.ShouldUsePODS;if(_){g.Diagnostics&&g.Diagnostics.userClickTime&&Oe(g.Diagnostics.userClickTime,u),g.IsFileNew=b.CreateNewScenario!==ot.NotCreateNew,g.WopiPrecheckInfo.ReadOnly=g.WopiPrecheckInfo.ReadOnly||!1;var C=Ei(g,u);if(!C){var y={Message:"Error creating IFrame",HostSessionId:g.SessionInformation.HostSessionId};throw u.ULS.Qe(38580696,P.H,A.Error,JSON.stringify(y)),Error("Error Creating IFrame")}u.ULS.Qe(50376725,P.H,A.Warning,"Assigning wopiBootParams"),this.Ja=C.IFrameElement,this.ec&&this.ec(this.Ja),this.Da&&(this.Da.iframe=C.IFrameElement,this.Da.podsUrl=ti(g.OnDemandServer),this.Da.readonly=g.WopiPrecheckInfo.ReadOnly,this.Da.irmEnabled=g.WopiPrecheckInfo.IrmEnabled,this.Da.supportsDecryptedContentDownload=g.WopiPrecheckInfo.SupportsDecryptedContentDownload,this.Da.fileName=g.WopiPrecheckInfo.FileName),this.As=new sn(c(g.ApplicationUrl),u),this.As.activate(C.IFrameElement),g.SessionInformation.SupportsFrameTrustCheck||this.As.registerMessagePayloadHandler(ie.ki,this.Qa),this.qa=g.SessionInformation.SessionContext?g.SessionInformation.SessionContext:"",this.Ka="",g.SessionInformation.WdParams&&(this.Ka=_i(g.SessionInformation.WdParams)),this.Ka&&u.ULS.Qe(539837381,P.H,A.Warning,"Non-empty WdParams Assigned");var U=j(j({},g.Diagnostics),{hostName:g.SessionInformation.HostName});U.officeFrameCreateTime=C.FrameCreateTime,U.cacheHit=!1,this.La={AppInitDiagnostics:U,PptInitParams:g};var E=Qi.getInstance();E&&E.add(w,this)}u.ULS.Qe(50376727,P.H,A.Warning,"Creating WopiPendingApplication"),this.tc={Complete:function(e,t){_?s.Xa(e,b.CreateNewScenario,t):function(e,t,i,n,o){i.ULS.Qe(38147724,P.H,A.Info,"Launching Wac Fallback");var r=document.createElement("iframe");r.id="WebApplicationFrame",r.name="wac_frame",r.title="Office Online Frame",r.frameBorder="0",r.style.top="0",r.style.bottom="0",r.style.left="0",r.style.right="0",r.style.height="100%",r.style.width="100%",r.style.minHeight="200px",r.style.minWidth="300px",r.style.position="absolute",r.setAttribute("allowfullscreen","true"),r.setAttribute("allowTransparency","true"),r.style.minHeight="150px";var s=t.Container;s.style.top="0",s.style.bottom="0",s.style.left="0",s.style.right="0",s.style.height="100%",s.style.width="100%",s.style.minHeight="150px";var a=document.createElement("div");a.style.top="0",a.style.bottom="0",a.style.left="0",a.style.right="0",a.style.height="100%",a.style.width="100%",a.style.minHeight="150px",a.style.backgroundColor="#393a3d",a.style.backfaceVisibility="hidden";var c=document.createElement("form");c.name="wac_form",c.id="wac_form",c.target="wac_frame",c.action=function(e,t){if(e.WopiSrc.indexOf("PowerPointFrame.aspx")>=0){var i=e.WopiSrc.substr(e.WopiSrc.indexOf("WOPISrc=")+8),n=i.indexOf("&");e.WopiSrc=n<0?decodeURIComponent(decodeURI(i)):decodeURIComponent(i.substring(0,n))}var o=t.ApplicationUrl,r=o.indexOf("?"),s=o.substring(0,r);return s=Qt(s+="?wdEnableRoaming=1&wdo=1","PowerPointView",p(o,"PowerPointView")),m(o,"new")&&(s=Qt(s,"New","1")),m(o,"embed")&&(s=Qt(s,"Embed","1")),t.OnDemandServer||(s=Qt(s,"noLog","True")),e.WopiSrc&&(s=Qt(s,"WOPISrc",I(e.WopiSrc))),ei(s)}(e,t),c.method="post",c.appendChild(Pi("access_token",e.AccessToken)),c.appendChild(Pi("access_token_ttl",e.AccessTokenExpiry?e.AccessTokenExpiry.getTime().toString():"0")),e.WacToken&&c.appendChild(Pi("wac_token",e.WacToken)),s.appendChild(c),s.appendChild(a),a.appendChild(r),c.submit();var d={};n.stop();var u=n.getVisibilityChangeEvents();u&&u.length>0&&(d.documentLoadedWithTabSwitch=!0,i.ULS.Qe(38147725,P.H,A.Info,"Visibility Change Events:"+JSON.stringify(u))),t.FnOnInitializeSuccess(new Ui(o),d)}(e,g,u,s.Ha,w)},Fail:function(e){s.Qt.ULS.Qe(38293905,P.H,A.Info,"Host failed to give us WopiInfo")},Dispose:function(e,t){s.Va(),t&&t()},PostWacToken:function(e,t,i){s.As?function(e,t,i,n,o,r){var s=x();n.ULS.Qe(507774684,P.H,A.Important,"postWacToken flow initiated");var a=function(){r&&r.flush&&r.flush()};o?o.then((function(o){var c=function(){return i.sendPostMessage(o,ne.Xo,{wacToken:e,postWacTokenStart:t})};c();var d=window.setInterval(c,100);i.registerMessagePayloadHandler(ie.Qn,(function(e){n.ULS.Qe(507597019,P.H,A.Info,"postWacToken flow completed in ".concat(x()-s," ms")),window.clearInterval(d),window.clearTimeout(u),r&&(r.PostWacTokenResult="success",r.PostWacTokenEndTime=x(),e&&void 0!==e.TokenAlreadySet&&(r.TokenAlreadySet=e.TokenAlreadySet),a())}));var u=window.setTimeout((function(){n.ULS.Qe(507597018,P.H,A.Warning,"postWacToken flow timed out after ".concat(6e4," ms")),window.clearInterval(d),r&&(r.PostWacTokenResult="timeout",r.PostWacTokenEndTime=x(),a())}),6e4)})).catch((function(e){n.ULS.Qe(507873094,P.H,A.Warning,"This should never reject, error: ".concat(X(e))),r&&(r.PostWacTokenResult="Unexpected JSAPI V1 error",r.PostWacTokenEndTime=x(),a())})):(n.ULS.Qe(507846862,P.H,A.Warning,"`Promise` does not exist natively for this browser."),r&&(r.PostWacTokenResult="JSAPI V1 error: Promise not supported in browser",r.PostWacTokenEndTime=x(),a()))}(e,t,s.As,s.Qt,s.Ya,i):s.Qt.ULS.Qe(507846861,P.H,A.Info,"PPTUnifiedBootstrapper::PostWacToken, this._postMessageHandler is undefined")}},wi(g.BootstrapperUrl,u),window.setTimeout((function(){u&&u.ULS.flush()}),1e4)}catch(t){u&&(u.ULS.Qe(38580697,P.H,A.Error,Ai.AppInitError+": "+X(t)),u.ULS.flushOnClose()),e&&(e.ApplicationUrl&&R(Fi(e.ApplicationUrl,d),"PowerPoint","bootException"),e.FnOnInitializeFailure&&e.FnOnInitializeFailure({errorType:Ai.AppInitError,errorObject:t}))}}return e.prototype.log=function(e){this.Qt.ULS.Qe(39978262,P.H,A.Info,e)},e.prototype.onMessage=function(e,t){try{if(!e||!this.La)return void this.Qt.ULS.Qe(39978263,P.H,A.Error,"Missing message data: "+!e+" or appData: "+!this.La);switch(this.Ja&&this.Ja.contentWindow===t||this.Qt.ULS.Qe(39978264,P.H,A.Error,"Message with the right postMessageToken came from an unexpected iframe"),!e.Data.officeSessionId&&this.La.AppInitDiagnostics.officeSessionId&&(e.Data.officeSessionId=this.La.AppInitDiagnostics.officeSessionId),e.Data.messageType||(e.Data.messageType=e.Type),this.Qt.ULS.Qe(38580691,P.H,A.Warning,JSON.stringify(e.Data)),e.Type){case Ki.AppPageLoading:break;case Ki.AppReadyForPostMessage:this.Da&&(this.Da.hasAppBooted=!0),e.Data.officeSessionId&&(this.La.AppInitDiagnostics.officeSessionId=e.Data.officeSessionId),window.setTimeout(this.ja,1);break;case Ki.AppBootComplete:if(this.Ba=!0,this.La.PptInitParams.FnOnInitializeSuccess){this.La.AppInitDiagnostics.officeBootstrapperVersion=W(),e.Data.officeAppEndpoint&&(this.La.AppInitDiagnostics.officeAppEndpoint=e.Data.officeAppEndpoint),e.Data.officeServerVersion&&(this.La.AppInitDiagnostics.officeServerVersion=e.Data.officeServerVersion),e.Data.documentLoadedTime&&(this.La.AppInitDiagnostics.documentLoadedTime=e.Data.documentLoadedTime,this.La.AppInitDiagnostics.appCompletedTime=e.Data.documentLoadedTime),e.Data.officeFrameFirstFlushTime&&(this.La.AppInitDiagnostics.officeFrameFirstFlushTime=e.Data.officeFrameFirstFlushTime),e.Data.officeFrameDocumentFlushTime&&(this.La.AppInitDiagnostics.officeFrameDocumentFlushTime=e.Data.officeFrameDocumentFlushTime),e.Data.documentFlushTime&&(this.La.AppInitDiagnostics.officeFrameServerDocumentFlushTime=e.Data.documentFlushTime),e.Data.serverFirstFlushTime&&(this.La.AppInitDiagnostics.officeFrameServerFirstFlushTime=e.Data.serverFirstFlushTime),e.Data.serverStartTime&&(this.La.AppInitDiagnostics.officeFrameServerStartTime=e.Data.serverStartTime),e.Data.bootStartMs&&(this.La.AppInitDiagnostics.officeServerDocumentProcessStartTime=e.Data.bootStartMs),e.Data.bootEndMs&&(this.La.AppInitDiagnostics.officeServerDocumentProcessEndTime=e.Data.bootEndMs),e.Data.cacheHit&&(this.La.AppInitDiagnostics.cacheHit=e.Data.cacheHit);var i={browserRequest:!1,status:200,isAppCompleteCritical:!0,isDocumentLoadCritical:!0,name:"BootRequest"};e.Data.downloadCorrelation&&(i.correlationId=e.Data.downloadCorrelation),e.Data.downloadStartMs&&(i.startTime=e.Data.downloadStartMs),e.Data.downloadEndMs&&(i.endTime=e.Data.downloadEndMs),e.Data.downloadSize&&(i.size=e.Data.downloadSize),e.Data.incDownload&&(i.incremental=e.Data.incDownload),this.La.AppInitDiagnostics.fileRequestsData=[i],this.Ha.stop();var n=this.Ha.getVisibilityChangeEvents();if(n&&n.length>0&&(this.La.AppInitDiagnostics.documentLoadedWithTabSwitch=!0,this.Qt.ULS.Qe(38580692,P.H,A.Info,"Visibility Change Events:"+JSON.stringify(n))),this.Qt.ULS.Qe(34932955,P.H,A.Warning,JSON.stringify(this.La.AppInitDiagnostics)),!this.As)throw this.Qt.ULS.Qe(51448022,P.H,A.Warning,"PPTUnifiedSessionLoader::onMessage::AppBootComplete null m_postMessageHandler"),Error("m_postMessageHandler");this.ic=new ln(this.La.PptInitParams.PostMessageToken,this.Qt,this.As,this.Va,{innerApplicationFrame:this.Ja}),this.La.PptInitParams.FnOnInitializeSuccess(this.ic,this.La.AppInitDiagnostics),this.As.ma()}break;case Ki.RefreshPage:if(this.La.PptInitParams.ApplicationUrl.toLowerCase().indexOf("uiembed=1")>-1&&this.La.PptInitParams.SessionInformation.SupportsDocReboot)break;var o=window.location.href;-1!==o.indexOf("&wdccsoff=1")&&(o=v(o,"wdccsoff")),e.Data.officeSessionId&&(o=Qt(o,"PreviousSessionID",e.Data.officeSessionId)),e.Data.ControllerServicesParam&&(o=Qt(o,e.Data.ControllerServicesParamName,e.Data.ControllerServicesParam)),this.Qt.ULS.Qe(594068673,P.H,A.Info,"PPTUnifiedSessionLoader::onMessage::RefreshPage Updating window.location.href"),window.location.href=o;break;case Ki.UpdateInitializationComplete:try{if("FatalError"===e.Data.Reason){var r={ErrorName:e.Data.ErrorName,BootCompleted:this.Ba,SessionInfo:(a=this.La.PptInitParams,d=a.SessionInformation,u=a.Diagnostics,{HostName:d.HostName,HostSessionId:d.HostSessionId,UiLocale:d.UiLocale,DataLocale:d.DataLocale,DocumentClickTime:u&&u.userClickTime?u.userClickTime:d.DocumentClickTime?d.DocumentClickTime.getTime():void 0,HostInitTime:d.HostInitTime,UiHost:gi(d.HostName),WdParams:d.WdParams})};this.Qt.ULS.Qe(587236555,P.H,A.Error,JSON.stringify(r))}else this.Qt.ULS.Qe(576583120,P.H,A.Info,"PPTUnifiedSessionLoader::onMessage::UpdateInitializationComplete - Reason: ".concat(e.Data.Reason))}catch(e){this.Qt.ULS.Qe(576582732,P.H,A.Error,"PPTUnifiedSessionLoader::onMessage::UpdateInitializationComplete Caught exception: "+e)}this.As||(this.Qt.ULS.Qe(51448024,P.H,A.Info,"PPTUnifiedSessionLoader::onMessage::AppBootComplete null m_postMessageHandler"),this.As=new sn(c(this.La.PptInitParams.ApplicationUrl),this.Qt),this.As.activate(this.Ja)),this.ic=new ln(this.La.PptInitParams.PostMessageToken,this.Qt,this.As,this.Va,{innerApplicationFrame:this.Ja}),this.La.PptInitParams.FnOnInitializeSuccess(this.ic,this.La.AppInitDiagnostics),this.As.ma();break;case Ki.ProfileClientResourceUsage:this.Qt.ULS.Qe(541388952,P.H,A.Info,JSON.stringify(e.Data));break;case Ki.ULSLog:var s=e.Data;if(!s||"number"!=typeof s.Tag||"number"!=typeof s.Category||"number"!=typeof s.Level||"string"!=typeof s.Message)break;try{this.Qt.ULS.Qe(s.Tag,s.Category,s.Level,s.Message)}catch(e){this.Qt.ULS.Qe(512235073,P.H,A.Error,"PPTUnifiedSessionLoader::onMessage ULSLog exception: "+e)}}}catch(e){this.Qt.ULS.Qe(594121922,P.H,A.Error,"PPTUnifiedSessionLoader::onMessage Caught exception: "+e)}var a,d,u},e.prototype.getWopiPendingApplication=function(){return this.tc},e}(),hn=function(){function e(){}return e.prototype.GetVersion=function(){return W()},e.prototype.GetMinContentVersion=function(){return 1},e.prototype.Prefetch=function(){},e.prototype.InitializeWopiPending=function(e,t,i,n,o,r){return new pn(e,t,i,o,r).getWopiPendingApplication()},e}();!function(e){e[e.NotSupported=0]="NotSupported",e[e.SameDocOnly=1]="SameDocOnly",e[e.AnyDoc=2]="AnyDoc",e[e.OtherMode=4]="OtherMode"}(un||(un={}));var vn=new hn,wn=function(e){var t={name:"PowerPoint",usePreseededSessionId:!0,preconnector:C()};return new Ke(e,t,Xi)}}});
//# sourceMappingURL=powerpoint.app.boot.d7b7ee6ed25eeaba2a7c.js.map